2025-04-28 03:03:33 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 03:03:33 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 03:03:33 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 03:03:33 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 03:03:33 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 03:03:33 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 03:03:33 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 03:03:33 [ERROR] ‚ùó Failed to load dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 307, in __init__
    self._load_dataset()
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 369, in _load_dataset
    self._load_flat_dataset()
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 442, in _load_flat_dataset
    self.val_dataset = Subset(full_dataset_obj, val_indices) if val_indices else None
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
2025-04-28 03:03:33 [ERROR] ‚ùó Pipeline initialization or execution failed: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2379, in <module>
    executor = PipelineExecutor(
               ^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2163, in __init__
    self.pipeline = ClassificationPipeline(
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1082, in __init__
    self.dataset_handler = ImageDatasetHandler(
                           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 307, in __init__
    self._load_dataset()
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 369, in _load_dataset
    self._load_flat_dataset()
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 442, in _load_flat_dataset
    self.val_dataset = Subset(full_dataset_obj, val_indices) if val_indices else None
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
2025-04-28 03:07:03 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 03:07:03 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 03:07:03 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 03:07:03 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 03:07:03 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 03:07:03 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 03:07:03 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 03:07:03 [ERROR] ‚ùó Failed to load dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 322, in __init__
    self._load_dataset()
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 384, in _load_dataset
    self._load_flat_dataset()
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 457, in _load_flat_dataset
    self.val_dataset = Subset(full_dataset_obj, val_indices) if val_indices else None
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
2025-04-28 03:07:03 [ERROR] ‚ùó Pipeline initialization or execution failed: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2394, in <module>
    executor = PipelineExecutor(
               ^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2178, in __init__
    self.pipeline = ClassificationPipeline(
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1097, in __init__
    self.dataset_handler = ImageDatasetHandler(
                           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 322, in __init__
    self._load_dataset()
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 384, in _load_dataset
    self._load_flat_dataset()
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 457, in _load_flat_dataset
    self.val_dataset = Subset(full_dataset_obj, val_indices) if val_indices else None
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
2025-04-28 03:07:38 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 03:07:38 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 03:07:38 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 03:07:38 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 03:07:38 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 03:07:38 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 03:07:38 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 03:07:38 [ERROR] ‚ùó Failed to load dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 307, in __init__
    self._load_dataset()
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 369, in _load_dataset
    self._load_flat_dataset()
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 442, in _load_flat_dataset
    self.val_dataset = Subset(full_dataset_obj, val_indices) if val_indices else None
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
2025-04-28 03:07:38 [ERROR] ‚ùó Pipeline initialization or execution failed: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2379, in <module>
    executor = PipelineExecutor(
               ^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2163, in __init__
    self.pipeline = ClassificationPipeline(
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1082, in __init__
    self.dataset_handler = ImageDatasetHandler(
                           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 307, in __init__
    self._load_dataset()
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 369, in _load_dataset
    self._load_flat_dataset()
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 442, in _load_flat_dataset
    self.val_dataset = Subset(full_dataset_obj, val_indices) if val_indices else None
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
2025-04-28 03:14:49 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 03:14:49 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 03:14:49 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 03:14:49 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 03:14:49 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 03:14:49 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 03:14:49 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 03:14:49 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 03:14:49 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 03:14:49 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 03:14:49 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 03:14:49 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 03:14:49 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 03:14:49 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 03:14:49 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 03:14:49 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 03:14:49 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 03:14:49 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 03:14:49 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 03:14:49 [ERROR] ‚ùó !!! Method 'single_train' failed at step 1: SimpleCNN.forward() got an unexpected keyword argument 'X_val'
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2259, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1881, in single_train
    self.model_adapter.fit(train_dataset, y=None, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1016, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1220, in fit_loop
    self.run_single_epoch(iterator_train, training=True, prefix="train",
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1256, in run_single_epoch
    step = step_fn(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1135, in train_step
    self._step_optimizer(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1090, in _step_optimizer
    optimizer.step(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 487, in wrapper
    out = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 91, in _use_grad
    ret = func(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\adamw.py", line 197, in step
    loss = closure()
           ^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1124, in step_fn
    step = self.train_step_single(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1023, in train_step_single
    y_pred = self.infer(Xi, **fit_params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1551, in infer
    return self.module_(x, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: SimpleCNN.forward() got an unexpected keyword argument 'X_val'
2025-04-28 03:14:49 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 03:14:49 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 03:14:49 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 03:14:49 [ERROR] ‚ùó Method single_train_0: FAILED - SimpleCNN.forward() got an unexpected keyword argument 'X_val'
2025-04-28 03:16:36 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 03:16:36 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 03:16:36 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 03:16:36 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 03:16:36 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 03:16:36 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 03:16:36 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 03:16:36 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 03:16:36 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 03:16:36 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 03:16:36 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 03:16:36 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 03:16:36 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 03:16:36 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 03:16:36 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 03:16:36 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 03:16:36 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 03:16:36 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 03:16:36 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 03:16:37 [ERROR] ‚ùó !!! Method 'single_train' failed at step 1: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2274, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1896, in single_train
    self.model_adapter.fit(train_dataset, y=None, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1016, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1220, in fit_loop
    self.run_single_epoch(iterator_train, training=True, prefix="train",
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1256, in run_single_epoch
    step = step_fn(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1135, in train_step
    self._step_optimizer(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1090, in _step_optimizer
    optimizer.step(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 487, in wrapper
    out = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 91, in _use_grad
    ret = func(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\adamw.py", line 197, in step
    loss = closure()
           ^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1124, in step_fn
    step = self.train_step_single(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1023, in train_step_single
    y_pred = self.infer(Xi, **fit_params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1033, in infer
    return self.module_(x, **module_forward_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 734, in forward
    x = self.features(x)
        ^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\container.py", line 250, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
RuntimeError: Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
2025-04-28 03:16:37 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 03:16:37 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 03:16:37 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 03:16:37 [ERROR] ‚ùó Method single_train_0: FAILED - Input type (torch.FloatTensor) and weight type (torch.cuda.FloatTensor) should be the same or input should be a MKLDNN tensor and weight is a dense tensor
2025-04-28 03:18:49 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 03:18:49 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 03:18:49 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 03:18:49 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 03:18:49 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 03:18:49 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 03:18:49 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 03:18:49 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 03:18:49 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 03:18:49 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 03:18:49 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 03:18:49 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 03:18:49 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 03:18:49 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 03:18:49 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 03:18:49 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 03:18:49 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 03:18:49 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 03:18:49 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 03:18:51 [ERROR] ‚ùó !!! Method 'single_train' failed at step 1: "Key 'valid_loss' was not found in history."
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2278, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1900, in single_train
    self.model_adapter.fit(train_dataset, y=None, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1016, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1226, in fit_loop
    self.notify("on_epoch_end", **on_epoch_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 429, in on_epoch_end
    current_score = net.history[-1, self.monitor]
                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 291, in __getitem__
    raise KeyError(keyerror_msg.format(key))
KeyError: "Key 'valid_loss' was not found in history."
2025-04-28 03:18:51 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 03:18:51 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 03:18:51 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 03:18:51 [ERROR] ‚ùó Method single_train_0: FAILED - "Key 'valid_loss' was not found in history."
2025-04-28 03:22:31 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 03:22:31 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 03:22:31 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 03:22:31 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 03:22:31 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 03:22:31 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 03:22:31 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 03:22:31 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 03:22:31 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 03:22:31 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 03:22:31 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 03:22:31 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 03:22:31 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 03:22:31 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 03:22:31 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 03:22:31 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 03:22:31 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 03:22:31 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 03:22:31 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 03:22:32 [ERROR] ‚ùó !!! Method 'single_train' failed at step 1: "Key 'valid_loss' was not found in history."
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2281, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1903, in single_train
    self.model_adapter.fit(train_dataset, y=None, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1226, in fit_loop
    self.notify("on_epoch_end", **on_epoch_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 429, in on_epoch_end
    current_score = net.history[-1, self.monitor]
                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 291, in __getitem__
    raise KeyError(keyerror_msg.format(key))
KeyError: "Key 'valid_loss' was not found in history."
2025-04-28 03:22:32 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 03:22:32 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 03:22:32 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 03:22:32 [ERROR] ‚ùó Method single_train_0: FAILED - "Key 'valid_loss' was not found in history."
2025-04-28 03:24:44 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 03:24:44 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 03:24:44 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 03:24:44 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 03:24:44 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 03:24:44 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 03:24:44 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 03:24:44 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 03:24:44 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 03:24:44 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 03:24:44 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 03:24:44 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 03:24:44 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 03:24:44 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 03:24:44 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 03:24:44 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 03:24:44 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 03:24:44 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 03:24:44 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 03:24:45 [ERROR] ‚ùó !!! Method 'single_train' failed at step 1: "Key 'valid_loss' was not found in history."
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2308, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1930, in single_train
    self.model_adapter.fit(train_dataset, y=None, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1226, in fit_loop
    self.notify("on_epoch_end", **on_epoch_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 429, in on_epoch_end
    current_score = net.history[-1, self.monitor]
                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 291, in __getitem__
    raise KeyError(keyerror_msg.format(key))
KeyError: "Key 'valid_loss' was not found in history."
2025-04-28 03:24:45 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 03:24:45 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 03:24:45 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 03:24:45 [ERROR] ‚ùó Method single_train_0: FAILED - "Key 'valid_loss' was not found in history."
2025-04-28 03:25:54 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 03:25:54 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 03:25:54 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 03:25:54 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 03:25:54 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 03:25:54 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 03:25:54 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 03:25:54 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 03:25:54 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 03:25:54 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 03:25:54 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 03:25:54 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 03:25:54 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 03:25:54 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 03:25:54 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 03:25:54 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 03:25:54 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 03:25:54 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 03:25:54 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 03:25:56 [ERROR] ‚ùó !!! Method 'single_train' failed at step 1: "Key 'valid_loss' was not found in history."
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2308, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1930, in single_train
    self.model_adapter.fit(train_dataset, y=None, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1226, in fit_loop
    self.notify("on_epoch_end", **on_epoch_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 429, in on_epoch_end
    current_score = net.history[-1, self.monitor]
                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 291, in __getitem__
    raise KeyError(keyerror_msg.format(key))
KeyError: "Key 'valid_loss' was not found in history."
2025-04-28 03:25:56 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 03:25:56 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 03:25:56 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 03:25:56 [ERROR] ‚ùó Method single_train_0: FAILED - "Key 'valid_loss' was not found in history."
2025-04-28 03:26:28 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 03:26:28 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 03:26:28 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 03:26:28 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 03:26:28 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 03:26:28 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 03:26:28 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 03:26:28 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 03:26:28 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 03:26:28 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 03:26:28 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 03:26:28 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 03:26:28 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 03:26:28 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 03:26:28 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 03:26:28 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 03:26:28 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 03:26:28 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 03:26:28 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 03:26:29 [ERROR] ‚ùó !!! Method 'single_train' failed at step 1: "Key 'valid_loss' was not found in history."
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2308, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1930, in single_train
    self.model_adapter.fit(train_dataset, y=None, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1226, in fit_loop
    self.notify("on_epoch_end", **on_epoch_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 429, in on_epoch_end
    current_score = net.history[-1, self.monitor]
                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 291, in __getitem__
    raise KeyError(keyerror_msg.format(key))
KeyError: "Key 'valid_loss' was not found in history."
2025-04-28 03:26:29 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 03:26:29 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 03:26:29 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 03:26:29 [ERROR] ‚ùó Method single_train_0: FAILED - "Key 'valid_loss' was not found in history."
2025-04-28 03:27:32 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 03:27:32 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 03:27:32 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 03:27:32 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 03:27:32 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 03:27:32 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 03:27:32 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 03:27:32 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 03:27:32 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 03:27:32 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 03:27:32 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 03:27:32 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 03:27:32 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 03:27:32 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 03:27:32 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 03:27:32 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 03:27:32 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 03:27:32 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 03:27:32 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 03:27:33 [ERROR] ‚ùó !!! Method 'single_train' failed at step 1: "Key 'valid_loss' was not found in history."
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2308, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1930, in single_train
    self.model_adapter.fit(train_dataset, y=None, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1226, in fit_loop
    self.notify("on_epoch_end", **on_epoch_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 429, in on_epoch_end
    current_score = net.history[-1, self.monitor]
                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 291, in __getitem__
    raise KeyError(keyerror_msg.format(key))
KeyError: "Key 'valid_loss' was not found in history."
2025-04-28 03:27:33 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 03:27:33 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 03:27:33 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 03:27:33 [ERROR] ‚ùó Method single_train_0: FAILED - "Key 'valid_loss' was not found in history."
2025-04-28 03:36:02 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 03:36:02 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 03:36:02 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 03:36:02 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 03:36:02 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 03:36:02 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 03:36:02 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 03:36:02 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 03:36:02 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 03:36:02 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 03:36:02 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 03:36:02 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 03:36:02 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 03:36:02 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 03:36:02 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 03:36:02 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 03:36:02 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 03:36:02 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 03:36:02 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 03:36:03 [ERROR] ‚ùó !!! Method 'single_train' failed at step 1: "Key 'valid_loss' was not found in history."
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2345, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1946, in single_train
    self.model_adapter.fit(train_dataset, y=None, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1226, in fit_loop
    self.notify("on_epoch_end", **on_epoch_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 429, in on_epoch_end
    current_score = net.history[-1, self.monitor]
                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 291, in __getitem__
    raise KeyError(keyerror_msg.format(key))
KeyError: "Key 'valid_loss' was not found in history."
2025-04-28 03:36:03 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 03:36:03 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 03:36:03 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 03:36:03 [ERROR] ‚ùó Method single_train_0: FAILED - "Key 'valid_loss' was not found in history."
2025-04-28 03:37:22 [DEBUG] üîç Chosen sequence: [('single_train', {'max_epochs': 5, 'save_model': True}), ('single_eval', {'save_results': True})]
2025-04-28 03:37:22 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 03:37:22 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 03:37:22 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 03:37:22 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 03:37:22 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 03:37:22 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 03:37:22 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 03:37:22 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 03:37:22 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 03:37:22 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 03:37:22 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 03:37:22 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 03:37:22 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 03:37:22 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 03:37:22 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 03:37:22 [DEBUG] üîç Method validation successful.
2025-04-28 03:37:22 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 03:37:22 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 03:37:22 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 03:37:22 [DEBUG] üîç Parameters for single_train: {'max_epochs': 5, 'save_model': True}
2025-04-28 03:37:22 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 03:37:22 [DEBUG] üîç Validation dataset type: <class 'torch.utils.data.dataset.Subset'>, Is None: False
2025-04-28 03:37:22 [DEBUG] üîç Validation dataset length: 70
2025-04-28 03:37:22 [DEBUG] üîç Validation dataset has targets attribute (potentially): True
2025-04-28 03:37:22 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 03:37:22 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 03:37:22 [DEBUG] üîç Wrapping validation dataset in skorch.dataset.Dataset for X_val.
2025-04-28 03:37:22 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 03:37:22 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 03:37:23 [ERROR] ‚ùó !!! Method 'single_train' failed at step 1: "Key 'valid_loss' was not found in history."
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2345, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1946, in single_train
    self.model_adapter.fit(train_dataset, y=None, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1226, in fit_loop
    self.notify("on_epoch_end", **on_epoch_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 429, in on_epoch_end
    current_score = net.history[-1, self.monitor]
                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 291, in __getitem__
    raise KeyError(keyerror_msg.format(key))
KeyError: "Key 'valid_loss' was not found in history."
2025-04-28 03:37:23 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 03:37:23 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 03:37:23 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 03:37:23 [ERROR] ‚ùó Method single_train_0: FAILED - "Key 'valid_loss' was not found in history."
2025-04-28 03:51:30 [DEBUG] üîç Chosen sequence: [('single_train', {'max_epochs': 5, 'save_model': True}), ('single_eval', {'save_results': True})]
2025-04-28 03:51:30 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 03:51:30 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 03:51:30 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 03:51:30 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 03:51:30 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 03:51:30 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 03:51:30 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 03:51:30 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 03:51:30 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 03:51:30 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 03:51:30 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 03:51:30 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 03:51:30 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 03:51:30 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 03:51:30 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 03:51:30 [DEBUG] üîç Method validation successful.
2025-04-28 03:51:30 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 03:51:30 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 03:51:30 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 03:51:30 [DEBUG] üîç Parameters for single_train: {'max_epochs': 5, 'save_model': True}
2025-04-28 03:51:30 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 03:51:30 [DEBUG] üîç Validation dataset type: <class 'torch.utils.data.dataset.Subset'>, Is None: False
2025-04-28 03:51:30 [DEBUG] üîç Validation dataset length: 70
2025-04-28 03:51:30 [DEBUG] üîç Validation dataset has targets attribute (potentially): True
2025-04-28 03:51:30 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 03:51:30 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 03:51:30 [DEBUG] üîç Wrapping validation dataset in skorch.dataset.Dataset for X_val.
2025-04-28 03:51:30 [ERROR] ‚ùó !!! Method 'single_train' failed at step 1: __main__.SkorchModelAdapter.fit() got multiple values for keyword argument 'X_val'
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2351, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1946, in single_train
    self.model_adapter.fit(
TypeError: __main__.SkorchModelAdapter.fit() got multiple values for keyword argument 'X_val'
2025-04-28 03:51:30 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 03:51:30 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 03:51:30 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 03:51:30 [ERROR] ‚ùó Method single_train_0: FAILED - __main__.SkorchModelAdapter.fit() got multiple values for keyword argument 'X_val'
2025-04-28 03:52:02 [DEBUG] üîç Chosen sequence: [('single_train', {'max_epochs': 5, 'save_model': True}), ('single_eval', {'save_results': True})]
2025-04-28 03:52:02 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 03:52:02 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 03:52:02 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 03:52:02 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 03:52:02 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 03:52:02 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 03:52:02 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 03:52:02 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 03:52:02 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 03:52:02 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 03:52:02 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 03:52:02 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 03:52:02 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 03:52:02 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 03:52:02 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 03:52:02 [DEBUG] üîç Method validation successful.
2025-04-28 03:52:02 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 03:52:02 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 03:52:02 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 03:52:02 [DEBUG] üîç Parameters for single_train: {'max_epochs': 5, 'save_model': True}
2025-04-28 03:52:02 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 03:52:02 [DEBUG] üîç Validation dataset type: <class 'torch.utils.data.dataset.Subset'>, Is None: False
2025-04-28 03:52:02 [DEBUG] üîç Validation dataset length: 70
2025-04-28 03:52:02 [DEBUG] üîç Validation dataset has targets attribute (potentially): True
2025-04-28 03:52:02 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 03:52:02 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 03:52:02 [DEBUG] üîç Wrapping validation dataset in skorch.dataset.Dataset for X_val.
2025-04-28 03:52:02 [ERROR] ‚ùó !!! Method 'single_train' failed at step 1: __main__.SkorchModelAdapter.fit() got multiple values for keyword argument 'X_val'
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2351, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1946, in single_train
    self.model_adapter.fit(
TypeError: __main__.SkorchModelAdapter.fit() got multiple values for keyword argument 'X_val'
2025-04-28 03:52:02 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 03:52:02 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 03:52:02 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 03:52:02 [ERROR] ‚ùó Method single_train_0: FAILED - __main__.SkorchModelAdapter.fit() got multiple values for keyword argument 'X_val'
2025-04-28 03:52:55 [DEBUG] üîç Chosen sequence: [('single_train', {'max_epochs': 5, 'save_model': True}), ('single_eval', {'save_results': True})]
2025-04-28 03:52:55 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 03:52:55 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 03:52:55 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 03:52:55 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 03:52:55 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 03:52:55 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 03:52:55 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 03:52:55 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 03:52:55 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 03:52:55 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 03:52:55 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 03:52:55 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 03:52:55 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 03:52:55 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 03:52:55 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 03:52:55 [DEBUG] üîç Method validation successful.
2025-04-28 03:52:55 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 03:52:55 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 03:52:55 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 03:52:55 [DEBUG] üîç Parameters for single_train: {'max_epochs': 5, 'save_model': True}
2025-04-28 03:52:55 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 03:52:55 [DEBUG] üîç Validation dataset type: <class 'torch.utils.data.dataset.Subset'>, Is None: False
2025-04-28 03:52:55 [DEBUG] üîç Validation dataset length: 70
2025-04-28 03:52:55 [DEBUG] üîç Validation dataset has targets attribute (potentially): True
2025-04-28 03:52:55 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 03:52:55 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 03:52:55 [DEBUG] üîç Wrapping validation dataset in skorch.dataset.Dataset for X_val.
2025-04-28 03:52:55 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 03:52:55 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 03:52:56 [ERROR] ‚ùó !!! Method 'single_train' failed at step 1: "Key 'valid_loss' was not found in history."
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2351, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1946, in single_train
    self.model_adapter.fit(
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1226, in fit_loop
    self.notify("on_epoch_end", **on_epoch_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 429, in on_epoch_end
    current_score = net.history[-1, self.monitor]
                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 291, in __getitem__
    raise KeyError(keyerror_msg.format(key))
KeyError: "Key 'valid_loss' was not found in history."
2025-04-28 03:52:56 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 03:52:56 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 03:52:56 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 03:52:56 [ERROR] ‚ùó Method single_train_0: FAILED - "Key 'valid_loss' was not found in history."
2025-04-28 03:54:53 [DEBUG] üîç Chosen sequence: [('single_train', {'max_epochs': 5, 'save_model': True}), ('single_eval', {'save_results': True})]
2025-04-28 03:54:53 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 03:54:53 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 03:54:53 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 03:54:53 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 03:54:53 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 03:54:53 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 03:54:53 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 03:54:53 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 03:54:53 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 03:54:53 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 03:54:53 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 03:54:53 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 03:54:53 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 03:54:53 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 03:54:53 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 03:54:53 [DEBUG] üîç Method validation successful.
2025-04-28 03:54:53 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 03:54:53 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 03:54:53 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 03:54:53 [DEBUG] üîç Parameters for single_train: {'max_epochs': 5, 'save_model': True}
2025-04-28 03:54:53 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 03:54:53 [DEBUG] üîç Validation dataset type: <class 'torch.utils.data.dataset.Subset'>, Is None: False
2025-04-28 03:54:53 [DEBUG] üîç Validation dataset length: 70
2025-04-28 03:54:53 [DEBUG] üîç Validation dataset has targets attribute (potentially): True
2025-04-28 03:54:53 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 03:54:53 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 03:54:53 [DEBUG] üîç Wrapping validation dataset in skorch.dataset.Dataset for X_val.
2025-04-28 03:54:53 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 03:54:53 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 03:54:54 [ERROR] ‚ùó !!! Method 'single_train' failed at step 1: "Key 'valid_loss' was not found in history."
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2358, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1955, in single_train
    self.model_adapter.fit(
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1226, in fit_loop
    self.notify("on_epoch_end", **on_epoch_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 429, in on_epoch_end
    current_score = net.history[-1, self.monitor]
                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 291, in __getitem__
    raise KeyError(keyerror_msg.format(key))
KeyError: "Key 'valid_loss' was not found in history."
2025-04-28 03:54:54 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 03:54:54 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 03:54:54 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 03:54:54 [ERROR] ‚ùó Method single_train_0: FAILED - "Key 'valid_loss' was not found in history."
2025-04-28 03:58:10 [DEBUG] üîç Chosen sequence: [('single_train', {'max_epochs': 5, 'save_model': True}), ('single_eval', {'save_results': True})]
2025-04-28 03:58:10 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 03:58:10 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 03:58:10 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 03:58:10 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 03:58:10 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 03:58:10 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 03:58:10 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 03:58:10 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 03:58:10 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 03:58:10 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 03:58:10 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 03:58:10 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 03:58:10 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 03:58:10 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 03:58:10 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 03:58:10 [DEBUG] üîç Method validation successful.
2025-04-28 03:58:10 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 03:58:10 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 03:58:10 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 03:58:10 [DEBUG] üîç Parameters for single_train: {'max_epochs': 5, 'save_model': True}
2025-04-28 03:58:10 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 03:58:10 [DEBUG] üîç Validation dataset type: <class 'torch.utils.data.dataset.Subset'>, Is None: False
2025-04-28 03:58:10 [DEBUG] üîç Validation dataset length: 70
2025-04-28 03:58:10 [DEBUG] üîç Validation dataset has targets attribute (potentially): True
2025-04-28 03:58:10 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 03:58:10 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 03:58:10 [DEBUG] üîç Wrapping validation dataset in skorch.dataset.Dataset for X_val.
2025-04-28 03:58:10 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 03:58:10 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 03:58:11 [ERROR] ‚ùó !!! Method 'single_train' failed at step 1: "Key 'valid_loss' was not found in history."
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2347, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1948, in single_train
    self.model_adapter.fit(train_dataset, y=None, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1226, in fit_loop
    self.notify("on_epoch_end", **on_epoch_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 429, in on_epoch_end
    current_score = net.history[-1, self.monitor]
                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 291, in __getitem__
    raise KeyError(keyerror_msg.format(key))
KeyError: "Key 'valid_loss' was not found in history."
2025-04-28 03:58:11 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 03:58:11 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 03:58:11 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 03:58:11 [ERROR] ‚ùó Method single_train_0: FAILED - "Key 'valid_loss' was not found in history."
2025-04-28 03:58:27 [DEBUG] üîç Chosen sequence: [('single_train', {'max_epochs': 5, 'save_model': True}), ('single_eval', {'save_results': True})]
2025-04-28 03:58:27 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 03:58:27 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 03:58:27 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 03:58:27 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 03:58:27 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 03:58:27 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 03:58:27 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 03:58:27 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 03:58:27 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 03:58:27 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 03:58:27 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 03:58:27 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 03:58:27 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 03:58:27 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 03:58:27 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 03:58:27 [DEBUG] üîç Method validation successful.
2025-04-28 03:58:27 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 03:58:27 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 03:58:27 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 03:58:27 [DEBUG] üîç Parameters for single_train: {'max_epochs': 5, 'save_model': True}
2025-04-28 03:58:27 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 03:58:27 [DEBUG] üîç Validation dataset type: <class 'torch.utils.data.dataset.Subset'>, Is None: False
2025-04-28 03:58:27 [DEBUG] üîç Validation dataset length: 70
2025-04-28 03:58:27 [DEBUG] üîç Validation dataset has targets attribute (potentially): True
2025-04-28 03:58:27 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 03:58:27 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 03:58:27 [DEBUG] üîç Wrapping validation dataset in skorch.dataset.Dataset for X_val.
2025-04-28 03:58:27 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 03:58:27 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 03:58:29 [ERROR] ‚ùó !!! Method 'single_train' failed at step 1: "Key 'valid_loss' was not found in history."
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2347, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1948, in single_train
    self.model_adapter.fit(train_dataset, y=None, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1226, in fit_loop
    self.notify("on_epoch_end", **on_epoch_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 429, in on_epoch_end
    current_score = net.history[-1, self.monitor]
                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 291, in __getitem__
    raise KeyError(keyerror_msg.format(key))
KeyError: "Key 'valid_loss' was not found in history."
2025-04-28 03:58:29 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 03:58:29 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 03:58:29 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 03:58:29 [ERROR] ‚ùó Method single_train_0: FAILED - "Key 'valid_loss' was not found in history."
2025-04-28 04:01:45 [DEBUG] üîç Chosen sequence: [('single_train', {'max_epochs': 5, 'save_model': True}), ('single_eval', {'save_results': True})]
2025-04-28 04:01:45 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 04:01:45 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 04:01:45 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 04:01:45 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 04:01:45 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 04:01:45 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 04:01:45 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 04:01:45 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 04:01:45 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 04:01:45 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 04:01:45 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 04:01:45 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 04:01:45 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 04:01:45 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 04:01:45 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 04:01:45 [DEBUG] üîç Method validation successful.
2025-04-28 04:01:45 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 04:01:45 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 04:01:45 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 04:01:45 [DEBUG] üîç Parameters for single_train: {'max_epochs': 5, 'save_model': True}
2025-04-28 04:01:45 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 04:01:45 [DEBUG] üîç Validation dataset type: <class 'torch.utils.data.dataset.Subset'>, Is None: False
2025-04-28 04:01:45 [DEBUG] üîç Validation dataset length: 70
2025-04-28 04:01:45 [DEBUG] üîç Validation dataset has targets attribute (potentially): True
2025-04-28 04:01:45 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 04:01:45 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 04:01:45 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 04:01:45 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 04:01:47 [ERROR] ‚ùó !!! Method 'single_train' failed at step 1: "Key 'valid_loss' was not found in history."
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2337, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1938, in single_train
    self.model_adapter.fit(train_dataset, y=None, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1226, in fit_loop
    self.notify("on_epoch_end", **on_epoch_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 429, in on_epoch_end
    current_score = net.history[-1, self.monitor]
                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 291, in __getitem__
    raise KeyError(keyerror_msg.format(key))
KeyError: "Key 'valid_loss' was not found in history."
2025-04-28 04:01:47 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 04:01:47 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 04:01:47 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 04:01:47 [ERROR] ‚ùó Method single_train_0: FAILED - "Key 'valid_loss' was not found in history."
2025-04-28 04:02:00 [DEBUG] üîç Chosen sequence: [('single_train', {'max_epochs': 5, 'save_model': True}), ('single_eval', {'save_results': True})]
2025-04-28 04:02:00 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 04:02:00 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 04:02:00 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 04:02:00 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 04:02:00 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 04:02:00 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 04:02:00 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 04:02:00 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 04:02:00 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 04:02:00 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 04:02:00 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 04:02:00 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 04:02:00 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 04:02:00 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 04:02:00 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 04:02:00 [DEBUG] üîç Method validation successful.
2025-04-28 04:02:00 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 04:02:00 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 04:02:00 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 04:02:00 [DEBUG] üîç Parameters for single_train: {'max_epochs': 5, 'save_model': True}
2025-04-28 04:02:00 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 04:02:00 [DEBUG] üîç Validation dataset type: <class 'torch.utils.data.dataset.Subset'>, Is None: False
2025-04-28 04:02:00 [DEBUG] üîç Validation dataset length: 70
2025-04-28 04:02:00 [DEBUG] üîç Validation dataset has targets attribute (potentially): True
2025-04-28 04:02:00 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 04:02:00 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 04:02:00 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 04:02:00 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 04:02:02 [ERROR] ‚ùó !!! Method 'single_train' failed at step 1: "Key 'valid_loss' was not found in history."
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2337, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1938, in single_train
    self.model_adapter.fit(train_dataset, y=None, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1226, in fit_loop
    self.notify("on_epoch_end", **on_epoch_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 429, in on_epoch_end
    current_score = net.history[-1, self.monitor]
                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 291, in __getitem__
    raise KeyError(keyerror_msg.format(key))
KeyError: "Key 'valid_loss' was not found in history."
2025-04-28 04:02:02 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 04:02:02 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 04:02:02 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 04:02:02 [ERROR] ‚ùó Method single_train_0: FAILED - "Key 'valid_loss' was not found in history."
2025-04-28 04:02:35 [DEBUG] üîç Chosen sequence: [('single_train', {'max_epochs': 5, 'save_model': True}), ('single_eval', {'save_results': True})]
2025-04-28 04:02:35 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 04:02:35 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 04:02:35 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 04:02:35 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 04:02:35 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 04:02:35 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 04:02:35 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 04:02:35 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 04:02:35 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 04:02:35 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 04:02:35 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 04:02:35 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 04:02:35 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 04:02:35 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 04:02:35 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 04:02:35 [DEBUG] üîç Method validation successful.
2025-04-28 04:02:35 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 04:02:35 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 04:02:35 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 04:02:35 [DEBUG] üîç Parameters for single_train: {'max_epochs': 5, 'save_model': True}
2025-04-28 04:02:35 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 04:02:35 [DEBUG] üîç Validation dataset type: <class 'torch.utils.data.dataset.Subset'>, Is None: False
2025-04-28 04:02:35 [DEBUG] üîç Validation dataset length: 70
2025-04-28 04:02:35 [DEBUG] üîç Validation dataset has targets attribute (potentially): True
2025-04-28 04:02:35 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 04:02:35 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 04:02:35 [DEBUG] üîç Wrapping validation dataset in skorch.dataset.Dataset for X_val.
2025-04-28 04:02:35 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 04:02:35 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 04:02:36 [ERROR] ‚ùó !!! Method 'single_train' failed at step 1: "Key 'valid_loss' was not found in history."
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2345, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1946, in single_train
    self.model_adapter.fit(train_dataset, y=None, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1226, in fit_loop
    self.notify("on_epoch_end", **on_epoch_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 429, in on_epoch_end
    current_score = net.history[-1, self.monitor]
                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 291, in __getitem__
    raise KeyError(keyerror_msg.format(key))
KeyError: "Key 'valid_loss' was not found in history."
2025-04-28 04:02:36 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 04:02:36 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 04:02:36 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 04:02:36 [ERROR] ‚ùó Method single_train_0: FAILED - "Key 'valid_loss' was not found in history."
2025-04-28 04:03:16 [DEBUG] üîç Chosen sequence: [('single_train', {'max_epochs': 5, 'save_model': True}), ('single_eval', {'save_results': True})]
2025-04-28 04:03:16 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 04:03:16 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 04:03:16 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 04:03:16 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 04:03:16 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 04:03:16 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 04:03:16 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 04:03:16 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 04:03:16 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 04:03:16 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 04:03:16 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 04:03:16 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 04:03:16 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 04:03:16 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 04:03:16 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 04:03:16 [DEBUG] üîç Method validation successful.
2025-04-28 04:03:16 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 04:03:16 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 04:03:16 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 04:03:16 [DEBUG] üîç Parameters for single_train: {'max_epochs': 5, 'save_model': True}
2025-04-28 04:03:16 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 04:03:16 [DEBUG] üîç Validation dataset type: <class 'torch.utils.data.dataset.Subset'>, Is None: False
2025-04-28 04:03:16 [DEBUG] üîç Validation dataset length: 70
2025-04-28 04:03:16 [DEBUG] üîç Validation dataset has targets attribute (potentially): True
2025-04-28 04:03:16 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 04:03:16 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 04:03:16 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 04:03:16 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 04:03:17 [ERROR] ‚ùó !!! Method 'single_train' failed at step 1: "Key 'valid_loss' was not found in history."
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2337, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1938, in single_train
    self.model_adapter.fit(train_dataset, y=None, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1226, in fit_loop
    self.notify("on_epoch_end", **on_epoch_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 429, in on_epoch_end
    current_score = net.history[-1, self.monitor]
                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 291, in __getitem__
    raise KeyError(keyerror_msg.format(key))
KeyError: "Key 'valid_loss' was not found in history."
2025-04-28 04:03:17 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 04:03:17 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 04:03:17 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 04:03:17 [ERROR] ‚ùó Method single_train_0: FAILED - "Key 'valid_loss' was not found in history."
2025-04-28 04:03:29 [DEBUG] üîç Chosen sequence: [('single_train', {'max_epochs': 5, 'save_model': True}), ('single_eval', {'save_results': True})]
2025-04-28 04:03:29 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 04:03:29 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 04:03:29 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 04:03:29 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 04:03:29 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 04:03:29 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 04:03:29 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 04:03:29 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 04:03:29 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 04:03:29 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 04:03:29 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 04:03:29 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 04:03:29 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 04:03:29 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 04:03:29 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 04:03:29 [DEBUG] üîç Method validation successful.
2025-04-28 04:03:29 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 04:03:29 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 04:03:29 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 04:03:29 [DEBUG] üîç Parameters for single_train: {'max_epochs': 5, 'save_model': True}
2025-04-28 04:03:29 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 04:03:29 [DEBUG] üîç Validation dataset type: <class 'torch.utils.data.dataset.Subset'>, Is None: False
2025-04-28 04:03:29 [DEBUG] üîç Validation dataset length: 70
2025-04-28 04:03:29 [DEBUG] üîç Validation dataset has targets attribute (potentially): True
2025-04-28 04:03:29 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 04:03:29 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 04:03:29 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 04:03:29 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 04:03:31 [ERROR] ‚ùó !!! Method 'single_train' failed at step 1: "Key 'valid_loss' was not found in history."
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2337, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1938, in single_train
    self.model_adapter.fit(train_dataset, y=None, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1226, in fit_loop
    self.notify("on_epoch_end", **on_epoch_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 429, in on_epoch_end
    current_score = net.history[-1, self.monitor]
                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 291, in __getitem__
    raise KeyError(keyerror_msg.format(key))
KeyError: "Key 'valid_loss' was not found in history."
2025-04-28 04:03:31 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 04:03:31 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 04:03:31 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 04:03:31 [ERROR] ‚ùó Method single_train_0: FAILED - "Key 'valid_loss' was not found in history."
2025-04-28 04:10:38 [DEBUG] üîç Chosen sequence: [('single_train', {'max_epochs': 5, 'save_model': True}), ('single_eval', {'save_results': True})]
2025-04-28 04:10:38 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 04:10:38 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 04:10:38 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 04:10:38 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 04:10:38 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 04:10:38 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 04:10:38 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 04:10:39 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 04:10:39 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 04:10:39 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 04:10:39 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 04:10:39 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 04:10:39 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 04:10:39 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 04:10:39 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 04:10:39 [DEBUG] üîç Method validation successful.
2025-04-28 04:10:39 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 04:10:39 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 04:10:39 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 04:10:39 [DEBUG] üîç Parameters for single_train: {'max_epochs': 5, 'save_model': True}
2025-04-28 04:10:39 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 04:10:39 [DEBUG] üîç Validation dataset type: <class 'torch.utils.data.dataset.Subset'>, Is None: False
2025-04-28 04:10:39 [DEBUG] üîç Validation dataset length: 70
2025-04-28 04:10:39 [DEBUG] üîç Validation dataset has targets attribute (potentially): True
2025-04-28 04:10:39 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 04:10:39 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 04:10:39 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 04:10:39 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 04:10:40 [ERROR] ‚ùó !!! Method 'single_train' failed at step 1: "Key 'valid_loss' was not found in history."
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2351, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1952, in single_train
    self.model_adapter.fit(train_dataset, y=None, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1226, in fit_loop
    self.notify("on_epoch_end", **on_epoch_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 429, in on_epoch_end
    current_score = net.history[-1, self.monitor]
                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 291, in __getitem__
    raise KeyError(keyerror_msg.format(key))
KeyError: "Key 'valid_loss' was not found in history."
2025-04-28 04:10:40 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 04:10:40 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 04:10:40 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 04:10:40 [ERROR] ‚ùó Method single_train_0: FAILED - "Key 'valid_loss' was not found in history."
2025-04-28 04:10:55 [DEBUG] üîç Chosen sequence: [('single_train', {'max_epochs': 5, 'save_model': True}), ('single_eval', {'save_results': True})]
2025-04-28 04:10:55 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 04:10:55 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 04:10:55 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 04:10:55 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 04:10:55 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 04:10:55 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 04:10:55 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 04:10:55 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 04:10:55 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 04:10:55 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 04:10:55 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 04:10:55 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 04:10:55 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 04:10:55 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 04:10:55 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 04:10:55 [DEBUG] üîç Method validation successful.
2025-04-28 04:10:55 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 04:10:55 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 04:10:55 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 04:10:55 [DEBUG] üîç Parameters for single_train: {'max_epochs': 5, 'save_model': True}
2025-04-28 04:10:55 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 04:10:55 [DEBUG] üîç Validation dataset type: <class 'torch.utils.data.dataset.Subset'>, Is None: False
2025-04-28 04:10:55 [DEBUG] üîç Validation dataset length: 70
2025-04-28 04:10:55 [DEBUG] üîç Validation dataset has targets attribute (potentially): True
2025-04-28 04:10:55 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 04:10:55 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 04:10:55 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 04:10:55 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 04:10:56 [ERROR] ‚ùó !!! Method 'single_train' failed at step 1: "Key 'valid_loss' was not found in history."
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2351, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1952, in single_train
    self.model_adapter.fit(train_dataset, y=None, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1226, in fit_loop
    self.notify("on_epoch_end", **on_epoch_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 429, in on_epoch_end
    current_score = net.history[-1, self.monitor]
                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 291, in __getitem__
    raise KeyError(keyerror_msg.format(key))
KeyError: "Key 'valid_loss' was not found in history."
2025-04-28 04:10:56 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 04:10:56 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 04:10:56 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 04:10:56 [ERROR] ‚ùó Method single_train_0: FAILED - "Key 'valid_loss' was not found in history."
2025-04-28 04:12:02 [DEBUG] üîç Chosen sequence: [('single_train', {'max_epochs': 5, 'save_model': True}), ('single_eval', {'save_results': True})]
2025-04-28 04:12:02 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 04:12:02 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 04:12:02 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 04:12:02 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 04:12:02 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 04:12:02 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 04:12:02 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 04:12:02 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 04:12:02 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 04:12:02 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 04:12:02 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 04:12:02 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 04:12:02 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 04:12:02 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 04:12:02 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 04:12:02 [DEBUG] üîç Method validation successful.
2025-04-28 04:12:02 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 04:12:02 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 04:12:02 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 04:12:02 [DEBUG] üîç Parameters for single_train: {'max_epochs': 5, 'save_model': True}
2025-04-28 04:12:02 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 04:12:02 [DEBUG] üîç Validation dataset type: <class 'torch.utils.data.dataset.Subset'>, Is None: False
2025-04-28 04:12:02 [DEBUG] üîç Validation dataset length: 70
2025-04-28 04:12:02 [DEBUG] üîç Validation dataset has targets attribute (potentially): True
2025-04-28 04:12:02 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 04:12:02 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 04:12:02 [DEBUG] üîç Wrapping validation dataset in skorch.dataset.Dataset for X_val.
2025-04-28 04:12:02 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 04:12:57 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 04:13:18 [ERROR] ‚ùó !!! Method 'single_train' failed at step 1: list index out of range
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2345, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1946, in single_train
    self.model_adapter.fit(train_dataset, y=None, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1311, in partial_fit
    self.notify('on_train_end', X=X, y=y)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 447, in on_train_end
    self.load_best and (self.best_epoch_ != net.history[-1, "epoch"])
                                            ~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 267, in __getitem__
    items = items[i_e]
            ~~~~~^^^^^
IndexError: list index out of range
2025-04-28 04:13:18 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 04:13:18 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 04:13:18 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 04:13:18 [ERROR] ‚ùó Method single_train_0: FAILED - list index out of range
2025-04-28 04:13:28 [DEBUG] üîç Chosen sequence: [('single_train', {'max_epochs': 5, 'save_model': True}), ('single_eval', {'save_results': True})]
2025-04-28 04:13:28 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 04:13:28 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 04:13:28 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 04:13:28 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 04:13:28 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 04:13:28 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 04:13:28 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 04:13:28 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 04:13:28 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 04:13:28 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 04:13:28 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 04:13:28 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 04:13:28 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 04:13:28 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 04:13:28 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 04:13:28 [DEBUG] üîç Method validation successful.
2025-04-28 04:13:28 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 04:13:28 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 04:13:28 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 04:13:28 [DEBUG] üîç Parameters for single_train: {'max_epochs': 5, 'save_model': True}
2025-04-28 04:13:28 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 04:13:28 [DEBUG] üîç Validation dataset type: <class 'torch.utils.data.dataset.Subset'>, Is None: False
2025-04-28 04:13:28 [DEBUG] üîç Validation dataset length: 70
2025-04-28 04:13:28 [DEBUG] üîç Validation dataset has targets attribute (potentially): True
2025-04-28 04:13:28 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 04:13:28 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 04:13:28 [DEBUG] üîç Wrapping validation dataset in skorch.dataset.Dataset for X_val.
2025-04-28 04:13:28 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 04:13:31 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 04:22:29 [ERROR] ‚ùó !!! Method 'single_train' failed at step 1: list index out of range
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2345, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1946, in single_train
    self.model_adapter.fit(train_dataset, y=None, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1311, in partial_fit
    self.notify('on_train_end', X=X, y=y)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 447, in on_train_end
    self.load_best and (self.best_epoch_ != net.history[-1, "epoch"])
                                            ~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 267, in __getitem__
    items = items[i_e]
            ~~~~~^^^^^
IndexError: list index out of range
2025-04-28 04:22:29 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 04:22:29 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 04:22:29 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 04:22:29 [ERROR] ‚ùó Method single_train_0: FAILED - list index out of range
2025-04-28 04:22:35 [DEBUG] üîç Chosen sequence: [('single_train', {'max_epochs': 5, 'save_model': True}), ('single_eval', {'save_results': True})]
2025-04-28 04:22:35 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 04:22:35 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 04:22:35 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 04:22:35 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 04:22:35 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 04:22:35 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 04:22:35 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 04:22:35 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 04:22:35 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 04:22:35 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 04:22:35 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 04:22:35 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 04:22:35 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 04:22:35 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 04:22:35 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 04:22:35 [DEBUG] üîç Method validation successful.
2025-04-28 04:22:35 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 04:22:35 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 04:22:35 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 04:22:35 [DEBUG] üîç Parameters for single_train: {'max_epochs': 5, 'save_model': True}
2025-04-28 04:22:35 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 04:22:35 [DEBUG] üîç Validation dataset type: <class 'torch.utils.data.dataset.Subset'>, Is None: False
2025-04-28 04:22:35 [DEBUG] üîç Validation dataset length: 70
2025-04-28 04:22:35 [DEBUG] üîç Validation dataset has targets attribute (potentially): True
2025-04-28 04:22:35 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 04:22:35 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 04:22:35 [DEBUG] üîç Wrapping validation dataset in skorch.dataset.Dataset for X_val.
2025-04-28 04:22:35 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 04:22:35 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 04:22:36 [ERROR] ‚ùó !!! Method 'single_train' failed at step 1: "Key 'valid_loss' was not found in history."
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2345, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1946, in single_train
    self.model_adapter.fit(train_dataset, y=None, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1226, in fit_loop
    self.notify("on_epoch_end", **on_epoch_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 429, in on_epoch_end
    current_score = net.history[-1, self.monitor]
                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 291, in __getitem__
    raise KeyError(keyerror_msg.format(key))
KeyError: "Key 'valid_loss' was not found in history."
2025-04-28 04:22:36 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 04:22:36 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 04:22:36 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 04:22:36 [ERROR] ‚ùó Method single_train_0: FAILED - "Key 'valid_loss' was not found in history."
2025-04-28 04:27:26 [DEBUG] üîç Chosen sequence: [('single_train', {'max_epochs': 5, 'save_model': True}), ('single_eval', {'save_results': True})]
2025-04-28 04:27:26 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 04:27:26 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 04:27:26 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 04:27:26 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 04:27:26 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 04:27:26 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 04:27:26 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 04:27:26 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 04:27:26 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 04:27:26 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 04:27:26 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 04:27:26 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 04:27:26 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 04:27:26 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 04:27:26 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 04:27:26 [DEBUG] üîç Method validation successful.
2025-04-28 04:27:26 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 04:27:26 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 04:27:26 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 04:27:26 [DEBUG] üîç Parameters for single_train: {'max_epochs': 5, 'save_model': True}
2025-04-28 04:27:26 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 04:27:26 [DEBUG] üîç Validation dataset type: <class 'torch.utils.data.dataset.Subset'>, Is None: False
2025-04-28 04:27:26 [DEBUG] üîç Validation dataset length: 70
2025-04-28 04:27:26 [DEBUG] üîç Validation dataset has targets attribute (potentially): True
2025-04-28 04:27:26 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 04:27:26 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 04:27:26 [DEBUG] üîç Wrapping validation dataset in skorch.dataset.Dataset for X_val.
2025-04-28 04:27:26 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 04:27:26 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 04:27:56 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: Found X_val in fit_params. Using it for validation.
2025-04-28 04:31:26 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:31:36 [ERROR] ‚ùó !!! Method 'single_train' failed at step 1: module 'skorch.utils' has no attribute 'unpack_data'
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2374, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1975, in single_train
    self.model_adapter.fit(train_dataset, y=None, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1223, in fit_loop
    self.run_single_epoch(iterator_valid, training=False, prefix="valid",
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1256, in run_single_epoch
    step = step_fn(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1052, in validation_step
    Xi, yi = skorch.utils.unpack_data(batch)
             ^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: module 'skorch.utils' has no attribute 'unpack_data'
2025-04-28 04:31:36 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 04:31:36 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 04:31:36 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 04:31:36 [ERROR] ‚ùó Method single_train_0: FAILED - module 'skorch.utils' has no attribute 'unpack_data'
2025-04-28 04:32:45 [DEBUG] üîç Chosen sequence: [('single_train', {'max_epochs': 5, 'save_model': True}), ('single_eval', {'save_results': True})]
2025-04-28 04:32:45 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 04:32:45 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 04:32:45 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 04:32:45 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 04:32:45 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 04:32:45 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 04:32:45 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 04:32:45 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 04:32:45 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 04:32:45 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 04:32:45 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 04:32:45 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 04:32:45 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 04:32:45 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 04:32:45 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 04:32:45 [DEBUG] üîç Method validation successful.
2025-04-28 04:32:45 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 04:32:45 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 04:32:45 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 04:32:45 [DEBUG] üîç Parameters for single_train: {'max_epochs': 5, 'save_model': True}
2025-04-28 04:32:45 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 04:32:45 [DEBUG] üîç Validation dataset type: <class 'torch.utils.data.dataset.Subset'>, Is None: False
2025-04-28 04:32:45 [DEBUG] üîç Validation dataset length: 70
2025-04-28 04:32:45 [DEBUG] üîç Validation dataset has targets attribute (potentially): True
2025-04-28 04:32:45 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 04:32:45 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 04:32:45 [DEBUG] üîç Wrapping validation dataset in skorch.dataset.Dataset for X_val.
2025-04-28 04:32:45 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 04:32:45 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 04:32:48 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: Found X_val in fit_params. Using it for validation.
2025-04-28 04:32:55 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:33:03 [ERROR] ‚ùó !!! Method 'single_train' failed at step 1: 'list' object has no attribute 'to'
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2380, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1981, in single_train
    self.model_adapter.fit(train_dataset, y=None, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1223, in fit_loop
    self.run_single_epoch(iterator_valid, training=False, prefix="valid",
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1256, in run_single_epoch
    step = step_fn(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1065, in validation_step
    y_pred = self.infer(Xi, **fit_params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1037, in infer
    x = x.to(self.device)
        ^^^^
AttributeError: 'list' object has no attribute 'to'
2025-04-28 04:33:03 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 04:33:03 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 04:33:03 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 04:33:03 [ERROR] ‚ùó Method single_train_0: FAILED - 'list' object has no attribute 'to'
2025-04-28 04:35:52 [DEBUG] üîç Chosen sequence: [('single_train', {'max_epochs': 5, 'save_model': True}), ('single_eval', {'save_results': True})]
2025-04-28 04:35:52 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 04:35:52 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 04:35:52 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 04:35:52 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 04:35:52 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 04:35:52 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 04:35:52 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 04:35:52 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 04:35:52 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 04:35:52 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 04:35:52 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 04:35:52 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 04:35:52 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 04:35:52 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 04:35:52 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 04:35:52 [DEBUG] üîç Method validation successful.
2025-04-28 04:35:52 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 04:35:52 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 04:35:52 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 04:35:52 [DEBUG] üîç Parameters for single_train: {'max_epochs': 5, 'save_model': True}
2025-04-28 04:35:52 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 04:35:52 [DEBUG] üîç Validation dataset type: <class 'torch.utils.data.dataset.Subset'>, Is None: False
2025-04-28 04:35:52 [DEBUG] üîç Validation dataset length: 70
2025-04-28 04:35:52 [DEBUG] üîç Validation dataset has targets attribute (potentially): True
2025-04-28 04:35:52 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 04:35:52 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 04:35:52 [DEBUG] üîç Wrapping validation dataset in skorch.dataset.Dataset for X_val.
2025-04-28 04:35:52 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 04:35:52 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 04:35:52 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: Found X_val in fit_params. Using it for validation.
2025-04-28 04:35:53 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:35:53 [ERROR] ‚ùó Failed to unpack batch in validation_step after moving to device. Batch type: <class 'list'>. Error: Xi unpacked from batch is not a Tensor, but <class 'list'>
2025-04-28 04:35:53 [ERROR] ‚ùó !!! Method 'single_train' failed at step 1: Could not unpack batch in validation_step. Expected (Tensor, Tensor) structure.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1060, in validation_step
    raise TypeError(f"Xi unpacked from batch is not a Tensor, but {type(Xi)}")
TypeError: Xi unpacked from batch is not a Tensor, but <class 'list'>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2387, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1988, in single_train
    self.model_adapter.fit(train_dataset, y=None, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1223, in fit_loop
    self.run_single_epoch(iterator_valid, training=False, prefix="valid",
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1256, in run_single_epoch
    step = step_fn(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1066, in validation_step
    raise ValueError("Could not unpack batch in validation_step. Expected (Tensor, Tensor) structure.") from e
ValueError: Could not unpack batch in validation_step. Expected (Tensor, Tensor) structure.
2025-04-28 04:35:53 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 04:35:53 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 04:35:53 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 04:35:53 [ERROR] ‚ùó Method single_train_0: FAILED - Could not unpack batch in validation_step. Expected (Tensor, Tensor) structure.
2025-04-28 04:36:08 [DEBUG] üîç Chosen sequence: [('single_train', {'max_epochs': 5, 'save_model': True}), ('single_eval', {'save_results': True})]
2025-04-28 04:36:08 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 04:36:08 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 04:36:08 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 04:36:08 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 04:36:08 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 04:36:08 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 04:36:08 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 04:36:08 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 04:36:08 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 04:36:08 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 04:36:08 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 04:36:08 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 04:36:08 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 04:36:08 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 04:36:08 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 04:36:08 [DEBUG] üîç Method validation successful.
2025-04-28 04:36:08 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 04:36:08 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 04:36:08 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 04:36:08 [DEBUG] üîç Parameters for single_train: {'max_epochs': 5, 'save_model': True}
2025-04-28 04:36:08 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 04:36:08 [DEBUG] üîç Validation dataset type: <class 'torch.utils.data.dataset.Subset'>, Is None: False
2025-04-28 04:36:08 [DEBUG] üîç Validation dataset length: 70
2025-04-28 04:36:08 [DEBUG] üîç Validation dataset has targets attribute (potentially): True
2025-04-28 04:36:08 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 04:36:08 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 04:36:08 [DEBUG] üîç Wrapping validation dataset in skorch.dataset.Dataset for X_val.
2025-04-28 04:36:08 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 04:36:08 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 04:36:19 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: Found X_val in fit_params. Using it for validation.
2025-04-28 04:36:24 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:36:33 [ERROR] ‚ùó Failed to unpack batch in validation_step after moving to device. Batch type: <class 'list'>. Error: Xi unpacked from batch is not a Tensor, but <class 'list'>
2025-04-28 04:36:33 [ERROR] ‚ùó !!! Method 'single_train' failed at step 1: Could not unpack batch in validation_step. Expected (Tensor, Tensor) structure.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1060, in validation_step
    raise TypeError(f"Xi unpacked from batch is not a Tensor, but {type(Xi)}")
TypeError: Xi unpacked from batch is not a Tensor, but <class 'list'>

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2387, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1988, in single_train
    self.model_adapter.fit(train_dataset, y=None, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1223, in fit_loop
    self.run_single_epoch(iterator_valid, training=False, prefix="valid",
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1256, in run_single_epoch
    step = step_fn(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1066, in validation_step
    raise ValueError("Could not unpack batch in validation_step. Expected (Tensor, Tensor) structure.") from e
ValueError: Could not unpack batch in validation_step. Expected (Tensor, Tensor) structure.
2025-04-28 04:36:33 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 04:36:33 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 04:36:33 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 04:36:33 [ERROR] ‚ùó Method single_train_0: FAILED - Could not unpack batch in validation_step. Expected (Tensor, Tensor) structure.
2025-04-28 04:39:39 [DEBUG] üîç Chosen sequence: [('single_train', {'max_epochs': 5, 'save_model': True}), ('single_eval', {'save_results': True})]
2025-04-28 04:39:39 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 04:39:39 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 04:39:39 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 04:39:39 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 04:39:39 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 04:39:39 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 04:39:39 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 04:39:39 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 04:39:39 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 04:39:39 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 04:39:39 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 04:39:39 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 04:39:39 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 04:39:39 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 04:39:39 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 04:39:39 [DEBUG] üîç Method validation successful.
2025-04-28 04:39:39 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 04:39:39 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 04:39:39 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 04:39:39 [DEBUG] üîç Parameters for single_train: {'max_epochs': 5, 'save_model': True}
2025-04-28 04:39:39 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 04:39:39 [DEBUG] üîç Validation dataset type: <class 'torch.utils.data.dataset.Subset'>, Is None: False
2025-04-28 04:39:39 [DEBUG] üîç Validation dataset length: 70
2025-04-28 04:39:39 [DEBUG] üîç Validation dataset has targets attribute (potentially): True
2025-04-28 04:39:39 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 04:39:39 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 04:39:39 [DEBUG] üîç Passing validation Subset directly as X_val.
2025-04-28 04:39:39 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 04:39:39 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 04:39:39 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: Found X_val in fit_params. Using it for validation.
2025-04-28 04:39:40 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:39:40 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.6611
2025-04-28 04:39:40 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:39:40 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.8216
2025-04-28 04:39:41 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:39:41 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.8078
2025-04-28 04:39:41 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:39:41 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.5953
2025-04-28 04:39:41 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:39:41 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.9848
2025-04-28 04:39:41 [ERROR] ‚ùó !!! Method 'single_train' failed at step 1: SkorchModelAdapter could not infer the classes from y; this error probably occurred because the net was trained without y and some function tried to access the '.classes_' attribute; a possible solution is to provide the 'classes' argument when initializing SkorchModelAdapter
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 103, in classes_
    return self.classes_inferred_
           ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'SkorchModelAdapter' object has no attribute 'classes_inferred_'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2380, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1981, in single_train
    self.model_adapter.fit(train_dataset, y=None, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1226, in fit_loop
    self.notify("on_epoch_end", **on_epoch_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\scoring.py", line 454, in on_epoch_end
    current_score = self._scoring(cached_net, X_test, y_test)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\scoring.py", line 146, in _scoring
    return scorer(net, X_test, y_test)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\metrics\_scorer.py", line 288, in __call__
    return self._score(partial(_cached_call, None), estimator, X, y_true, **_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\metrics\_scorer.py", line 380, in _score
    y_pred = method_caller(
             ^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\metrics\_scorer.py", line 90, in _cached_call
    result, _ = _get_response_values(
                ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\utils\_response.py", line 202, in _get_response_values
    classes = estimator.classes_
              ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 115, in classes_
    raise AttributeError(msg) from exc
AttributeError: SkorchModelAdapter could not infer the classes from y; this error probably occurred because the net was trained without y and some function tried to access the '.classes_' attribute; a possible solution is to provide the 'classes' argument when initializing SkorchModelAdapter
2025-04-28 04:39:41 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 04:39:41 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 04:39:41 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 04:39:41 [ERROR] ‚ùó Method single_train_0: FAILED - SkorchModelAdapter could not infer the classes from y; this error probably occurred because the net was trained without y and some function tried to access the '.classes_' attribute; a possible solution is to provide the 'classes' argument when initializing SkorchModelAdapter
2025-04-28 04:42:46 [DEBUG] üîç Chosen sequence: [('single_train', {'max_epochs': 5, 'save_model': True}), ('single_eval', {'save_results': True})]
2025-04-28 04:42:46 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 04:42:46 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 04:42:46 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 04:42:46 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 04:42:46 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 04:42:46 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 04:42:46 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 04:42:46 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 04:42:46 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 04:42:46 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 04:42:46 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 04:42:46 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 04:42:46 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 04:42:46 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 04:42:46 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 04:42:46 [DEBUG] üîç Method validation successful.
2025-04-28 04:42:46 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 04:42:46 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 04:42:46 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 04:42:46 [DEBUG] üîç Parameters for single_train: {'max_epochs': 5, 'save_model': True}
2025-04-28 04:42:46 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 04:42:46 [DEBUG] üîç Validation dataset type: <class 'torch.utils.data.dataset.Subset'>, Is None: False
2025-04-28 04:42:46 [DEBUG] üîç Validation dataset length: 70
2025-04-28 04:42:46 [DEBUG] üîç Validation dataset has targets attribute (potentially): True
2025-04-28 04:42:46 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 04:42:46 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 04:42:46 [DEBUG] üîç Passing validation Subset directly as X_val.
2025-04-28 04:42:46 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 04:42:46 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 04:42:46 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: Found X_val in fit_params. Using it for validation.
2025-04-28 04:42:47 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:42:47 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.6628
2025-04-28 04:42:47 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:42:47 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.8224
2025-04-28 04:42:47 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:42:47 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.8075
2025-04-28 04:42:47 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:42:47 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.5966
2025-04-28 04:42:47 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:42:47 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.9845
2025-04-28 04:42:48 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:42:48 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.4330
2025-04-28 04:42:48 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:42:48 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.6243
2025-04-28 04:42:48 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:42:48 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.5519
2025-04-28 04:42:48 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:42:48 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.5038
2025-04-28 04:42:48 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:42:48 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.8059
2025-04-28 04:42:49 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:42:49 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.3996
2025-04-28 04:42:49 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:42:49 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.6954
2025-04-28 04:42:49 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:42:49 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.5586
2025-04-28 04:42:49 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:42:49 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.4565
2025-04-28 04:42:49 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:42:49 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.9010
2025-04-28 04:42:50 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:42:50 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.0167
2025-04-28 04:42:50 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:42:50 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.5224
2025-04-28 04:42:50 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:42:50 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.3834
2025-04-28 04:42:50 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:42:50 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.1458
2025-04-28 04:42:50 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:42:50 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.8583
2025-04-28 04:42:51 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:42:51 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.0794
2025-04-28 04:42:51 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:42:51 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.4063
2025-04-28 04:42:52 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:42:52 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.2999
2025-04-28 04:42:52 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:42:52 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.1774
2025-04-28 04:42:52 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:42:52 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.5894
2025-04-28 04:42:52 [INFO] ‚ÑπÔ∏è Finished training for SimpleCNN.
2025-04-28 04:42:52 [ERROR] ‚ùó Error processing history to find best epoch: object of type 'numpy.int64' has no len()
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2011, in single_train
    best_epoch_hist = history[best_epoch_idx]
                      ~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 254, in __getitem__
    i_e, k_e, i_b, k_b = _unpack_index(i)
                         ^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 114, in _unpack_index
    if len(i) > 4:
       ^^^^^^
TypeError: object of type 'numpy.int64' has no len()
2025-04-28 04:42:52 [WARNING] ‚ö†Ô∏è Could not determine best epoch based on validation metric 'valid_loss'. Reporting last epoch stats.
2025-04-28 04:42:52 [INFO] ‚ÑπÔ∏è Training finished at Epoch 5 (Train Loss=1.4747)
2025-04-28 04:42:52 [INFO] ‚ÑπÔ∏è Model state_dict saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\cnn_epoch5_no_val_20250428_044252.pt
2025-04-28 04:42:52 [INFO] ‚ÑπÔ∏è Detailed results saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\single_train_batch_size=16_early_stopping_patience=5_lr=0.001_max_epochs=5_20250428_044252.json
2025-04-28 04:42:52 [INFO] ‚ÑπÔ∏è Summary results updated in: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\summary_results.csv
2025-04-28 04:42:52 [INFO] ‚ÑπÔ∏è --- Method single_train completed successfully ---
2025-04-28 04:42:52 [INFO] ‚ÑπÔ∏è --- Running Method 2/2: single_eval ---
2025-04-28 04:42:52 [DEBUG] üîç Parameters for single_eval: {'save_results': True}
2025-04-28 04:42:52 [INFO] ‚ÑπÔ∏è Starting model evaluation on the test set...
2025-04-28 04:42:52 [INFO] ‚ÑπÔ∏è Evaluating on 87 test samples.
2025-04-28 04:42:52 [DEBUG] üîç Generating predictions on the test set...
2025-04-28 04:42:52 [DEBUG] üîç Generating probabilities on the test set...
2025-04-28 04:42:52 [DEBUG] üîç Predictions and probabilities generated.
2025-04-28 04:42:52 [DEBUG] üîç Extracting true labels from the test set...
2025-04-28 04:43:21 [DEBUG] üîç True labels extracted.
2025-04-28 04:43:21 [DEBUG] üîç Computing evaluation metrics...
2025-04-28 04:43:21 [DEBUG] üîç Computed Metrics: Acc=0.5862, Macro F1=0.5279, Macro ROC AUC=0.8751, Macro PR AUC=0.5919
2025-04-28 04:43:21 [INFO] ‚ÑπÔ∏è Evaluation metrics computed.
2025-04-28 04:43:21 [INFO] ‚ÑπÔ∏è Detailed results saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\single_eval_20250428_044321.json
2025-04-28 04:43:21 [INFO] ‚ÑπÔ∏è Summary results updated in: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\summary_results.csv
2025-04-28 04:43:21 [INFO] ‚ÑπÔ∏è Evaluation Summary:
2025-04-28 04:43:21 [INFO] ‚ÑπÔ∏è   Accuracy: 0.5862
2025-04-28 04:43:21 [INFO] ‚ÑπÔ∏è   Macro Precision: 0.6012
2025-04-28 04:43:21 [INFO] ‚ÑπÔ∏è   Macro Recall: 0.5897
2025-04-28 04:43:21 [INFO] ‚ÑπÔ∏è   Macro Specificity: 0.9310
2025-04-28 04:43:21 [INFO] ‚ÑπÔ∏è   Macro F1-Score: 0.5279
2025-04-28 04:43:21 [INFO] ‚ÑπÔ∏è   Macro ROC AUC: 0.8751
2025-04-28 04:43:21 [INFO] ‚ÑπÔ∏è   Macro PR AUC: 0.5919
2025-04-28 04:43:21 [INFO] ‚ÑπÔ∏è --- Method single_eval completed successfully ---
2025-04-28 04:43:21 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 04:43:21 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 04:43:21 [INFO] ‚ÑπÔ∏è Method single_train_0: Completed. (Accuracy/MeanAccuracy: nan, BestScore: nan)
2025-04-28 04:43:21 [INFO] ‚ÑπÔ∏è Method single_eval_1: Completed. (Accuracy/MeanAccuracy: 0.5862, BestScore: nan)
2025-04-28 04:48:43 [DEBUG] üîç Chosen sequence: [('single_train', {'max_epochs': 5, 'save_model': True}), ('single_eval', {'save_results': True})]
2025-04-28 04:48:43 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 04:48:43 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 04:48:43 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 04:48:43 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 04:48:43 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 04:48:43 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 04:48:43 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 04:48:43 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 04:48:43 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 04:48:43 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 04:48:43 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 04:48:43 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 04:48:43 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 04:48:43 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 04:48:43 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 04:48:43 [DEBUG] üîç Method validation successful.
2025-04-28 04:48:43 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 04:48:43 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 04:48:43 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 04:48:43 [DEBUG] üîç Parameters for single_train: {'max_epochs': 5, 'save_model': True}
2025-04-28 04:48:43 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 04:48:43 [DEBUG] üîç Validation dataset type: <class 'torch.utils.data.dataset.Subset'>, Is None: False
2025-04-28 04:48:43 [DEBUG] üîç Validation dataset length: 70
2025-04-28 04:48:43 [DEBUG] üîç Validation dataset has targets attribute (potentially): True
2025-04-28 04:48:43 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 04:48:43 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 04:48:43 [DEBUG] üîç Passing validation Subset directly as X_val.
2025-04-28 04:48:43 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 04:48:43 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 04:48:43 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: Found X_val in fit_params. Using it for validation.
2025-04-28 04:48:44 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:49:36 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.6629
2025-04-28 04:49:36 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:49:44 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.8225
2025-04-28 04:49:44 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:49:48 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.8074
2025-04-28 04:49:48 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:49:51 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.5966
2025-04-28 04:49:51 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:50:01 [INFO] ‚ÑπÔ∏è Finished training for SimpleCNN.
2025-04-28 04:50:01 [WARNING] ‚ö†Ô∏è Early stopping monitor key 'valid_loss' not found in history[0]. Defaulting check to 'valid_loss'. History keys: ['batches', 'epoch', 'train_batch_count']
2025-04-28 04:50:01 [WARNING] ‚ö†Ô∏è Could not determine best epoch based on validation metric 'valid_loss'. Reporting last epoch stats.
2025-04-28 04:50:01 [INFO] ‚ÑπÔ∏è Training finished at Epoch 1 (Train Loss=nan)
2025-04-28 04:50:01 [INFO] ‚ÑπÔ∏è Model state_dict saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\cnn_epoch1_no_val_20250428_045001.pt
2025-04-28 04:50:01 [INFO] ‚ÑπÔ∏è Detailed results saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\single_train_batch_size=16_early_stopping_patience=5_lr=0.001_max_epochs=5_20250428_045001.json
2025-04-28 04:50:01 [INFO] ‚ÑπÔ∏è Summary results updated in: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\summary_results.csv
2025-04-28 04:50:01 [INFO] ‚ÑπÔ∏è --- Method single_train completed successfully ---
2025-04-28 04:50:01 [INFO] ‚ÑπÔ∏è --- Running Method 2/2: single_eval ---
2025-04-28 04:50:01 [DEBUG] üîç Parameters for single_eval: {'save_results': True}
2025-04-28 04:50:01 [INFO] ‚ÑπÔ∏è Starting model evaluation on the test set...
2025-04-28 04:50:01 [INFO] ‚ÑπÔ∏è Evaluating on 87 test samples.
2025-04-28 04:50:01 [DEBUG] üîç Generating predictions on the test set...
2025-04-28 04:50:01 [DEBUG] üîç Generating probabilities on the test set...
2025-04-28 04:50:01 [DEBUG] üîç Predictions and probabilities generated.
2025-04-28 04:50:01 [DEBUG] üîç Extracting true labels from the test set...
2025-04-28 04:51:22 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 04:51:22 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 04:51:22 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 04:51:22 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 04:51:22 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 04:51:22 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 04:51:22 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 04:51:22 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 04:51:22 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 04:51:22 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 04:51:22 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 04:51:22 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 04:51:22 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 04:51:22 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 04:51:22 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 04:51:22 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 04:51:22 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 04:51:22 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 04:51:22 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 04:51:27 [INFO] ‚ÑπÔ∏è Finished training for SimpleCNN.
2025-04-28 04:51:27 [ERROR] ‚ùó Error processing history to find best epoch: object of type 'numpy.int64' has no len()
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2011, in single_train
    best_epoch_hist = history[best_epoch_idx]
                      ~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 254, in __getitem__
    i_e, k_e, i_b, k_b = _unpack_index(i)
                         ^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 114, in _unpack_index
    if len(i) > 4:
       ^^^^^^
TypeError: object of type 'numpy.int64' has no len()
2025-04-28 04:51:27 [WARNING] ‚ö†Ô∏è Could not determine best epoch based on validation metric 'valid_loss'. Reporting last epoch stats.
2025-04-28 04:51:27 [INFO] ‚ÑπÔ∏è Training finished at Epoch 5 (Train Loss=1.4701)
2025-04-28 04:51:27 [INFO] ‚ÑπÔ∏è Model state_dict saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\cnn_epoch5_no_val_20250428_045127.pt
2025-04-28 04:51:27 [INFO] ‚ÑπÔ∏è Detailed results saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\single_train_batch_size=16_early_stopping_patience=5_lr=0.001_max_epochs=5_20250428_045127.json
2025-04-28 04:51:27 [INFO] ‚ÑπÔ∏è Summary results updated in: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\summary_results.csv
2025-04-28 04:51:27 [INFO] ‚ÑπÔ∏è --- Method single_train completed successfully ---
2025-04-28 04:51:27 [INFO] ‚ÑπÔ∏è --- Running Method 2/2: single_eval ---
2025-04-28 04:51:27 [INFO] ‚ÑπÔ∏è Starting model evaluation on the test set...
2025-04-28 04:51:27 [INFO] ‚ÑπÔ∏è Evaluating on 87 test samples.
2025-04-28 04:51:57 [INFO] ‚ÑπÔ∏è Evaluation metrics computed.
2025-04-28 04:51:57 [INFO] ‚ÑπÔ∏è Detailed results saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\single_eval_20250428_045157.json
2025-04-28 04:51:57 [INFO] ‚ÑπÔ∏è Summary results updated in: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\summary_results.csv
2025-04-28 04:51:57 [INFO] ‚ÑπÔ∏è Evaluation Summary:
2025-04-28 04:51:57 [INFO] ‚ÑπÔ∏è   Accuracy: 0.5402
2025-04-28 04:51:57 [INFO] ‚ÑπÔ∏è   Macro Precision: 0.5640
2025-04-28 04:51:57 [INFO] ‚ÑπÔ∏è   Macro Recall: 0.5430
2025-04-28 04:51:57 [INFO] ‚ÑπÔ∏è   Macro Specificity: 0.9233
2025-04-28 04:51:57 [INFO] ‚ÑπÔ∏è   Macro F1-Score: 0.4743
2025-04-28 04:51:57 [INFO] ‚ÑπÔ∏è   Macro ROC AUC: 0.8743
2025-04-28 04:51:57 [INFO] ‚ÑπÔ∏è   Macro PR AUC: 0.5946
2025-04-28 04:51:57 [INFO] ‚ÑπÔ∏è --- Method single_eval completed successfully ---
2025-04-28 04:51:57 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 04:51:57 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 04:51:57 [INFO] ‚ÑπÔ∏è Method single_train_0: Completed. (Accuracy/MeanAccuracy: nan, BestScore: nan)
2025-04-28 04:51:57 [INFO] ‚ÑπÔ∏è Method single_eval_1: Completed. (Accuracy/MeanAccuracy: 0.5402, BestScore: nan)
2025-04-28 04:53:30 [DEBUG] üîç Chosen sequence: [('single_train', {'max_epochs': 5, 'save_model': True}), ('single_eval', {'save_results': True})]
2025-04-28 04:53:30 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 04:53:30 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 04:53:30 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 04:53:30 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 04:53:30 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 04:53:30 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 04:53:30 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 04:53:30 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 04:53:30 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 04:53:30 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 04:53:30 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 04:53:30 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 04:53:30 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 04:53:30 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 04:53:30 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 04:53:30 [DEBUG] üîç Method validation successful.
2025-04-28 04:53:30 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 04:53:30 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 04:53:30 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 04:53:30 [DEBUG] üîç Parameters for single_train: {'max_epochs': 5, 'save_model': True}
2025-04-28 04:53:30 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 04:53:30 [DEBUG] üîç Validation dataset type: <class 'torch.utils.data.dataset.Subset'>, Is None: False
2025-04-28 04:53:30 [DEBUG] üîç Validation dataset length: 70
2025-04-28 04:53:30 [DEBUG] üîç Validation dataset has targets attribute (potentially): True
2025-04-28 04:53:30 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 04:53:30 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 04:53:30 [DEBUG] üîç Passing validation Subset directly as X_val.
2025-04-28 04:53:30 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 04:53:30 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 04:53:30 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: Found X_val in fit_params. Using it for validation.
2025-04-28 04:53:31 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:53:31 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.6605
2025-04-28 04:53:31 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:53:31 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.8214
2025-04-28 04:53:31 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:53:31 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.8062
2025-04-28 04:53:31 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:53:31 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.5956
2025-04-28 04:53:31 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:53:31 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.9840
2025-04-28 04:53:32 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:53:32 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.4287
2025-04-28 04:53:32 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:53:32 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.6288
2025-04-28 04:53:32 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:53:32 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.5486
2025-04-28 04:53:32 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:53:32 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.4999
2025-04-28 04:53:32 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:53:32 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.8120
2025-04-28 04:53:33 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:53:33 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.4080
2025-04-28 04:53:33 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:53:33 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.7045
2025-04-28 04:53:33 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:53:33 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.5578
2025-04-28 04:53:33 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:53:33 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.4736
2025-04-28 04:53:33 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:53:33 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.9042
2025-04-28 04:53:34 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:53:34 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.0388
2025-04-28 04:53:34 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:53:34 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.5250
2025-04-28 04:53:34 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:53:34 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.3683
2025-04-28 04:53:34 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:53:34 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.1711
2025-04-28 04:53:34 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:53:34 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.8614
2025-04-28 04:53:35 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:53:35 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.0529
2025-04-28 04:53:35 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:53:35 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.3651
2025-04-28 04:53:35 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:53:35 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.3013
2025-04-28 04:53:35 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:53:35 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.1735
2025-04-28 04:53:35 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 04:53:35 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.5596
2025-04-28 04:53:35 [INFO] ‚ÑπÔ∏è Finished training for SimpleCNN.
2025-04-28 04:53:35 [ERROR] ‚ùó Error processing history to find best epoch: object of type 'numpy.int64' has no len()
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2011, in single_train
    best_epoch_hist = history[best_epoch_idx]
                      ~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 254, in __getitem__
    i_e, k_e, i_b, k_b = _unpack_index(i)
                         ^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 114, in _unpack_index
    if len(i) > 4:
       ^^^^^^
TypeError: object of type 'numpy.int64' has no len()
2025-04-28 04:53:35 [WARNING] ‚ö†Ô∏è Could not determine best epoch based on validation metric 'valid_loss'. Reporting last epoch stats.
2025-04-28 04:53:35 [INFO] ‚ÑπÔ∏è Training finished at Epoch 5 (Train Loss=1.4756)
2025-04-28 04:53:35 [INFO] ‚ÑπÔ∏è Model state_dict saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\cnn_epoch5_no_val_20250428_045335.pt
2025-04-28 04:53:35 [INFO] ‚ÑπÔ∏è Detailed results saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\single_train_batch_size=16_early_stopping_patience=5_lr=0.001_max_epochs=5_20250428_045335.json
2025-04-28 04:53:35 [INFO] ‚ÑπÔ∏è Summary results updated in: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\summary_results.csv
2025-04-28 04:53:35 [INFO] ‚ÑπÔ∏è --- Method single_train completed successfully ---
2025-04-28 04:53:35 [INFO] ‚ÑπÔ∏è --- Running Method 2/2: single_eval ---
2025-04-28 04:53:35 [DEBUG] üîç Parameters for single_eval: {'save_results': True}
2025-04-28 04:53:35 [INFO] ‚ÑπÔ∏è Starting model evaluation on the test set...
2025-04-28 04:53:35 [INFO] ‚ÑπÔ∏è Evaluating on 87 test samples.
2025-04-28 04:53:35 [DEBUG] üîç Generating predictions on the test set...
2025-04-28 04:53:35 [DEBUG] üîç Generating probabilities on the test set...
2025-04-28 04:53:36 [DEBUG] üîç Predictions and probabilities generated.
2025-04-28 04:53:36 [DEBUG] üîç Extracting true labels from the test set...
2025-04-28 04:54:04 [DEBUG] üîç True labels extracted.
2025-04-28 04:54:04 [DEBUG] üîç Computing evaluation metrics...
2025-04-28 04:54:04 [DEBUG] üîç Computed Metrics: Acc=0.5977, Macro F1=0.5444, Macro ROC AUC=0.8777, Macro PR AUC=0.6126
2025-04-28 04:54:04 [INFO] ‚ÑπÔ∏è Evaluation metrics computed.
2025-04-28 04:54:04 [INFO] ‚ÑπÔ∏è Detailed results saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\single_eval_20250428_045404.json
2025-04-28 04:54:04 [INFO] ‚ÑπÔ∏è Summary results updated in: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\summary_results.csv
2025-04-28 04:54:04 [INFO] ‚ÑπÔ∏è Evaluation Summary:
2025-04-28 04:54:04 [INFO] ‚ÑπÔ∏è   Accuracy: 0.5977
2025-04-28 04:54:04 [INFO] ‚ÑπÔ∏è   Macro Precision: 0.6266
2025-04-28 04:54:04 [INFO] ‚ÑπÔ∏è   Macro Recall: 0.6007
2025-04-28 04:54:04 [INFO] ‚ÑπÔ∏è   Macro Specificity: 0.9330
2025-04-28 04:54:04 [INFO] ‚ÑπÔ∏è   Macro F1-Score: 0.5444
2025-04-28 04:54:04 [INFO] ‚ÑπÔ∏è   Macro ROC AUC: 0.8777
2025-04-28 04:54:04 [INFO] ‚ÑπÔ∏è   Macro PR AUC: 0.6126
2025-04-28 04:54:04 [INFO] ‚ÑπÔ∏è --- Method single_eval completed successfully ---
2025-04-28 04:54:04 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 04:54:04 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 04:54:04 [INFO] ‚ÑπÔ∏è Method single_train_0: Completed. (Accuracy/MeanAccuracy: nan, BestScore: nan)
2025-04-28 04:54:04 [INFO] ‚ÑπÔ∏è Method single_eval_1: Completed. (Accuracy/MeanAccuracy: 0.5977, BestScore: nan)
2025-04-28 05:00:11 [DEBUG] üîç Chosen sequence: [('single_train', {'max_epochs': 5, 'save_model': True}), ('single_eval', {'save_results': True})]
2025-04-28 05:00:11 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 05:00:11 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 05:00:11 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 05:00:11 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 05:00:11 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 05:00:11 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 05:00:11 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 05:00:11 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 05:00:11 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 05:00:11 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 05:00:11 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 05:00:11 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 05:00:11 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 05:00:11 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 05:00:11 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 05:00:11 [DEBUG] üîç Method validation successful.
2025-04-28 05:00:11 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 05:00:11 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 05:00:11 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 05:00:11 [DEBUG] üîç Parameters for single_train: {'max_epochs': 5, 'save_model': True}
2025-04-28 05:00:11 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 05:00:11 [DEBUG] üîç Validation dataset type: <class 'torch.utils.data.dataset.Subset'>, Is None: False
2025-04-28 05:00:11 [DEBUG] üîç Validation dataset length: 70
2025-04-28 05:00:11 [DEBUG] üîç Validation dataset has targets attribute (potentially): True
2025-04-28 05:00:11 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 05:00:11 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 05:00:11 [DEBUG] üîç Passing validation Subset directly as X_val.
2025-04-28 05:00:11 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:00:11 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:00:11 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: Found X_val in fit_params. Using it for validation.
2025-04-28 05:00:13 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:00:13 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.6611
2025-04-28 05:00:13 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:00:13 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.8217
2025-04-28 05:00:13 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:00:13 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.8078
2025-04-28 05:00:13 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:00:13 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.5952
2025-04-28 05:00:13 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:00:13 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.9850
2025-04-28 05:00:14 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:00:14 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.4252
2025-04-28 05:00:14 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:00:14 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.6211
2025-04-28 05:00:14 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:00:14 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.5476
2025-04-28 05:00:14 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:00:14 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.4906
2025-04-28 05:00:14 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:00:14 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.8094
2025-04-28 05:00:15 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:00:15 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.4036
2025-04-28 05:00:15 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:00:15 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.6950
2025-04-28 05:00:15 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:00:15 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.5475
2025-04-28 05:00:15 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:00:15 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.4684
2025-04-28 05:00:15 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:00:15 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.8946
2025-04-28 05:00:16 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:00:16 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.0180
2025-04-28 05:00:16 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:00:16 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.5172
2025-04-28 05:00:16 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:00:16 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.3627
2025-04-28 05:00:16 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:00:16 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.1776
2025-04-28 05:00:16 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:00:16 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.8554
2025-04-28 05:00:17 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:00:17 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.0565
2025-04-28 05:00:17 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:00:17 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.4029
2025-04-28 05:00:17 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:00:17 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.2987
2025-04-28 05:00:17 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:00:17 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.1462
2025-04-28 05:00:17 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:00:17 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.5776
2025-04-28 05:00:17 [INFO] ‚ÑπÔ∏è Finished training for SimpleCNN.
2025-04-28 05:00:17 [INFO] ‚ÑπÔ∏è Training finished. Best validation performance at Epoch 5 (valid_loss=1.2562)
2025-04-28 05:00:17 [INFO] ‚ÑπÔ∏è Model state_dict saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\cnn_epoch5_val_valid-loss1.2562_20250428_050017.pt
2025-04-28 05:00:17 [INFO] ‚ÑπÔ∏è Detailed results saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\single_train_batch_size=16_early_stopping_patience=5_lr=0.001_max_epochs=5_20250428_050017.json
2025-04-28 05:00:17 [INFO] ‚ÑπÔ∏è Summary results updated in: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\summary_results.csv
2025-04-28 05:00:17 [INFO] ‚ÑπÔ∏è --- Method single_train completed successfully ---
2025-04-28 05:00:17 [INFO] ‚ÑπÔ∏è --- Running Method 2/2: single_eval ---
2025-04-28 05:00:17 [DEBUG] üîç Parameters for single_eval: {'save_results': True}
2025-04-28 05:00:17 [INFO] ‚ÑπÔ∏è Starting model evaluation on the test set...
2025-04-28 05:00:17 [INFO] ‚ÑπÔ∏è Evaluating on 87 test samples.
2025-04-28 05:00:17 [DEBUG] üîç Generating predictions on the test set...
2025-04-28 05:00:17 [DEBUG] üîç Generating probabilities on the test set...
2025-04-28 05:00:17 [DEBUG] üîç Predictions and probabilities generated.
2025-04-28 05:00:17 [DEBUG] üîç Extracting true labels from the test set...
2025-04-28 05:00:47 [DEBUG] üîç True labels extracted.
2025-04-28 05:00:47 [DEBUG] üîç Computing evaluation metrics...
2025-04-28 05:00:47 [DEBUG] üîç Computed Metrics: Acc=0.5862, Macro F1=0.5366, Macro ROC AUC=0.8785, Macro PR AUC=0.6131
2025-04-28 05:00:47 [INFO] ‚ÑπÔ∏è Evaluation metrics computed.
2025-04-28 05:00:47 [INFO] ‚ÑπÔ∏è Detailed results saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\single_eval_20250428_050047.json
2025-04-28 05:00:47 [INFO] ‚ÑπÔ∏è Summary results updated in: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\summary_results.csv
2025-04-28 05:00:47 [INFO] ‚ÑπÔ∏è Evaluation Summary:
2025-04-28 05:00:47 [INFO] ‚ÑπÔ∏è   Accuracy: 0.5862
2025-04-28 05:00:47 [INFO] ‚ÑπÔ∏è   Macro Precision: 0.6460
2025-04-28 05:00:47 [INFO] ‚ÑπÔ∏è   Macro Recall: 0.5897
2025-04-28 05:00:47 [INFO] ‚ÑπÔ∏è   Macro Specificity: 0.9311
2025-04-28 05:00:47 [INFO] ‚ÑπÔ∏è   Macro F1-Score: 0.5366
2025-04-28 05:00:47 [INFO] ‚ÑπÔ∏è   Macro ROC AUC: 0.8785
2025-04-28 05:00:47 [INFO] ‚ÑπÔ∏è   Macro PR AUC: 0.6131
2025-04-28 05:00:47 [INFO] ‚ÑπÔ∏è --- Method single_eval completed successfully ---
2025-04-28 05:00:47 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 05:00:47 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 05:00:47 [INFO] ‚ÑπÔ∏è Method single_train_0: Completed. (Accuracy/MeanAccuracy: nan, BestScore: nan)
2025-04-28 05:00:47 [INFO] ‚ÑπÔ∏è Method single_eval_1: Completed. (Accuracy/MeanAccuracy: 0.5862, BestScore: nan)
2025-04-28 05:01:46 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 05:01:46 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 05:01:46 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 05:01:46 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 05:01:46 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 05:01:46 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 05:01:46 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 05:01:46 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 05:01:46 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 05:01:46 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 05:01:46 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 05:01:46 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 05:01:46 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 05:01:46 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 05:01:46 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 05:01:46 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 05:01:46 [DEBUG] üîç Method validation successful.
2025-04-28 05:01:46 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 05:01:46 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 05:01:46 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 05:01:46 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 05:01:46 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 05:01:46 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 05:01:46 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 05:01:46 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 05:01:46 [ERROR] ‚ùó !!! Method 'non_nested_grid_search' failed at step 1: Input should have at least 1 dimension i.e. satisfy `len(x.shape) > 0`, got scalar `array(None, dtype=object)` instead.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2388, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1510, in non_nested_grid_search
    search.fit(train_dataset, y=None)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1024, in fit
    self._run_search(evaluate_candidates)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1571, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 984, in evaluate_candidates
    enumerate(cv.split(X, y, **routed_params.splitter.split)),
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_split.py", line 881, in split
    y = check_array(y, input_name="y", ensure_2d=False, dtype=None)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\utils\validation.py", line 1128, in check_array
    n_samples = _num_samples(array)
                ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\utils\validation.py", line 399, in _num_samples
    raise TypeError(
TypeError: Input should have at least 1 dimension i.e. satisfy `len(x.shape) > 0`, got scalar `array(None, dtype=object)` instead.
2025-04-28 05:01:46 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 05:01:46 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 05:01:46 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 05:01:46 [ERROR] ‚ùó Method non_nested_grid_search_0: FAILED - Input should have at least 1 dimension i.e. satisfy `len(x.shape) > 0`, got scalar `array(None, dtype=object)` instead.
2025-04-28 05:05:56 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 05:05:56 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 05:05:56 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 05:05:56 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 05:05:56 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 05:05:56 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 05:05:56 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 05:05:56 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 05:05:56 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 05:05:56 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 05:05:56 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 05:05:56 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 05:05:56 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 05:05:56 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 05:05:56 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 05:05:56 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 05:05:56 [DEBUG] üîç Method validation successful.
2025-04-28 05:05:56 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 05:05:56 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 05:05:56 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 05:05:56 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 05:05:56 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 05:05:56 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 05:05:56 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 05:05:56 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 05:05:56 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 05:05:57 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:05:57 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:05:58 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:05:58 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:05:58 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:05:58 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:05:59 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:05:59 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:06:00 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:06:00 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:06:01 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:06:01 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:06:02 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:06:02 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:06:02 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:06:02 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:06:03 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:06:03 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:06:04 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:06:04 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:06:05 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:06:05 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:06:05 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:06:05 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:06:05 [ERROR] ‚ùó !!! Method 'non_nested_grid_search' failed at step 1: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1087, in get_split_datasets
    dataset_train = self.get_dataset(X, y) # Process the training data input
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2435, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1556, in non_nested_grid_search
    search.fit(train_dataset, y=y_train)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1024, in fit
    self._run_search(evaluate_candidates)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1571, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1001, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 517, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1087, in get_split_datasets
    dataset_train = self.get_dataset(X, y) # Process the training data input
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

2025-04-28 05:06:05 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 05:06:05 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 05:06:05 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 05:06:05 [ERROR] ‚ùó Method non_nested_grid_search_0: FAILED - 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1087, in get_split_datasets
    dataset_train = self.get_dataset(X, y) # Process the training data input
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

2025-04-28 05:10:38 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 05:10:38 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 05:10:38 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 05:10:38 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 05:10:38 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 05:10:38 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 05:10:38 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 05:10:38 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 05:10:38 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 05:10:38 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 05:10:38 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 05:10:38 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 05:10:38 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 05:10:38 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 05:10:38 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 05:10:38 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 05:10:38 [DEBUG] üîç Method validation successful.
2025-04-28 05:10:38 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 05:10:38 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 05:10:38 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 05:10:38 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 05:10:38 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 05:10:38 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 05:10:38 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 05:10:38 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 05:10:38 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 05:10:38 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:10:38 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:10:39 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:10:39 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:10:40 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:10:40 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:10:41 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:10:41 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:10:42 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:10:42 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:10:42 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:10:42 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:10:43 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:10:43 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:10:44 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:10:44 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:10:45 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:10:45 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:10:45 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:10:45 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:10:46 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:10:46 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:10:47 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:10:47 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:10:47 [ERROR] ‚ùó !!! Method 'non_nested_grid_search' failed at step 1: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1022, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1090, in get_split_datasets
    dataset_train = self.get_dataset(X, y) # Process the training data input
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2438, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1559, in non_nested_grid_search
    search.fit(train_dataset, y=y_train)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1024, in fit
    self._run_search(evaluate_candidates)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1571, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1001, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 517, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1022, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1090, in get_split_datasets
    dataset_train = self.get_dataset(X, y) # Process the training data input
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

2025-04-28 05:10:47 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 05:10:47 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 05:10:47 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 05:10:47 [ERROR] ‚ùó Method non_nested_grid_search_0: FAILED - 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1022, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1090, in get_split_datasets
    dataset_train = self.get_dataset(X, y) # Process the training data input
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

2025-04-28 05:11:46 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 05:11:46 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 05:11:46 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 05:11:46 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 05:11:46 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 05:11:46 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 05:11:46 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 05:11:46 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 05:11:46 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 05:11:46 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 05:11:46 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 05:11:46 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 05:11:46 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 05:11:46 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 05:11:46 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 05:11:46 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 05:11:46 [DEBUG] üîç Method validation successful.
2025-04-28 05:11:46 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 05:11:46 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 05:11:46 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 05:11:46 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 05:11:46 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 05:11:46 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 05:11:46 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 05:11:46 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 05:11:46 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 05:11:47 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:11:49 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:11:50 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:11:57 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:11:57 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:12:42 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:12:43 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:14:56 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 05:14:56 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 05:14:56 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 05:14:56 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 05:14:56 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 05:14:56 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 05:14:56 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 05:14:56 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 05:14:56 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 05:14:56 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 05:14:56 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 05:14:56 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 05:14:56 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 05:14:56 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 05:14:56 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 05:14:56 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 05:14:56 [DEBUG] üîç Method validation successful.
2025-04-28 05:14:56 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 05:14:56 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 05:14:56 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 05:14:56 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 05:14:56 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 05:14:56 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 05:14:56 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 05:14:56 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 05:14:56 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 05:14:57 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:14:57 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:14:58 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:14:58 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:14:59 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:14:59 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:14:59 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:14:59 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:15:00 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:15:00 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:15:01 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:15:01 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:15:02 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:15:02 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:15:02 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:15:02 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:15:03 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:15:03 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:15:04 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:15:04 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:15:05 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:15:05 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:15:05 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:15:05 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:15:05 [ERROR] ‚ùó !!! Method 'non_nested_grid_search' failed at step 1: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1022, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1090, in get_split_datasets
    dataset_train = self.get_dataset(X, y) # Process the training data input
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2438, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1559, in non_nested_grid_search
    search.fit(train_dataset, y=y_train)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1024, in fit
    self._run_search(evaluate_candidates)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1571, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1001, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 517, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1022, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1090, in get_split_datasets
    dataset_train = self.get_dataset(X, y) # Process the training data input
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

2025-04-28 05:15:05 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 05:15:05 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 05:15:05 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 05:15:05 [ERROR] ‚ùó Method non_nested_grid_search_0: FAILED - 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1022, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1090, in get_split_datasets
    dataset_train = self.get_dataset(X, y) # Process the training data input
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

2025-04-28 05:17:01 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 05:17:01 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 05:17:01 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 05:17:01 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 05:17:01 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 05:17:01 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 05:17:01 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 05:17:01 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 05:17:01 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 05:17:01 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 05:17:01 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 05:17:01 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 05:17:01 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 05:17:01 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 05:17:01 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 05:17:01 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 05:17:01 [DEBUG] üîç Method validation successful.
2025-04-28 05:17:01 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 05:17:01 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 05:17:01 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 05:17:01 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 05:17:01 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 05:17:01 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 05:17:01 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 05:17:01 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 05:17:01 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 05:17:02 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:17:02 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:17:02 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:17:02 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:17:02 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:17:02 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:17:03 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:17:03 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:17:03 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:17:04 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:17:04 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:17:04 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:17:05 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:17:05 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:17:05 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:17:06 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:17:06 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:17:06 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:17:06 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:17:06 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:17:06 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:17:07 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:17:07 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:17:07 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:17:08 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:17:08 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:17:08 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:17:09 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:17:09 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:17:09 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:17:09 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:17:09 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:17:09 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:17:10 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:17:10 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:17:10 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:17:10 [ERROR] ‚ùó !!! Method 'non_nested_grid_search' failed at step 1: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1022, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1102, in get_split_datasets
    dataset_train = self.get_dataset(X, y)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2456, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1577, in non_nested_grid_search
    search.fit(train_dataset, y=y_train)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1024, in fit
    self._run_search(evaluate_candidates)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1571, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1001, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 517, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1022, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1102, in get_split_datasets
    dataset_train = self.get_dataset(X, y)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

2025-04-28 05:17:10 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 05:17:10 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 05:17:10 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 05:17:10 [ERROR] ‚ùó Method non_nested_grid_search_0: FAILED - 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1022, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1102, in get_split_datasets
    dataset_train = self.get_dataset(X, y)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

2025-04-28 05:18:36 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 05:18:36 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 05:18:36 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 05:18:36 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 05:18:36 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 05:18:36 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 05:18:36 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 05:18:36 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 05:18:36 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 05:18:36 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 05:18:36 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 05:18:36 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 05:18:36 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 05:18:36 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 05:18:36 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 05:18:36 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 05:18:36 [DEBUG] üîç Method validation successful.
2025-04-28 05:18:36 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 05:18:36 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 05:18:36 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 05:18:36 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 05:18:36 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 05:18:36 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 05:18:36 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 05:18:36 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 05:18:36 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 05:18:37 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:18:37 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:18:37 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:18:38 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:18:38 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:18:38 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:18:39 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:18:39 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:18:39 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:18:39 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:18:39 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:18:39 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:18:40 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:18:40 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:18:40 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:18:41 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:18:41 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:18:41 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:18:42 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:18:42 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:18:42 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:18:42 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:18:43 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:18:43 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:18:43 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:18:43 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:18:43 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:18:44 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:18:44 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:18:44 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:18:45 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:18:45 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:18:45 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:18:45 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:18:46 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:18:46 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:18:46 [ERROR] ‚ùó !!! Method 'non_nested_grid_search' failed at step 1: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1010, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1090, in get_split_datasets
    dataset_train = self.get_dataset(X, y)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2444, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1565, in non_nested_grid_search
    search.fit(train_dataset, y=y_train)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1024, in fit
    self._run_search(evaluate_candidates)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1571, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1001, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 517, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1010, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1090, in get_split_datasets
    dataset_train = self.get_dataset(X, y)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

2025-04-28 05:18:46 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 05:18:46 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 05:18:46 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 05:18:46 [ERROR] ‚ùó Method non_nested_grid_search_0: FAILED - 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1010, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1090, in get_split_datasets
    dataset_train = self.get_dataset(X, y)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

2025-04-28 05:19:25 [DEBUG] üîç Chosen sequence: [('single_train', {'max_epochs': 5, 'save_model': True}), ('single_eval', {'save_results': True})]
2025-04-28 05:19:25 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 05:19:25 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 05:19:25 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 05:19:25 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 05:19:25 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 05:19:25 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 05:19:25 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 05:19:25 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 05:19:25 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 05:19:25 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 05:19:25 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 05:19:25 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 05:19:25 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 05:19:25 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 05:19:25 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 05:19:25 [DEBUG] üîç Method validation successful.
2025-04-28 05:19:25 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 05:19:25 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 05:19:25 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 05:19:25 [DEBUG] üîç Parameters for single_train: {'max_epochs': 5, 'save_model': True}
2025-04-28 05:19:25 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 05:19:25 [DEBUG] üîç Validation dataset type: <class 'torch.utils.data.dataset.Subset'>, Is None: False
2025-04-28 05:19:25 [DEBUG] üîç Validation dataset length: 70
2025-04-28 05:19:25 [DEBUG] üîç Validation dataset has targets attribute (potentially): True
2025-04-28 05:19:25 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 05:19:25 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 05:19:25 [DEBUG] üîç Passing validation Subset directly as X_val.
2025-04-28 05:19:25 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:19:25 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:19:25 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: Found X_val in fit_params. Processing validation set.
2025-04-28 05:19:26 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:19:26 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.6605
2025-04-28 05:19:26 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:19:26 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.8220
2025-04-28 05:19:26 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:19:26 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.8071
2025-04-28 05:19:26 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:19:26 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.5961
2025-04-28 05:19:26 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:19:26 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.9857
2025-04-28 05:19:27 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:19:27 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.4308
2025-04-28 05:19:27 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:19:27 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.6223
2025-04-28 05:19:27 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:19:27 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.5505
2025-04-28 05:19:27 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:19:27 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.4958
2025-04-28 05:19:27 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:19:27 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.8095
2025-04-28 05:19:28 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:19:28 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.4146
2025-04-28 05:19:28 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:19:28 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.7000
2025-04-28 05:19:28 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:19:28 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.5505
2025-04-28 05:19:28 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:19:28 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.4753
2025-04-28 05:19:28 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:19:28 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.9023
2025-04-28 05:19:29 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:19:29 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.0081
2025-04-28 05:19:29 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:19:29 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.5082
2025-04-28 05:19:29 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:19:29 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.3944
2025-04-28 05:19:29 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:19:29 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.1620
2025-04-28 05:19:29 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:19:29 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.8679
2025-04-28 05:19:30 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:19:30 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.0612
2025-04-28 05:19:30 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:19:30 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.3823
2025-04-28 05:19:30 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:19:30 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.2861
2025-04-28 05:19:30 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:19:30 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.1633
2025-04-28 05:19:30 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:19:30 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.5749
2025-04-28 05:19:30 [INFO] ‚ÑπÔ∏è Finished training for SimpleCNN.
2025-04-28 05:19:30 [INFO] ‚ÑπÔ∏è Training finished. Best validation performance at Epoch 5 (valid_loss=1.2534)
2025-04-28 05:19:30 [INFO] ‚ÑπÔ∏è Model state_dict saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\cnn_epoch5_val_valid-loss1.2534_20250428_051930.pt
2025-04-28 05:19:30 [INFO] ‚ÑπÔ∏è Detailed results saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\single_train_batch_size=16_early_stopping_patience=5_lr=0.001_max_epochs=5_20250428_051930.json
2025-04-28 05:19:30 [INFO] ‚ÑπÔ∏è Summary results updated in: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\summary_results.csv
2025-04-28 05:19:30 [INFO] ‚ÑπÔ∏è --- Method single_train completed successfully ---
2025-04-28 05:19:30 [INFO] ‚ÑπÔ∏è --- Running Method 2/2: single_eval ---
2025-04-28 05:19:30 [DEBUG] üîç Parameters for single_eval: {'save_results': True}
2025-04-28 05:19:30 [INFO] ‚ÑπÔ∏è Starting model evaluation on the test set...
2025-04-28 05:19:30 [INFO] ‚ÑπÔ∏è Evaluating on 87 test samples.
2025-04-28 05:19:30 [DEBUG] üîç Generating predictions on the test set...
2025-04-28 05:19:31 [DEBUG] üîç Generating probabilities on the test set...
2025-04-28 05:19:31 [DEBUG] üîç Predictions and probabilities generated.
2025-04-28 05:19:31 [DEBUG] üîç Extracting true labels from the test set...
2025-04-28 05:20:00 [DEBUG] üîç True labels extracted.
2025-04-28 05:20:00 [DEBUG] üîç Computing evaluation metrics...
2025-04-28 05:20:00 [DEBUG] üîç Computed Metrics: Acc=0.5747, Macro F1=0.5132, Macro ROC AUC=0.8757, Macro PR AUC=0.5924
2025-04-28 05:20:00 [INFO] ‚ÑπÔ∏è Evaluation metrics computed.
2025-04-28 05:20:00 [INFO] ‚ÑπÔ∏è Detailed results saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\single_eval_20250428_052000.json
2025-04-28 05:20:00 [INFO] ‚ÑπÔ∏è Summary results updated in: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\summary_results.csv
2025-04-28 05:20:00 [INFO] ‚ÑπÔ∏è Evaluation Summary:
2025-04-28 05:20:00 [INFO] ‚ÑπÔ∏è   Accuracy: 0.5747
2025-04-28 05:20:00 [INFO] ‚ÑπÔ∏è   Macro Precision: 0.5774
2025-04-28 05:20:00 [INFO] ‚ÑπÔ∏è   Macro Recall: 0.5788
2025-04-28 05:20:00 [INFO] ‚ÑπÔ∏è   Macro Specificity: 0.9291
2025-04-28 05:20:00 [INFO] ‚ÑπÔ∏è   Macro F1-Score: 0.5132
2025-04-28 05:20:00 [INFO] ‚ÑπÔ∏è   Macro ROC AUC: 0.8757
2025-04-28 05:20:00 [INFO] ‚ÑπÔ∏è   Macro PR AUC: 0.5924
2025-04-28 05:20:00 [INFO] ‚ÑπÔ∏è --- Method single_eval completed successfully ---
2025-04-28 05:20:00 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 05:20:00 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 05:20:00 [INFO] ‚ÑπÔ∏è Method single_train_0: Completed. (Accuracy/MeanAccuracy: nan, BestScore: nan)
2025-04-28 05:20:00 [INFO] ‚ÑπÔ∏è Method single_eval_1: Completed. (Accuracy/MeanAccuracy: 0.5747, BestScore: nan)
2025-04-28 05:20:46 [DEBUG] üîç Chosen sequence: [('single_train', {'max_epochs': 5, 'save_model': True}), ('single_eval', {'save_results': True})]
2025-04-28 05:20:46 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 05:20:46 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 05:20:46 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 05:20:46 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 05:20:46 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 05:20:46 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 05:20:46 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 05:20:46 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 05:20:46 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 05:20:46 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 05:20:46 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 05:20:46 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 05:20:46 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 05:20:46 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 05:20:46 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 05:20:46 [DEBUG] üîç Method validation successful.
2025-04-28 05:20:46 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 05:20:46 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 05:20:46 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 05:20:46 [DEBUG] üîç Parameters for single_train: {'max_epochs': 5, 'save_model': True}
2025-04-28 05:20:46 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 05:20:46 [DEBUG] üîç Validation dataset type: <class 'torch.utils.data.dataset.Subset'>, Is None: False
2025-04-28 05:20:46 [DEBUG] üîç Validation dataset length: 70
2025-04-28 05:20:46 [DEBUG] üîç Validation dataset has targets attribute (potentially): True
2025-04-28 05:20:46 [INFO] ‚ÑπÔ∏è Training on 277 samples, validating on 70 samples.
2025-04-28 05:20:46 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 05:20:46 [DEBUG] üîç Passing validation Subset directly as X_val.
2025-04-28 05:20:46 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:20:46 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:20:46 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: Found X_val in fit_params. Processing validation set.
2025-04-28 05:20:47 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:20:47 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.6603
2025-04-28 05:20:47 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:20:47 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.8219
2025-04-28 05:20:47 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:20:47 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.8072
2025-04-28 05:20:47 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:20:47 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.5962
2025-04-28 05:20:47 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:20:47 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.9857
2025-04-28 05:20:48 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:20:48 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.4281
2025-04-28 05:20:48 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:20:48 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.6207
2025-04-28 05:20:48 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:20:48 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.5496
2025-04-28 05:20:48 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:20:48 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.4950
2025-04-28 05:20:48 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:20:48 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.8126
2025-04-28 05:20:49 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:20:49 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.4043
2025-04-28 05:20:49 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:20:49 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.6977
2025-04-28 05:20:49 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:20:49 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.5478
2025-04-28 05:20:49 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:20:49 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.4640
2025-04-28 05:20:49 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:20:49 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.8971
2025-04-28 05:20:50 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:20:50 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.0043
2025-04-28 05:20:50 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:20:50 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.5193
2025-04-28 05:20:50 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:20:50 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.3704
2025-04-28 05:20:50 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:20:50 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.1683
2025-04-28 05:20:50 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:20:50 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.8572
2025-04-28 05:20:51 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:20:51 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.0414
2025-04-28 05:20:51 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:20:51 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.3730
2025-04-28 05:20:51 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:20:51 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.2905
2025-04-28 05:20:51 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:20:51 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.1398
2025-04-28 05:20:51 [DEBUG] üîç [DEBUG] Adapter.validation_step: Called.
2025-04-28 05:20:51 [DEBUG] üîç [DEBUG] Adapter.validation_step: Loss calculated: 1.5834
2025-04-28 05:20:51 [INFO] ‚ÑπÔ∏è Finished training for SimpleCNN.
2025-04-28 05:20:51 [INFO] ‚ÑπÔ∏è Training finished. Best validation performance at Epoch 5 (valid_loss=1.2431)
2025-04-28 05:20:51 [INFO] ‚ÑπÔ∏è Model state_dict saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\cnn_epoch5_val_valid-loss1.2431_20250428_052051.pt
2025-04-28 05:20:51 [INFO] ‚ÑπÔ∏è Detailed results saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\single_train_batch_size=16_early_stopping_patience=5_lr=0.001_max_epochs=5_20250428_052051.json
2025-04-28 05:20:51 [INFO] ‚ÑπÔ∏è Summary results updated in: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\summary_results.csv
2025-04-28 05:20:51 [INFO] ‚ÑπÔ∏è --- Method single_train completed successfully ---
2025-04-28 05:20:51 [INFO] ‚ÑπÔ∏è --- Running Method 2/2: single_eval ---
2025-04-28 05:20:51 [DEBUG] üîç Parameters for single_eval: {'save_results': True}
2025-04-28 05:20:51 [INFO] ‚ÑπÔ∏è Starting model evaluation on the test set...
2025-04-28 05:20:51 [INFO] ‚ÑπÔ∏è Evaluating on 87 test samples.
2025-04-28 05:20:51 [DEBUG] üîç Generating predictions on the test set...
2025-04-28 05:20:51 [DEBUG] üîç Generating probabilities on the test set...
2025-04-28 05:20:52 [DEBUG] üîç Predictions and probabilities generated.
2025-04-28 05:20:52 [DEBUG] üîç Extracting true labels from the test set...
2025-04-28 05:21:21 [DEBUG] üîç True labels extracted.
2025-04-28 05:21:21 [DEBUG] üîç Computing evaluation metrics...
2025-04-28 05:21:21 [DEBUG] üîç Computed Metrics: Acc=0.6092, Macro F1=0.5584, Macro ROC AUC=0.8779, Macro PR AUC=0.5941
2025-04-28 05:21:21 [INFO] ‚ÑπÔ∏è Evaluation metrics computed.
2025-04-28 05:21:21 [INFO] ‚ÑπÔ∏è Detailed results saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\single_eval_20250428_052121.json
2025-04-28 05:21:21 [INFO] ‚ÑπÔ∏è Summary results updated in: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\summary_results.csv
2025-04-28 05:21:21 [INFO] ‚ÑπÔ∏è Evaluation Summary:
2025-04-28 05:21:21 [INFO] ‚ÑπÔ∏è   Accuracy: 0.6092
2025-04-28 05:21:21 [INFO] ‚ÑπÔ∏è   Macro Precision: 0.6864
2025-04-28 05:21:21 [INFO] ‚ÑπÔ∏è   Macro Recall: 0.6126
2025-04-28 05:21:21 [INFO] ‚ÑπÔ∏è   Macro Specificity: 0.9349
2025-04-28 05:21:21 [INFO] ‚ÑπÔ∏è   Macro F1-Score: 0.5584
2025-04-28 05:21:21 [INFO] ‚ÑπÔ∏è   Macro ROC AUC: 0.8779
2025-04-28 05:21:21 [INFO] ‚ÑπÔ∏è   Macro PR AUC: 0.5941
2025-04-28 05:21:21 [INFO] ‚ÑπÔ∏è --- Method single_eval completed successfully ---
2025-04-28 05:21:21 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 05:21:21 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 05:21:21 [INFO] ‚ÑπÔ∏è Method single_train_0: Completed. (Accuracy/MeanAccuracy: nan, BestScore: nan)
2025-04-28 05:21:21 [INFO] ‚ÑπÔ∏è Method single_eval_1: Completed. (Accuracy/MeanAccuracy: 0.6092, BestScore: nan)
2025-04-28 05:23:10 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 05:23:10 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 05:23:10 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 05:23:10 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 05:23:10 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 05:23:10 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 05:23:10 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 05:23:10 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 05:23:10 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 05:23:10 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 05:23:10 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 05:23:10 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 05:23:10 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 05:23:10 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 05:23:10 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 05:23:10 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 05:23:10 [DEBUG] üîç Method validation successful.
2025-04-28 05:23:10 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 05:23:10 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 05:23:10 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 05:23:10 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 05:23:10 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 05:23:10 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 05:23:10 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 05:23:10 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 05:23:10 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 05:23:11 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:23:11 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:23:11 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:23:12 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:23:12 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:23:12 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:23:13 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:23:13 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:23:13 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:23:13 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:23:13 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:23:13 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:23:14 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:23:14 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:23:14 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:23:15 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:23:15 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:23:15 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:23:16 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:23:16 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:23:16 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:23:16 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:23:16 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:23:16 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:23:17 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:23:17 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:23:17 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:23:18 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:23:18 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:23:18 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:23:19 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:23:19 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:23:19 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:23:20 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:23:20 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:23:20 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:23:20 [ERROR] ‚ùó !!! Method 'non_nested_grid_search' failed at step 1: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1010, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1090, in get_split_datasets
    dataset_train = self.get_dataset(X, y)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2444, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1565, in non_nested_grid_search
    search.fit(train_dataset, y=y_train)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1024, in fit
    self._run_search(evaluate_candidates)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1571, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1001, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 517, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1010, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1090, in get_split_datasets
    dataset_train = self.get_dataset(X, y)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

2025-04-28 05:23:20 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 05:23:20 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 05:23:20 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 05:23:20 [ERROR] ‚ùó Method non_nested_grid_search_0: FAILED - 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1010, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1090, in get_split_datasets
    dataset_train = self.get_dataset(X, y)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

2025-04-28 05:31:51 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 05:31:51 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 05:31:51 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 05:31:51 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 05:31:51 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 05:31:51 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 05:31:51 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 05:31:51 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 05:31:51 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 05:31:51 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 05:31:51 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 05:31:51 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 05:31:51 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 05:31:51 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 05:31:51 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 05:31:51 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 05:31:51 [DEBUG] üîç Method validation successful.
2025-04-28 05:31:51 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 05:31:51 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 05:31:51 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 05:31:51 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 05:31:51 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 05:31:51 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 05:31:51 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 05:31:51 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 05:31:51 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 05:31:52 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:31:52 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:31:52 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:31:53 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:31:53 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:31:53 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:31:54 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:31:54 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:31:54 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:31:54 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:31:54 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:31:54 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:31:55 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:31:55 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:31:55 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:31:56 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:31:56 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:31:56 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:31:57 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:31:57 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:31:57 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:31:57 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:31:57 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:31:57 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:31:58 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:31:58 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:31:58 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:31:59 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:31:59 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:31:59 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:32:00 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:32:00 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:32:00 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:32:00 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:32:01 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:32:01 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:32:01 [ERROR] ‚ùó !!! Method 'non_nested_grid_search' failed at step 1: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1013, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1093, in get_split_datasets
    dataset_train = self.get_dataset(X, y)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2449, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1570, in non_nested_grid_search
    search.fit(train_dataset, y=y_train)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1024, in fit
    self._run_search(evaluate_candidates)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1571, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1001, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 517, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1013, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1093, in get_split_datasets
    dataset_train = self.get_dataset(X, y)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

2025-04-28 05:32:01 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 05:32:01 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 05:32:01 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 05:32:01 [ERROR] ‚ùó Method non_nested_grid_search_0: FAILED - 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1013, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1093, in get_split_datasets
    dataset_train = self.get_dataset(X, y)
                    ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

2025-04-28 05:33:32 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 05:33:32 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 05:33:32 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 05:33:32 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 05:33:32 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 05:33:32 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 05:33:32 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 05:33:32 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 05:33:32 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 05:33:32 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 05:33:32 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 05:33:32 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 05:33:32 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 05:33:32 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 05:33:32 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 05:33:32 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 05:33:32 [DEBUG] üîç Method validation successful.
2025-04-28 05:33:32 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 05:33:32 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 05:33:32 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 05:33:32 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 05:33:32 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 05:33:32 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 05:33:32 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 05:33:32 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 05:33:32 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 05:33:33 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:33:33 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:33:33 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:39:26 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:39:26 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:39:26 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:39:27 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:39:27 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:39:27 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:39:28 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:39:28 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:39:28 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:39:28 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:39:28 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:39:28 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is not Dataset, passing y for training set.
2025-04-28 05:39:36 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 05:39:36 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 05:39:36 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 05:39:36 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 05:39:36 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 05:39:36 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 05:39:36 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 05:39:36 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 05:39:36 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 05:39:36 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 05:39:36 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 05:39:36 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 05:39:36 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 05:39:36 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 05:39:36 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 05:39:36 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 05:39:36 [DEBUG] üîç Method validation successful.
2025-04-28 05:39:36 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 05:39:36 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 05:39:36 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 05:39:36 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 05:39:36 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 05:39:36 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 05:39:36 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 05:39:36 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 05:39:36 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 05:39:37 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:39:37 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:39:37 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:39:37 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:39:38 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:39:38 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:39:38 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:39:38 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:39:39 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:39:39 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:39:39 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:39:39 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:39:39 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:39:39 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:39:39 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:39:39 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:39:40 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:39:40 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:39:40 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:39:40 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:39:41 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:39:41 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:39:41 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:39:41 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:39:42 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:39:42 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:39:42 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:39:42 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:39:42 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:39:42 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:39:42 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:39:42 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:39:43 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:39:43 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:39:43 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:39:43 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:39:44 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:39:44 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:39:44 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:39:44 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:39:45 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:39:45 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:39:45 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:39:45 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:39:45 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:39:45 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:39:45 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:39:45 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:39:45 [ERROR] ‚ùó !!! Method 'non_nested_grid_search' failed at step 1: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1013, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1220, in fit_loop
    self.run_single_epoch(iterator_train, training=True, prefix="train",
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1256, in run_single_epoch
    step = step_fn(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1135, in train_step
    self._step_optimizer(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1090, in _step_optimizer
    optimizer.step(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 487, in wrapper
    out = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 91, in _use_grad
    ret = func(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\adamw.py", line 197, in step
    loss = closure()
           ^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1124, in step_fn
    step = self.train_step_single(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1023, in train_step_single
    y_pred = self.infer(Xi, **fit_params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1025, in infer
    raise TypeError(f"SkorchModelAdapter.infer received input of type {type(x)}, expected torch.Tensor.")
TypeError: SkorchModelAdapter.infer received input of type <class 'list'>, expected torch.Tensor.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2455, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1576, in non_nested_grid_search
    search.fit(train_dataset, y=y_train)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1024, in fit
    self._run_search(evaluate_candidates)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1571, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1001, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 517, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1013, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1220, in fit_loop
    self.run_single_epoch(iterator_train, training=True, prefix="train",
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1256, in run_single_epoch
    step = step_fn(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1135, in train_step
    self._step_optimizer(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1090, in _step_optimizer
    optimizer.step(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 487, in wrapper
    out = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 91, in _use_grad
    ret = func(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\adamw.py", line 197, in step
    loss = closure()
           ^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1124, in step_fn
    step = self.train_step_single(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1023, in train_step_single
    y_pred = self.infer(Xi, **fit_params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1025, in infer
    raise TypeError(f"SkorchModelAdapter.infer received input of type {type(x)}, expected torch.Tensor.")
TypeError: SkorchModelAdapter.infer received input of type <class 'list'>, expected torch.Tensor.

2025-04-28 05:39:45 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 05:39:45 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 05:39:45 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 05:39:45 [ERROR] ‚ùó Method non_nested_grid_search_0: FAILED - 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1013, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1220, in fit_loop
    self.run_single_epoch(iterator_train, training=True, prefix="train",
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1256, in run_single_epoch
    step = step_fn(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1135, in train_step
    self._step_optimizer(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1090, in _step_optimizer
    optimizer.step(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 487, in wrapper
    out = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 91, in _use_grad
    ret = func(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\adamw.py", line 197, in step
    loss = closure()
           ^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1124, in step_fn
    step = self.train_step_single(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1023, in train_step_single
    y_pred = self.infer(Xi, **fit_params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1025, in infer
    raise TypeError(f"SkorchModelAdapter.infer received input of type {type(x)}, expected torch.Tensor.")
TypeError: SkorchModelAdapter.infer received input of type <class 'list'>, expected torch.Tensor.

2025-04-28 05:40:10 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 05:40:10 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 05:40:10 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 05:40:10 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 05:40:10 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 05:40:10 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 05:40:10 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 05:40:10 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 05:40:10 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 05:40:10 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 05:40:10 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 05:40:10 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 05:40:10 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 05:40:10 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 05:40:10 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 05:40:10 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 05:40:10 [DEBUG] üîç Method validation successful.
2025-04-28 05:40:10 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 05:40:10 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 05:40:10 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 05:40:10 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 05:40:10 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 05:40:10 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 05:40:10 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 05:40:10 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 05:40:10 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 05:40:11 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:40:11 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:40:11 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:40:11 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:40:12 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:40:12 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:40:12 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:40:12 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:40:13 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:40:13 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:40:13 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:40:13 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:40:14 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:40:14 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:40:14 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:40:14 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:40:15 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:40:15 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:40:15 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:40:15 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:40:16 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:40:16 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:40:16 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:40:16 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:40:17 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:40:17 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:40:17 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:40:17 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:40:18 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:40:18 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:40:18 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:40:18 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:40:19 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:40:19 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:40:19 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:40:19 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:40:20 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:40:20 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:40:20 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:40:20 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:40:21 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:40:21 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:40:21 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:40:21 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:40:22 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:40:22 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:40:22 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:40:22 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:40:22 [ERROR] ‚ùó !!! Method 'non_nested_grid_search' failed at step 1: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1013, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1220, in fit_loop
    self.run_single_epoch(iterator_train, training=True, prefix="train",
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1256, in run_single_epoch
    step = step_fn(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1135, in train_step
    self._step_optimizer(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1090, in _step_optimizer
    optimizer.step(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 487, in wrapper
    out = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 91, in _use_grad
    ret = func(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\adamw.py", line 197, in step
    loss = closure()
           ^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1124, in step_fn
    step = self.train_step_single(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1023, in train_step_single
    y_pred = self.infer(Xi, **fit_params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1025, in infer
    raise TypeError(f"SkorchModelAdapter.infer received input of type {type(x)}, expected torch.Tensor.")
TypeError: SkorchModelAdapter.infer received input of type <class 'list'>, expected torch.Tensor.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2455, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1576, in non_nested_grid_search
    search.fit(train_dataset, y=y_train)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1024, in fit
    self._run_search(evaluate_candidates)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1571, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1001, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 517, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1013, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1220, in fit_loop
    self.run_single_epoch(iterator_train, training=True, prefix="train",
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1256, in run_single_epoch
    step = step_fn(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1135, in train_step
    self._step_optimizer(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1090, in _step_optimizer
    optimizer.step(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 487, in wrapper
    out = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 91, in _use_grad
    ret = func(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\adamw.py", line 197, in step
    loss = closure()
           ^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1124, in step_fn
    step = self.train_step_single(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1023, in train_step_single
    y_pred = self.infer(Xi, **fit_params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1025, in infer
    raise TypeError(f"SkorchModelAdapter.infer received input of type {type(x)}, expected torch.Tensor.")
TypeError: SkorchModelAdapter.infer received input of type <class 'list'>, expected torch.Tensor.

2025-04-28 05:40:22 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 05:40:22 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 05:40:22 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 05:40:22 [ERROR] ‚ùó Method non_nested_grid_search_0: FAILED - 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1013, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1220, in fit_loop
    self.run_single_epoch(iterator_train, training=True, prefix="train",
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1256, in run_single_epoch
    step = step_fn(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1135, in train_step
    self._step_optimizer(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1090, in _step_optimizer
    optimizer.step(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 487, in wrapper
    out = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 91, in _use_grad
    ret = func(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\adamw.py", line 197, in step
    loss = closure()
           ^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1124, in step_fn
    step = self.train_step_single(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1023, in train_step_single
    y_pred = self.infer(Xi, **fit_params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1025, in infer
    raise TypeError(f"SkorchModelAdapter.infer received input of type {type(x)}, expected torch.Tensor.")
TypeError: SkorchModelAdapter.infer received input of type <class 'list'>, expected torch.Tensor.

2025-04-28 05:41:25 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 05:41:25 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 05:41:25 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 05:41:25 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 05:41:25 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 05:41:25 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 05:41:25 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 05:41:25 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 05:41:25 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 05:41:25 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 05:41:25 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 05:41:25 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 05:41:25 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 05:41:25 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 05:41:25 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 05:41:25 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 05:41:25 [DEBUG] üîç Method validation successful.
2025-04-28 05:41:25 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 05:41:25 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 05:41:25 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 05:41:25 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 05:41:25 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 05:41:25 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 05:41:25 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 05:41:25 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 05:41:25 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 05:41:26 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:41:26 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:41:33 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:43:12 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:43:13 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:43:13 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:43:17 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:43:17 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:43:18 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:43:18 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:43:18 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:43:18 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:43:19 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:43:19 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:43:19 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:43:19 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:43:20 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:43:20 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:43:20 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:43:20 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:43:21 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:43:21 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:43:21 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:43:21 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:43:22 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:43:22 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:43:22 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:43:22 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:43:23 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:43:23 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:43:23 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:43:23 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:43:24 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:43:24 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:43:24 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:43:24 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:43:25 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:43:25 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:43:25 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:43:25 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:43:26 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:43:26 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:43:26 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:43:26 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:43:27 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:43:27 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:43:27 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples, using get_dataset(X, y=None).
2025-04-28 05:43:27 [ERROR] ‚ùó [ERROR] Infer received non-Tensor input: <class 'list'>. Upstream issue likely.
2025-04-28 05:43:27 [ERROR] ‚ùó !!! Method 'non_nested_grid_search' failed at step 1: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1013, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1220, in fit_loop
    self.run_single_epoch(iterator_train, training=True, prefix="train",
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1256, in run_single_epoch
    step = step_fn(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1135, in train_step
    self._step_optimizer(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1090, in _step_optimizer
    optimizer.step(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 487, in wrapper
    out = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 91, in _use_grad
    ret = func(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\adamw.py", line 197, in step
    loss = closure()
           ^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1124, in step_fn
    step = self.train_step_single(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1023, in train_step_single
    y_pred = self.infer(Xi, **fit_params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1025, in infer
    raise TypeError(f"SkorchModelAdapter.infer received input of type {type(x)}, expected torch.Tensor.")
TypeError: SkorchModelAdapter.infer received input of type <class 'list'>, expected torch.Tensor.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2455, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1576, in non_nested_grid_search
    search.fit(train_dataset, y=y_train)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1024, in fit
    self._run_search(evaluate_candidates)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1571, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1001, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 517, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1013, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1220, in fit_loop
    self.run_single_epoch(iterator_train, training=True, prefix="train",
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1256, in run_single_epoch
    step = step_fn(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1135, in train_step
    self._step_optimizer(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1090, in _step_optimizer
    optimizer.step(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 487, in wrapper
    out = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 91, in _use_grad
    ret = func(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\adamw.py", line 197, in step
    loss = closure()
           ^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1124, in step_fn
    step = self.train_step_single(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1023, in train_step_single
    y_pred = self.infer(Xi, **fit_params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1025, in infer
    raise TypeError(f"SkorchModelAdapter.infer received input of type {type(x)}, expected torch.Tensor.")
TypeError: SkorchModelAdapter.infer received input of type <class 'list'>, expected torch.Tensor.

2025-04-28 05:43:27 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 05:43:27 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 05:43:27 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 05:43:27 [ERROR] ‚ùó Method non_nested_grid_search_0: FAILED - 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1013, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1220, in fit_loop
    self.run_single_epoch(iterator_train, training=True, prefix="train",
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1256, in run_single_epoch
    step = step_fn(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1135, in train_step
    self._step_optimizer(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1090, in _step_optimizer
    optimizer.step(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 487, in wrapper
    out = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 91, in _use_grad
    ret = func(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\adamw.py", line 197, in step
    loss = closure()
           ^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1124, in step_fn
    step = self.train_step_single(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1023, in train_step_single
    y_pred = self.infer(Xi, **fit_params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1025, in infer
    raise TypeError(f"SkorchModelAdapter.infer received input of type {type(x)}, expected torch.Tensor.")
TypeError: SkorchModelAdapter.infer received input of type <class 'list'>, expected torch.Tensor.

2025-04-28 05:49:41 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 05:49:41 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 05:49:41 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 05:49:41 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 05:49:41 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 05:49:41 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 05:49:41 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 05:49:41 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 05:49:41 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 05:49:41 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 05:49:41 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 05:49:41 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 05:49:41 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 05:49:41 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 05:49:41 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 05:49:41 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 05:49:41 [DEBUG] üîç Method validation successful.
2025-04-28 05:49:41 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 05:49:41 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 05:49:41 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 05:49:41 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 05:49:41 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 05:49:41 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 05:49:41 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 05:49:41 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 05:49:41 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 05:49:42 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:49:42 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:49:42 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples. Manual unpacking.
2025-04-28 05:49:42 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset creation from list: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1096, in get_split_datasets
    dataset_train = self.get_dataset(X_features, y_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 05:49:43 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:49:43 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:49:43 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples. Manual unpacking.
2025-04-28 05:49:43 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset creation from list: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1096, in get_split_datasets
    dataset_train = self.get_dataset(X_features, y_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 05:49:44 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:49:44 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:49:44 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples. Manual unpacking.
2025-04-28 05:49:44 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset creation from list: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1096, in get_split_datasets
    dataset_train = self.get_dataset(X_features, y_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 05:49:45 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:49:45 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:49:45 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples. Manual unpacking.
2025-04-28 05:49:45 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset creation from list: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1096, in get_split_datasets
    dataset_train = self.get_dataset(X_features, y_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 05:49:45 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:49:45 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:49:45 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples. Manual unpacking.
2025-04-28 05:49:45 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset creation from list: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1096, in get_split_datasets
    dataset_train = self.get_dataset(X_features, y_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 05:49:47 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:49:47 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:49:47 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples. Manual unpacking.
2025-04-28 05:49:47 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset creation from list: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1096, in get_split_datasets
    dataset_train = self.get_dataset(X_features, y_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 05:49:49 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:49:49 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:49:49 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples. Manual unpacking.
2025-04-28 05:49:49 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset creation from list: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1096, in get_split_datasets
    dataset_train = self.get_dataset(X_features, y_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 05:49:49 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:49:50 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:49:50 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples. Manual unpacking.
2025-04-28 05:49:50 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset creation from list: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1096, in get_split_datasets
    dataset_train = self.get_dataset(X_features, y_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 05:49:50 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:49:50 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:49:50 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples. Manual unpacking.
2025-04-28 05:49:50 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset creation from list: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1096, in get_split_datasets
    dataset_train = self.get_dataset(X_features, y_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 05:49:51 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:49:51 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:49:51 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples. Manual unpacking.
2025-04-28 05:49:51 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset creation from list: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1096, in get_split_datasets
    dataset_train = self.get_dataset(X_features, y_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 05:49:52 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:49:52 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:49:52 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples. Manual unpacking.
2025-04-28 05:49:52 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset creation from list: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1096, in get_split_datasets
    dataset_train = self.get_dataset(X_features, y_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 05:49:53 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:49:53 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:49:53 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples. Manual unpacking.
2025-04-28 05:49:53 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset creation from list: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1096, in get_split_datasets
    dataset_train = self.get_dataset(X_features, y_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 05:49:53 [ERROR] ‚ùó !!! Method 'non_nested_grid_search' failed at step 1: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1096, in get_split_datasets
    dataset_train = self.get_dataset(X_features, y_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1013, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1100, in get_split_datasets
    raise RuntimeError("Failed to process list of tuples input during CV split.") from e
RuntimeError: Failed to process list of tuples input during CV split.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2465, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1586, in non_nested_grid_search
    search.fit(train_dataset, y=y_train)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1024, in fit
    self._run_search(evaluate_candidates)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1571, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1001, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 517, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1096, in get_split_datasets
    dataset_train = self.get_dataset(X_features, y_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1013, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1100, in get_split_datasets
    raise RuntimeError("Failed to process list of tuples input during CV split.") from e
RuntimeError: Failed to process list of tuples input during CV split.

2025-04-28 05:49:53 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 05:49:53 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 05:49:53 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 05:49:53 [ERROR] ‚ùó Method non_nested_grid_search_0: FAILED - 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1096, in get_split_datasets
    dataset_train = self.get_dataset(X_features, y_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1013, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1100, in get_split_datasets
    raise RuntimeError("Failed to process list of tuples input during CV split.") from e
RuntimeError: Failed to process list of tuples input during CV split.

2025-04-28 05:50:56 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 05:50:56 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 05:50:56 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 05:50:56 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 05:50:56 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 05:50:56 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 05:50:56 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 05:50:56 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 05:50:56 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 05:50:56 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 05:50:56 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 05:50:56 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 05:50:56 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 05:50:56 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 05:50:56 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 05:50:56 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 05:50:56 [DEBUG] üîç Method validation successful.
2025-04-28 05:50:56 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 05:50:56 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 05:50:56 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 05:50:56 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 05:50:56 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 05:50:56 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 05:50:56 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 05:50:56 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 05:50:56 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 05:50:57 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:50:57 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:50:57 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples. Manual unpacking.
2025-04-28 05:52:00 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset creation from list: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1096, in get_split_datasets
    dataset_train = self.get_dataset(X_features, y_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 05:52:01 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:52:01 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:52:01 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples. Manual unpacking.
2025-04-28 05:52:10 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:52:10 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:52:10 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples. Manual unpacking.
2025-04-28 05:52:10 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset creation from list: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1096, in get_split_datasets
    dataset_train = self.get_dataset(X_features, y_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 05:52:21 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 05:52:21 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 05:52:21 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 05:52:21 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 05:52:21 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 05:52:21 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 05:52:21 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 05:52:21 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 05:52:21 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 05:52:21 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 05:52:21 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 05:52:21 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 05:52:21 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 05:52:21 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 05:52:21 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 05:52:21 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 05:52:21 [DEBUG] üîç Method validation successful.
2025-04-28 05:52:21 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 05:52:21 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 05:52:21 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 05:52:21 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 05:52:21 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 05:52:21 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 05:52:21 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 05:52:21 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 05:52:21 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 05:52:22 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:52:22 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:52:22 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples. Manual unpacking.
2025-04-28 05:55:03 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:55:03 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:55:03 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples. Manual unpacking.
2025-04-28 05:55:03 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset creation from list: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1096, in get_split_datasets
    dataset_train = self.get_dataset(X_features, y_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 05:55:04 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:55:04 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:55:04 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples. Manual unpacking.
2025-04-28 05:55:04 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset creation from list: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1096, in get_split_datasets
    dataset_train = self.get_dataset(X_features, y_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 05:55:06 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:55:06 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:55:06 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples. Manual unpacking.
2025-04-28 05:55:06 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset creation from list: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1096, in get_split_datasets
    dataset_train = self.get_dataset(X_features, y_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 05:55:07 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:55:07 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:55:07 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples. Manual unpacking.
2025-04-28 05:55:07 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset creation from list: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1096, in get_split_datasets
    dataset_train = self.get_dataset(X_features, y_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 05:55:08 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:55:08 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:55:08 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples. Manual unpacking.
2025-04-28 05:55:08 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset creation from list: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1096, in get_split_datasets
    dataset_train = self.get_dataset(X_features, y_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 05:55:09 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:55:09 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:55:09 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples. Manual unpacking.
2025-04-28 05:55:09 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset creation from list: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1096, in get_split_datasets
    dataset_train = self.get_dataset(X_features, y_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 05:55:10 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:55:10 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:55:10 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples. Manual unpacking.
2025-04-28 05:55:10 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset creation from list: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1096, in get_split_datasets
    dataset_train = self.get_dataset(X_features, y_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 05:55:10 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:55:10 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:55:11 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples. Manual unpacking.
2025-04-28 05:55:11 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset creation from list: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1096, in get_split_datasets
    dataset_train = self.get_dataset(X_features, y_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 05:55:11 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:55:11 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:55:11 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples. Manual unpacking.
2025-04-28 05:55:11 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset creation from list: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1096, in get_split_datasets
    dataset_train = self.get_dataset(X_features, y_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 05:55:12 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:55:12 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:55:12 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples. Manual unpacking.
2025-04-28 05:55:12 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset creation from list: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1096, in get_split_datasets
    dataset_train = self.get_dataset(X_features, y_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 05:55:13 [INFO] ‚ÑπÔ∏è Starting training for SimpleCNN...
2025-04-28 05:55:13 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:55:13 [DEBUG] üîç [DEBUG] Adapter.get_split_datasets: X is list of tuples. Manual unpacking.
2025-04-28 05:55:13 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset creation from list: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1096, in get_split_datasets
    dataset_train = self.get_dataset(X_features, y_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 05:55:13 [ERROR] ‚ùó !!! Method 'non_nested_grid_search' failed at step 1: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1013, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1311, in partial_fit
    self.notify('on_train_end', X=X, y=y)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 447, in on_train_end
    self.load_best and (self.best_epoch_ != net.history[-1, "epoch"])
                                            ~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 267, in __getitem__
    items = items[i_e]
            ~~~~~^^^^^
IndexError: list index out of range

--------------------------------------------------------------------------------
11 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1096, in get_split_datasets
    dataset_train = self.get_dataset(X_features, y_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1013, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1100, in get_split_datasets
    raise RuntimeError("Failed to process list of tuples input during CV split.") from e
RuntimeError: Failed to process list of tuples input during CV split.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2465, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1586, in non_nested_grid_search
    search.fit(train_dataset, y=y_train)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1024, in fit
    self._run_search(evaluate_candidates)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1571, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1001, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 517, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1013, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1311, in partial_fit
    self.notify('on_train_end', X=X, y=y)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 447, in on_train_end
    self.load_best and (self.best_epoch_ != net.history[-1, "epoch"])
                                            ~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 267, in __getitem__
    items = items[i_e]
            ~~~~~^^^^^
IndexError: list index out of range

--------------------------------------------------------------------------------
11 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1096, in get_split_datasets
    dataset_train = self.get_dataset(X_features, y_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1013, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1100, in get_split_datasets
    raise RuntimeError("Failed to process list of tuples input during CV split.") from e
RuntimeError: Failed to process list of tuples input during CV split.

2025-04-28 05:55:13 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 05:55:13 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 05:55:13 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 05:55:13 [ERROR] ‚ùó Method non_nested_grid_search_0: FAILED - 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1013, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1311, in partial_fit
    self.notify('on_train_end', X=X, y=y)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 447, in on_train_end
    self.load_best and (self.best_epoch_ != net.history[-1, "epoch"])
                                            ~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 267, in __getitem__
    items = items[i_e]
            ~~~~~^^^^^
IndexError: list index out of range

--------------------------------------------------------------------------------
11 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1096, in get_split_datasets
    dataset_train = self.get_dataset(X_features, y_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1013, in fit
    super().fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1100, in get_split_datasets
    raise RuntimeError("Failed to process list of tuples input during CV split.") from e
RuntimeError: Failed to process list of tuples input during CV split.

2025-04-28 05:55:23 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 05:55:23 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 05:55:23 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 05:55:23 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 05:55:23 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 05:55:23 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 05:55:23 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 05:55:23 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 05:55:23 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 05:55:23 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 05:55:23 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 05:55:23 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 05:55:23 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 05:55:23 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 05:55:23 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 05:55:23 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 05:55:23 [DEBUG] üîç Method validation successful.
2025-04-28 05:55:23 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 05:55:23 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 05:55:23 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 05:55:23 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 05:55:23 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 05:55:23 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 05:55:23 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 05:55:23 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 05:55:23 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 05:55:24 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:55:25 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:55:26 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:55:26 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:55:27 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:55:28 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:55:29 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:55:30 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:55:30 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:55:31 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:55:32 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:55:33 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:55:33 [ERROR] ‚ùó !!! Method 'non_nested_grid_search' failed at step 1: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1791, in get_split_datasets
    dataset = self.get_dataset(X, y)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2465, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1586, in non_nested_grid_search
    search.fit(train_dataset, y=y_train)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1024, in fit
    self._run_search(evaluate_candidates)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1571, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1001, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 517, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1791, in get_split_datasets
    dataset = self.get_dataset(X, y)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

2025-04-28 05:55:33 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 05:55:33 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 05:55:33 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 05:55:33 [ERROR] ‚ùó Method non_nested_grid_search_0: FAILED - 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1791, in get_split_datasets
    dataset = self.get_dataset(X, y)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

2025-04-28 05:55:57 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 05:55:57 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 05:55:57 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 05:55:57 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 05:55:57 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 05:55:57 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 05:55:57 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 05:55:57 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 05:55:57 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 05:55:57 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 05:55:57 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 05:55:57 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 05:55:57 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 05:55:57 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 05:55:57 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 05:55:57 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 05:55:57 [DEBUG] üîç Method validation successful.
2025-04-28 05:55:57 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 05:55:57 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 05:55:57 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 05:55:57 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 05:55:57 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 05:55:57 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 05:55:57 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 05:55:57 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 05:55:57 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 05:55:58 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:55:59 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:56:00 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:56:01 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:56:03 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:56:03 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:56:04 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:56:05 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:56:06 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:56:07 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:56:07 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:56:08 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:56:08 [ERROR] ‚ùó !!! Method 'non_nested_grid_search' failed at step 1: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1791, in get_split_datasets
    dataset = self.get_dataset(X, y)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2465, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1586, in non_nested_grid_search
    search.fit(train_dataset, y=y_train)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1024, in fit
    self._run_search(evaluate_candidates)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1571, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1001, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 517, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1791, in get_split_datasets
    dataset = self.get_dataset(X, y)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

2025-04-28 05:56:08 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 05:56:08 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 05:56:08 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 05:56:08 [ERROR] ‚ùó Method non_nested_grid_search_0: FAILED - 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1791, in get_split_datasets
    dataset = self.get_dataset(X, y)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

2025-04-28 05:59:14 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 05:59:14 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 05:59:14 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 05:59:14 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 05:59:14 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 05:59:14 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 05:59:14 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 05:59:14 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 05:59:14 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 05:59:14 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 05:59:14 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 05:59:14 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 05:59:14 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 05:59:14 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 05:59:14 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 05:59:14 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 05:59:14 [DEBUG] üîç Method validation successful.
2025-04-28 05:59:14 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 05:59:14 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 05:59:14 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 05:59:14 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 05:59:14 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 05:59:14 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 05:59:14 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 05:59:14 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 05:59:14 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 05:59:14 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:59:14 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 05:59:15 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:59:15 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 05:59:16 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:59:16 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 05:59:17 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:59:17 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 05:59:18 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:59:18 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 05:59:18 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:59:18 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 05:59:19 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:59:19 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 05:59:20 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:59:20 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 05:59:21 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:59:21 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 05:59:21 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:59:21 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 05:59:22 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:59:22 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 05:59:23 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 05:59:23 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 05:59:23 [ERROR] ‚ùó !!! Method 'non_nested_grid_search' failed at step 1: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1791, in get_split_datasets
    dataset = self.get_dataset(X, y)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1014, in get_dataset
    return super().get_dataset(X, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2487, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1608, in non_nested_grid_search
    search.fit(train_dataset, y=y_train)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1024, in fit
    self._run_search(evaluate_candidates)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1571, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1001, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 517, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1791, in get_split_datasets
    dataset = self.get_dataset(X, y)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1014, in get_dataset
    return super().get_dataset(X, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

2025-04-28 05:59:23 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 05:59:23 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 05:59:23 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 05:59:23 [ERROR] ‚ùó Method non_nested_grid_search_0: FAILED - 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1791, in get_split_datasets
    dataset = self.get_dataset(X, y)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1014, in get_dataset
    return super().get_dataset(X, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

2025-04-28 05:59:54 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 05:59:54 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 05:59:54 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 05:59:54 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 05:59:54 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 05:59:54 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 05:59:54 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 05:59:54 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 05:59:54 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 05:59:54 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 05:59:54 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 05:59:54 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 05:59:54 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 05:59:54 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 05:59:54 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 05:59:54 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 05:59:54 [DEBUG] üîç Method validation successful.
2025-04-28 05:59:54 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 05:59:54 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 05:59:54 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 05:59:54 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 05:59:54 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 05:59:54 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 05:59:54 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 05:59:54 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 05:59:54 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 05:59:55 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:02:12 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 06:03:51 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:03:51 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 06:03:52 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:03:52 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 06:03:53 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:03:53 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 06:03:54 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:03:54 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 06:03:54 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:03:54 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 06:03:55 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:03:55 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 06:03:56 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:03:56 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 06:03:57 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:03:57 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 06:03:57 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:03:57 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 06:03:58 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:03:58 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 06:03:59 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:03:59 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 06:03:59 [ERROR] ‚ùó !!! Method 'non_nested_grid_search' failed at step 1: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1311, in partial_fit
    self.notify('on_train_end', X=X, y=y)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 447, in on_train_end
    self.load_best and (self.best_epoch_ != net.history[-1, "epoch"])
                                            ~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 267, in __getitem__
    items = items[i_e]
            ~~~~~^^^^^
IndexError: list index out of range

--------------------------------------------------------------------------------
11 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1791, in get_split_datasets
    dataset = self.get_dataset(X, y)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1014, in get_dataset
    return super().get_dataset(X, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2487, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1608, in non_nested_grid_search
    search.fit(train_dataset, y=y_train)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1024, in fit
    self._run_search(evaluate_candidates)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1571, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1001, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 517, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1311, in partial_fit
    self.notify('on_train_end', X=X, y=y)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 447, in on_train_end
    self.load_best and (self.best_epoch_ != net.history[-1, "epoch"])
                                            ~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 267, in __getitem__
    items = items[i_e]
            ~~~~~^^^^^
IndexError: list index out of range

--------------------------------------------------------------------------------
11 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1791, in get_split_datasets
    dataset = self.get_dataset(X, y)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1014, in get_dataset
    return super().get_dataset(X, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

2025-04-28 06:03:59 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 06:03:59 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 06:03:59 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 06:03:59 [ERROR] ‚ùó Method non_nested_grid_search_0: FAILED - 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1311, in partial_fit
    self.notify('on_train_end', X=X, y=y)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 447, in on_train_end
    self.load_best and (self.best_epoch_ != net.history[-1, "epoch"])
                                            ~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 267, in __getitem__
    items = items[i_e]
            ~~~~~^^^^^
IndexError: list index out of range

--------------------------------------------------------------------------------
11 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1791, in get_split_datasets
    dataset = self.get_dataset(X, y)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1014, in get_dataset
    return super().get_dataset(X, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

2025-04-28 06:04:13 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 06:04:13 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 06:04:13 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 06:04:13 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 06:04:13 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 06:04:13 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 06:04:13 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 06:04:13 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 06:04:13 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 06:04:13 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 06:04:13 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 06:04:13 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 06:04:13 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 06:04:13 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 06:04:13 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 06:04:13 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 06:04:13 [DEBUG] üîç Method validation successful.
2025-04-28 06:04:13 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 06:04:13 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 06:04:13 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 06:04:13 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 06:04:13 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 06:04:13 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 06:04:13 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 06:04:13 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 06:04:13 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 06:04:14 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:04:17 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 06:09:28 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:09:28 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 06:09:29 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:09:29 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 06:09:29 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:09:29 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 06:09:30 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:09:30 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 06:09:31 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:09:31 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 06:09:32 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:09:32 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 06:09:32 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:09:32 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 06:09:33 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:09:33 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Using default behavior for X type <class 'list'> and y type <class 'numpy.ndarray'>.
2025-04-28 06:09:45 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 06:09:45 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 06:09:45 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 06:09:45 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 06:09:45 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 06:09:45 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 06:09:45 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 06:09:45 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 06:09:45 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 06:09:45 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 06:09:45 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 06:09:45 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 06:09:45 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 06:09:45 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 06:09:45 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 06:09:45 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 06:09:45 [DEBUG] üîç Method validation successful.
2025-04-28 06:09:45 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 06:09:45 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 06:09:45 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 06:09:45 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 06:09:45 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 06:09:45 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 06:09:45 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 06:09:45 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 06:09:45 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 06:09:46 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:09:53 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:10:26 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:10:26 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:10:26 [ERROR] ‚ùó Error during manual unpacking or super().get_dataset call: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1011, in get_dataset
    return super().get_dataset(X_unpack, y_unpack)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 06:10:26 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:10:26 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:10:26 [ERROR] ‚ùó Error during manual unpacking or super().get_dataset call: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1011, in get_dataset
    return super().get_dataset(X_unpack, y_unpack)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 06:10:27 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:10:27 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:10:27 [ERROR] ‚ùó Error during manual unpacking or super().get_dataset call: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1011, in get_dataset
    return super().get_dataset(X_unpack, y_unpack)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 06:10:28 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:10:28 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:10:28 [ERROR] ‚ùó Error during manual unpacking or super().get_dataset call: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1011, in get_dataset
    return super().get_dataset(X_unpack, y_unpack)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 06:10:29 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:10:29 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:10:29 [ERROR] ‚ùó Error during manual unpacking or super().get_dataset call: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1011, in get_dataset
    return super().get_dataset(X_unpack, y_unpack)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 06:10:29 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:10:29 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:10:29 [ERROR] ‚ùó Error during manual unpacking or super().get_dataset call: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1011, in get_dataset
    return super().get_dataset(X_unpack, y_unpack)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 06:10:30 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:10:30 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:10:30 [ERROR] ‚ùó Error during manual unpacking or super().get_dataset call: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1011, in get_dataset
    return super().get_dataset(X_unpack, y_unpack)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 06:10:31 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:10:31 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:10:31 [ERROR] ‚ùó Error during manual unpacking or super().get_dataset call: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1011, in get_dataset
    return super().get_dataset(X_unpack, y_unpack)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 06:10:32 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:10:32 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:10:32 [ERROR] ‚ùó Error during manual unpacking or super().get_dataset call: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1011, in get_dataset
    return super().get_dataset(X_unpack, y_unpack)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 06:10:32 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:10:32 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:10:32 [ERROR] ‚ùó Error during manual unpacking or super().get_dataset call: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1011, in get_dataset
    return super().get_dataset(X_unpack, y_unpack)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 06:10:33 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:10:33 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:10:33 [ERROR] ‚ùó Error during manual unpacking or super().get_dataset call: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1011, in get_dataset
    return super().get_dataset(X_unpack, y_unpack)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 06:10:33 [ERROR] ‚ùó !!! Method 'non_nested_grid_search' failed at step 1: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1311, in partial_fit
    self.notify('on_train_end', X=X, y=y)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 447, in on_train_end
    self.load_best and (self.best_epoch_ != net.history[-1, "epoch"])
                                            ~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 267, in __getitem__
    items = items[i_e]
            ~~~~~^^^^^
IndexError: list index out of range

--------------------------------------------------------------------------------
11 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1011, in get_dataset
    return super().get_dataset(X_unpack, y_unpack)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1791, in get_split_datasets
    dataset = self.get_dataset(X, y)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1014, in get_dataset
    raise RuntimeError("Failed to process list of tuples input during CV split.") from e
RuntimeError: Failed to process list of tuples input during CV split.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2491, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1612, in non_nested_grid_search
    search.fit(train_dataset, y=y_train)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1024, in fit
    self._run_search(evaluate_candidates)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1571, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1001, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 517, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1311, in partial_fit
    self.notify('on_train_end', X=X, y=y)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 447, in on_train_end
    self.load_best and (self.best_epoch_ != net.history[-1, "epoch"])
                                            ~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 267, in __getitem__
    items = items[i_e]
            ~~~~~^^^^^
IndexError: list index out of range

--------------------------------------------------------------------------------
11 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1011, in get_dataset
    return super().get_dataset(X_unpack, y_unpack)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1791, in get_split_datasets
    dataset = self.get_dataset(X, y)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1014, in get_dataset
    raise RuntimeError("Failed to process list of tuples input during CV split.") from e
RuntimeError: Failed to process list of tuples input during CV split.

2025-04-28 06:10:33 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 06:10:33 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 06:10:33 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 06:10:33 [ERROR] ‚ùó Method non_nested_grid_search_0: FAILED - 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
1 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1311, in partial_fit
    self.notify('on_train_end', X=X, y=y)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 447, in on_train_end
    self.load_best and (self.best_epoch_ != net.history[-1, "epoch"])
                                            ~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 267, in __getitem__
    items = items[i_e]
            ~~~~~^^^^^
IndexError: list index out of range

--------------------------------------------------------------------------------
11 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1011, in get_dataset
    return super().get_dataset(X_unpack, y_unpack)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1791, in get_split_datasets
    dataset = self.get_dataset(X, y)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1014, in get_dataset
    raise RuntimeError("Failed to process list of tuples input during CV split.") from e
RuntimeError: Failed to process list of tuples input during CV split.

2025-04-28 06:10:43 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 06:10:43 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 06:10:43 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 06:10:43 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 06:10:43 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 06:10:43 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 06:10:43 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 06:10:43 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 06:10:43 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 06:10:43 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 06:10:43 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 06:10:43 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 06:10:43 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 06:10:43 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 06:10:43 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 06:10:43 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 06:10:43 [DEBUG] üîç Method validation successful.
2025-04-28 06:10:43 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 06:10:43 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 06:10:43 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 06:10:43 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 06:10:43 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 06:10:43 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 06:10:43 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 06:10:43 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 06:10:43 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 06:10:44 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:11:30 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:16:07 [ERROR] ‚ùó Error during manual unpacking or super().get_dataset call: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1011, in get_dataset
    return super().get_dataset(X_unpack, y_unpack)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 06:16:08 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:20:44 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:20:44 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:20:44 [ERROR] ‚ùó Error during manual unpacking or super().get_dataset call: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1011, in get_dataset
    return super().get_dataset(X_unpack, y_unpack)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 06:20:45 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:20:45 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:20:45 [ERROR] ‚ùó Error during manual unpacking or super().get_dataset call: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1011, in get_dataset
    return super().get_dataset(X_unpack, y_unpack)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 06:20:46 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:20:46 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:20:46 [ERROR] ‚ùó Error during manual unpacking or super().get_dataset call: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1011, in get_dataset
    return super().get_dataset(X_unpack, y_unpack)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 06:20:47 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:20:47 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:20:47 [ERROR] ‚ùó Error during manual unpacking or super().get_dataset call: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1011, in get_dataset
    return super().get_dataset(X_unpack, y_unpack)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 06:20:48 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:20:48 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:20:48 [ERROR] ‚ùó Error during manual unpacking or super().get_dataset call: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1011, in get_dataset
    return super().get_dataset(X_unpack, y_unpack)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 06:20:56 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 06:20:56 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 06:20:56 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 06:20:56 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 06:20:56 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 06:20:56 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 06:20:56 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 06:20:56 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 06:20:56 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 06:20:56 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 06:20:56 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 06:20:56 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 06:20:56 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 06:20:56 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 06:20:56 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 06:20:56 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 06:20:56 [DEBUG] üîç Method validation successful.
2025-04-28 06:20:56 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 06:20:56 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 06:20:56 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 06:20:56 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 06:20:56 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 06:20:56 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 06:20:56 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 06:20:56 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 06:20:56 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 06:20:56 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:20:57 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:20:57 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Manually calculated length: 184
2025-04-28 06:20:57 [ERROR] ‚ùó Error during manual unpacking or super().get_dataset call: NeuralNet.get_dataset() got an unexpected keyword argument 'length'
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1016, in get_dataset
    return super().get_dataset(X_features, y_targets, length=correct_length)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: NeuralNet.get_dataset() got an unexpected keyword argument 'length'
2025-04-28 06:20:57 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:20:57 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:20:57 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Manually calculated length: 185
2025-04-28 06:20:57 [ERROR] ‚ùó Error during manual unpacking or super().get_dataset call: NeuralNet.get_dataset() got an unexpected keyword argument 'length'
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1016, in get_dataset
    return super().get_dataset(X_features, y_targets, length=correct_length)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: NeuralNet.get_dataset() got an unexpected keyword argument 'length'
2025-04-28 06:20:58 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:20:58 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:20:58 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Manually calculated length: 185
2025-04-28 06:20:58 [ERROR] ‚ùó Error during manual unpacking or super().get_dataset call: NeuralNet.get_dataset() got an unexpected keyword argument 'length'
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1016, in get_dataset
    return super().get_dataset(X_features, y_targets, length=correct_length)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: NeuralNet.get_dataset() got an unexpected keyword argument 'length'
2025-04-28 06:20:59 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:20:59 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:20:59 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Manually calculated length: 184
2025-04-28 06:20:59 [ERROR] ‚ùó Error during manual unpacking or super().get_dataset call: NeuralNet.get_dataset() got an unexpected keyword argument 'length'
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1016, in get_dataset
    return super().get_dataset(X_features, y_targets, length=correct_length)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: NeuralNet.get_dataset() got an unexpected keyword argument 'length'
2025-04-28 06:21:00 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:21:00 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:21:00 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Manually calculated length: 185
2025-04-28 06:21:00 [ERROR] ‚ùó Error during manual unpacking or super().get_dataset call: NeuralNet.get_dataset() got an unexpected keyword argument 'length'
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1016, in get_dataset
    return super().get_dataset(X_features, y_targets, length=correct_length)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: NeuralNet.get_dataset() got an unexpected keyword argument 'length'
2025-04-28 06:21:00 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:21:00 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:21:00 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Manually calculated length: 185
2025-04-28 06:21:00 [ERROR] ‚ùó Error during manual unpacking or super().get_dataset call: NeuralNet.get_dataset() got an unexpected keyword argument 'length'
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1016, in get_dataset
    return super().get_dataset(X_features, y_targets, length=correct_length)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: NeuralNet.get_dataset() got an unexpected keyword argument 'length'
2025-04-28 06:21:01 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:21:01 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:21:01 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Manually calculated length: 184
2025-04-28 06:21:01 [ERROR] ‚ùó Error during manual unpacking or super().get_dataset call: NeuralNet.get_dataset() got an unexpected keyword argument 'length'
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1016, in get_dataset
    return super().get_dataset(X_features, y_targets, length=correct_length)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: NeuralNet.get_dataset() got an unexpected keyword argument 'length'
2025-04-28 06:21:02 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:21:02 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:21:02 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Manually calculated length: 185
2025-04-28 06:21:02 [ERROR] ‚ùó Error during manual unpacking or super().get_dataset call: NeuralNet.get_dataset() got an unexpected keyword argument 'length'
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1016, in get_dataset
    return super().get_dataset(X_features, y_targets, length=correct_length)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: NeuralNet.get_dataset() got an unexpected keyword argument 'length'
2025-04-28 06:21:03 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:21:03 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:21:03 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Manually calculated length: 185
2025-04-28 06:21:03 [ERROR] ‚ùó Error during manual unpacking or super().get_dataset call: NeuralNet.get_dataset() got an unexpected keyword argument 'length'
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1016, in get_dataset
    return super().get_dataset(X_features, y_targets, length=correct_length)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: NeuralNet.get_dataset() got an unexpected keyword argument 'length'
2025-04-28 06:21:04 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:21:04 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:21:04 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Manually calculated length: 184
2025-04-28 06:21:04 [ERROR] ‚ùó Error during manual unpacking or super().get_dataset call: NeuralNet.get_dataset() got an unexpected keyword argument 'length'
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1016, in get_dataset
    return super().get_dataset(X_features, y_targets, length=correct_length)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: NeuralNet.get_dataset() got an unexpected keyword argument 'length'
2025-04-28 06:21:04 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:21:04 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:21:04 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Manually calculated length: 185
2025-04-28 06:21:04 [ERROR] ‚ùó Error during manual unpacking or super().get_dataset call: NeuralNet.get_dataset() got an unexpected keyword argument 'length'
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1016, in get_dataset
    return super().get_dataset(X_features, y_targets, length=correct_length)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: NeuralNet.get_dataset() got an unexpected keyword argument 'length'
2025-04-28 06:21:05 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:21:05 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:21:05 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Manually calculated length: 185
2025-04-28 06:21:05 [ERROR] ‚ùó Error during manual unpacking or super().get_dataset call: NeuralNet.get_dataset() got an unexpected keyword argument 'length'
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1016, in get_dataset
    return super().get_dataset(X_features, y_targets, length=correct_length)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: NeuralNet.get_dataset() got an unexpected keyword argument 'length'
2025-04-28 06:21:05 [ERROR] ‚ùó !!! Method 'non_nested_grid_search' failed at step 1: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1016, in get_dataset
    return super().get_dataset(X_features, y_targets, length=correct_length)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: NeuralNet.get_dataset() got an unexpected keyword argument 'length'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1791, in get_split_datasets
    dataset = self.get_dataset(X, y)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in get_dataset
    raise RuntimeError("Failed to process list of tuples input during CV split.") from e
RuntimeError: Failed to process list of tuples input during CV split.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2497, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1618, in non_nested_grid_search
    search.fit(train_dataset, y=y_train)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1024, in fit
    self._run_search(evaluate_candidates)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1571, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1001, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 517, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1016, in get_dataset
    return super().get_dataset(X_features, y_targets, length=correct_length)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: NeuralNet.get_dataset() got an unexpected keyword argument 'length'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1791, in get_split_datasets
    dataset = self.get_dataset(X, y)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in get_dataset
    raise RuntimeError("Failed to process list of tuples input during CV split.") from e
RuntimeError: Failed to process list of tuples input during CV split.

2025-04-28 06:21:05 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 06:21:05 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 06:21:05 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 06:21:05 [ERROR] ‚ùó Method non_nested_grid_search_0: FAILED - 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1016, in get_dataset
    return super().get_dataset(X_features, y_targets, length=correct_length)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: NeuralNet.get_dataset() got an unexpected keyword argument 'length'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1791, in get_split_datasets
    dataset = self.get_dataset(X, y)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1019, in get_dataset
    raise RuntimeError("Failed to process list of tuples input during CV split.") from e
RuntimeError: Failed to process list of tuples input during CV split.

2025-04-28 06:22:54 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 06:22:54 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 06:22:54 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 06:22:54 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 06:22:54 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 06:22:54 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 06:22:54 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 06:22:54 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 06:22:54 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 06:22:54 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 06:22:54 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 06:22:54 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 06:22:54 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 06:22:54 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 06:22:54 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 06:22:54 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 06:22:54 [DEBUG] üîç Method validation successful.
2025-04-28 06:22:54 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 06:22:54 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 06:22:54 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 06:22:54 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 06:22:54 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 06:22:54 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 06:22:54 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 06:22:54 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 06:22:54 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 06:22:55 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:22:55 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:22:55 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset directly (len=184).
2025-04-28 06:22:55 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset instantiation: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1013, in get_dataset
    return SkorchDataset(X_features, y_targets)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 06:22:56 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:22:56 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:22:56 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset directly (len=185).
2025-04-28 06:22:56 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset instantiation: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1013, in get_dataset
    return SkorchDataset(X_features, y_targets)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 06:22:56 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:22:56 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:22:56 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset directly (len=185).
2025-04-28 06:22:56 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset instantiation: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1013, in get_dataset
    return SkorchDataset(X_features, y_targets)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 06:22:57 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:22:57 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:22:57 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset directly (len=184).
2025-04-28 06:22:57 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset instantiation: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1013, in get_dataset
    return SkorchDataset(X_features, y_targets)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 06:22:58 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:22:58 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:22:58 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset directly (len=185).
2025-04-28 06:22:58 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset instantiation: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1013, in get_dataset
    return SkorchDataset(X_features, y_targets)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 06:22:59 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:22:59 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:22:59 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset directly (len=185).
2025-04-28 06:22:59 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset instantiation: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1013, in get_dataset
    return SkorchDataset(X_features, y_targets)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 06:23:00 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:23:00 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:23:00 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset directly (len=184).
2025-04-28 06:23:00 [ERROR] ‚ùó Error during manual unpacking or SkorchDataset instantiation: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1013, in get_dataset
    return SkorchDataset(X_features, y_targets)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
2025-04-28 06:24:41 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 06:24:41 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 06:24:41 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 06:24:41 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 06:24:41 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 06:24:41 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 06:24:41 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 06:24:41 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 06:24:41 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 06:24:41 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 06:24:41 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 06:24:41 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 06:24:41 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 06:24:41 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 06:24:41 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 06:24:41 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 06:24:41 [DEBUG] üîç Method validation successful.
2025-04-28 06:24:41 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 06:24:41 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 06:24:41 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 06:24:41 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 06:24:41 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 06:24:41 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 06:24:41 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 06:24:41 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 06:24:41 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 06:24:42 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:24:42 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:24:42 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Manually calculated length: 184
2025-04-28 06:24:42 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset directly with explicit length.
2025-04-28 06:24:43 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:24:43 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:24:43 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Manually calculated length: 185
2025-04-28 06:24:43 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset directly with explicit length.
2025-04-28 06:24:43 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:24:43 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:24:43 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Manually calculated length: 185
2025-04-28 06:24:43 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset directly with explicit length.
2025-04-28 06:24:44 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:24:44 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:24:44 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Manually calculated length: 184
2025-04-28 06:24:44 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset directly with explicit length.
2025-04-28 06:24:45 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:24:45 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:24:45 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Manually calculated length: 185
2025-04-28 06:24:45 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset directly with explicit length.
2025-04-28 06:24:46 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:24:46 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:24:46 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Manually calculated length: 185
2025-04-28 06:24:46 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset directly with explicit length.
2025-04-28 06:24:46 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:24:46 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:24:46 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Manually calculated length: 184
2025-04-28 06:24:46 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset directly with explicit length.
2025-04-28 06:24:47 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:24:47 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:24:47 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Manually calculated length: 185
2025-04-28 06:24:47 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset directly with explicit length.
2025-04-28 06:24:48 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:24:48 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:24:48 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Manually calculated length: 185
2025-04-28 06:24:48 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset directly with explicit length.
2025-04-28 06:24:49 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:24:49 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:24:49 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Manually calculated length: 184
2025-04-28 06:24:49 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset directly with explicit length.
2025-04-28 06:24:49 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:24:49 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:24:49 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Manually calculated length: 185
2025-04-28 06:24:49 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset directly with explicit length.
2025-04-28 06:24:50 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:24:50 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking.
2025-04-28 06:24:50 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Manually calculated length: 185
2025-04-28 06:24:50 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset directly with explicit length.
2025-04-28 06:24:50 [ERROR] ‚ùó !!! Method 'non_nested_grid_search' failed at step 1: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1220, in fit_loop
    self.run_single_epoch(iterator_train, training=True, prefix="train",
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1254, in run_single_epoch
    for batch in iterator:
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\utils\data\dataloader.py", line 757, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 200, in __getitem__
    Xi = multi_indexing(X, i, self.X_indexing)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\utils.py", line 370, in multi_indexing
    return indexing(data, i)
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\utils.py", line 250, in _indexing_list_tuple_of_data
    return [multi_indexing(x, i, indexing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\utils.py", line 250, in <listcomp>
    return [multi_indexing(x, i, indexing)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\utils.py", line 370, in multi_indexing
    return indexing(data, i)
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\utils.py", line 265, in _indexing_other
    return data[i]
           ~~~~^^^
IndexError: index 3 is out of bounds for dimension 0 with size 3
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2504, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1625, in non_nested_grid_search
    search.fit(train_dataset, y=y_train)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1024, in fit
    self._run_search(evaluate_candidates)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1571, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1001, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 517, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1220, in fit_loop
    self.run_single_epoch(iterator_train, training=True, prefix="train",
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1254, in run_single_epoch
    for batch in iterator:
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\utils\data\dataloader.py", line 757, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 200, in __getitem__
    Xi = multi_indexing(X, i, self.X_indexing)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\utils.py", line 370, in multi_indexing
    return indexing(data, i)
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\utils.py", line 250, in _indexing_list_tuple_of_data
    return [multi_indexing(x, i, indexing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\utils.py", line 250, in <listcomp>
    return [multi_indexing(x, i, indexing)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\utils.py", line 370, in multi_indexing
    return indexing(data, i)
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\utils.py", line 265, in _indexing_other
    return data[i]
           ~~~~^^^
IndexError: index 3 is out of bounds for dimension 0 with size 3

2025-04-28 06:24:50 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 06:24:50 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 06:24:50 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 06:24:50 [ERROR] ‚ùó Method non_nested_grid_search_0: FAILED - 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1220, in fit_loop
    self.run_single_epoch(iterator_train, training=True, prefix="train",
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1254, in run_single_epoch
    for batch in iterator:
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\utils\data\dataloader.py", line 757, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 200, in __getitem__
    Xi = multi_indexing(X, i, self.X_indexing)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\utils.py", line 370, in multi_indexing
    return indexing(data, i)
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\utils.py", line 250, in _indexing_list_tuple_of_data
    return [multi_indexing(x, i, indexing)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\utils.py", line 250, in <listcomp>
    return [multi_indexing(x, i, indexing)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\utils.py", line 370, in multi_indexing
    return indexing(data, i)
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\utils.py", line 265, in _indexing_other
    return data[i]
           ~~~~^^^
IndexError: index 3 is out of bounds for dimension 0 with size 3

2025-04-28 06:26:40 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 06:26:40 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 06:26:40 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 06:26:40 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 06:26:40 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 06:26:40 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 06:26:40 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 06:26:40 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 06:26:40 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 06:26:40 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 06:26:40 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 06:26:40 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 06:26:40 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 06:26:40 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 06:26:40 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 06:26:40 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 06:26:40 [DEBUG] üîç Method validation successful.
2025-04-28 06:26:40 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 06:26:40 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 06:26:40 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 06:26:40 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 06:26:40 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 06:26:40 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 06:26:40 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 06:26:40 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 06:26:40 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 06:26:41 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:26:41 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:26:41 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([184, 3, 64, 64])) and target array (shape=(184,)).
2025-04-28 06:26:42 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:26:42 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:26:42 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target array (shape=(185,)).
2025-04-28 06:26:42 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:26:42 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:26:42 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target array (shape=(185,)).
2025-04-28 06:26:43 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:26:43 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:26:43 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([184, 3, 64, 64])) and target array (shape=(184,)).
2025-04-28 06:26:44 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:26:44 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:26:44 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target array (shape=(185,)).
2025-04-28 06:26:45 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:26:45 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:26:45 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target array (shape=(185,)).
2025-04-28 06:26:45 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:26:45 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:26:45 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([184, 3, 64, 64])) and target array (shape=(184,)).
2025-04-28 06:26:46 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:26:46 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:26:46 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target array (shape=(185,)).
2025-04-28 06:26:47 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:26:47 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:26:47 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target array (shape=(185,)).
2025-04-28 06:26:48 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:26:48 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:26:48 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([184, 3, 64, 64])) and target array (shape=(184,)).
2025-04-28 06:26:48 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:26:49 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:26:49 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target array (shape=(185,)).
2025-04-28 06:26:49 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:26:49 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:26:49 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target array (shape=(185,)).
2025-04-28 06:26:49 [ERROR] ‚ùó !!! Method 'non_nested_grid_search' failed at step 1: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1220, in fit_loop
    self.run_single_epoch(iterator_train, training=True, prefix="train",
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1256, in run_single_epoch
    step = step_fn(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1135, in train_step
    self._step_optimizer(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1090, in _step_optimizer
    optimizer.step(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 487, in wrapper
    out = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 91, in _use_grad
    ret = func(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\adamw.py", line 197, in step
    loss = closure()
           ^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1124, in step_fn
    step = self.train_step_single(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1024, in train_step_single
    loss = self.get_loss(y_pred, yi, X=Xi, training=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 150, in get_loss
    return super().get_loss(y_pred, y_true, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1695, in get_loss
    return self.criterion_(y_pred, y_true)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\loss.py", line 1293, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\functional.py", line 3479, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: "nll_loss_forward_reduce_cuda_kernel_2d_index" not implemented for 'Int'
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2509, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1630, in non_nested_grid_search
    search.fit(train_dataset, y=y_train)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1024, in fit
    self._run_search(evaluate_candidates)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1571, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1001, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 517, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1220, in fit_loop
    self.run_single_epoch(iterator_train, training=True, prefix="train",
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1256, in run_single_epoch
    step = step_fn(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1135, in train_step
    self._step_optimizer(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1090, in _step_optimizer
    optimizer.step(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 487, in wrapper
    out = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 91, in _use_grad
    ret = func(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\adamw.py", line 197, in step
    loss = closure()
           ^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1124, in step_fn
    step = self.train_step_single(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1024, in train_step_single
    loss = self.get_loss(y_pred, yi, X=Xi, training=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 150, in get_loss
    return super().get_loss(y_pred, y_true, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1695, in get_loss
    return self.criterion_(y_pred, y_true)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\loss.py", line 1293, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\functional.py", line 3479, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: "nll_loss_forward_reduce_cuda_kernel_2d_index" not implemented for 'Int'

2025-04-28 06:26:49 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 06:26:49 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 06:26:49 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 06:26:49 [ERROR] ‚ùó Method non_nested_grid_search_0: FAILED - 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1220, in fit_loop
    self.run_single_epoch(iterator_train, training=True, prefix="train",
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1256, in run_single_epoch
    step = step_fn(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1135, in train_step
    self._step_optimizer(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1090, in _step_optimizer
    optimizer.step(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 487, in wrapper
    out = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 91, in _use_grad
    ret = func(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\adamw.py", line 197, in step
    loss = closure()
           ^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1124, in step_fn
    step = self.train_step_single(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1024, in train_step_single
    loss = self.get_loss(y_pred, yi, X=Xi, training=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 150, in get_loss
    return super().get_loss(y_pred, y_true, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1695, in get_loss
    return self.criterion_(y_pred, y_true)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\loss.py", line 1293, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\functional.py", line 3479, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: "nll_loss_forward_reduce_cuda_kernel_2d_index" not implemented for 'Int'

2025-04-28 06:28:12 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 06:28:12 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 06:28:12 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 06:28:12 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 06:28:12 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 06:28:12 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 06:28:12 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 06:28:12 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 06:28:12 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 06:28:12 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 06:28:12 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 06:28:12 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 06:28:12 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 06:28:12 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 06:28:12 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 06:28:12 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 06:28:12 [DEBUG] üîç Method validation successful.
2025-04-28 06:28:12 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 06:28:12 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 06:28:12 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 06:28:12 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 06:28:12 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 06:28:12 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 06:28:12 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 06:28:12 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 06:28:12 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 06:28:13 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:28:13 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:28:13 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([184, 3, 64, 64])) and target array (shape=(184,)).
2025-04-28 06:28:14 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:28:14 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:28:14 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target array (shape=(185,)).
2025-04-28 06:28:15 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:28:15 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:28:15 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target array (shape=(185,)).
2025-04-28 06:28:16 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:28:16 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:28:16 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([184, 3, 64, 64])) and target array (shape=(184,)).
2025-04-28 06:28:16 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:28:16 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:28:16 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target array (shape=(185,)).
2025-04-28 06:28:17 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:28:17 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:28:17 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target array (shape=(185,)).
2025-04-28 06:28:18 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:28:18 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:28:18 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([184, 3, 64, 64])) and target array (shape=(184,)).
2025-04-28 06:28:19 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:28:19 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:28:19 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target array (shape=(185,)).
2025-04-28 06:28:19 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:28:19 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:28:19 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target array (shape=(185,)).
2025-04-28 06:28:20 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:28:20 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:28:20 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([184, 3, 64, 64])) and target array (shape=(184,)).
2025-04-28 06:28:21 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:28:21 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:28:21 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target array (shape=(185,)).
2025-04-28 06:28:22 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:28:22 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:28:22 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target array (shape=(185,)).
2025-04-28 06:28:22 [ERROR] ‚ùó !!! Method 'non_nested_grid_search' failed at step 1: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1220, in fit_loop
    self.run_single_epoch(iterator_train, training=True, prefix="train",
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1256, in run_single_epoch
    step = step_fn(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1135, in train_step
    self._step_optimizer(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1090, in _step_optimizer
    optimizer.step(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 487, in wrapper
    out = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 91, in _use_grad
    ret = func(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\adamw.py", line 197, in step
    loss = closure()
           ^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1124, in step_fn
    step = self.train_step_single(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1024, in train_step_single
    loss = self.get_loss(y_pred, yi, X=Xi, training=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 150, in get_loss
    return super().get_loss(y_pred, y_true, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1695, in get_loss
    return self.criterion_(y_pred, y_true)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\loss.py", line 1293, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\functional.py", line 3479, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: "nll_loss_forward_reduce_cuda_kernel_2d_index" not implemented for 'Int'
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2509, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1630, in non_nested_grid_search
    search.fit(train_dataset, y=y_train)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1024, in fit
    self._run_search(evaluate_candidates)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1571, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1001, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 517, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1220, in fit_loop
    self.run_single_epoch(iterator_train, training=True, prefix="train",
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1256, in run_single_epoch
    step = step_fn(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1135, in train_step
    self._step_optimizer(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1090, in _step_optimizer
    optimizer.step(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 487, in wrapper
    out = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 91, in _use_grad
    ret = func(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\adamw.py", line 197, in step
    loss = closure()
           ^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1124, in step_fn
    step = self.train_step_single(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1024, in train_step_single
    loss = self.get_loss(y_pred, yi, X=Xi, training=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 150, in get_loss
    return super().get_loss(y_pred, y_true, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1695, in get_loss
    return self.criterion_(y_pred, y_true)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\loss.py", line 1293, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\functional.py", line 3479, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: "nll_loss_forward_reduce_cuda_kernel_2d_index" not implemented for 'Int'

2025-04-28 06:28:22 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 06:28:22 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 06:28:22 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 06:28:22 [ERROR] ‚ùó Method non_nested_grid_search_0: FAILED - 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1220, in fit_loop
    self.run_single_epoch(iterator_train, training=True, prefix="train",
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1256, in run_single_epoch
    step = step_fn(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1135, in train_step
    self._step_optimizer(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1090, in _step_optimizer
    optimizer.step(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 487, in wrapper
    out = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 91, in _use_grad
    ret = func(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\adamw.py", line 197, in step
    loss = closure()
           ^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1124, in step_fn
    step = self.train_step_single(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1024, in train_step_single
    loss = self.get_loss(y_pred, yi, X=Xi, training=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 150, in get_loss
    return super().get_loss(y_pred, y_true, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1695, in get_loss
    return self.criterion_(y_pred, y_true)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\loss.py", line 1293, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\functional.py", line 3479, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: "nll_loss_forward_reduce_cuda_kernel_2d_index" not implemented for 'Int'

2025-04-28 06:29:19 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 06:29:19 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 06:29:19 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 06:29:19 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 06:29:19 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 06:29:19 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 06:29:19 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 06:29:19 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 06:29:19 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 06:29:19 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 06:29:19 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 06:29:19 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 06:29:19 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 06:29:19 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 06:29:19 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 06:29:19 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 06:29:19 [DEBUG] üîç Method validation successful.
2025-04-28 06:29:19 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 06:29:19 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 06:29:19 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 06:29:19 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 06:29:19 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 06:29:19 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 06:29:19 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 06:29:19 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 06:29:19 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 06:29:20 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:29:20 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:29:20 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([184, 3, 64, 64])) and target tensor (shape=torch.Size([184]), dtype=torch.int64).
2025-04-28 06:29:21 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:29:21 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:29:21 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target tensor (shape=torch.Size([185]), dtype=torch.int64).
2025-04-28 06:29:22 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:29:22 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:29:22 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target tensor (shape=torch.Size([185]), dtype=torch.int64).
2025-04-28 06:29:22 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:29:22 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:29:22 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([184, 3, 64, 64])) and target tensor (shape=torch.Size([184]), dtype=torch.int64).
2025-04-28 06:29:23 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:29:23 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:29:23 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target tensor (shape=torch.Size([185]), dtype=torch.int64).
2025-04-28 06:29:24 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:29:24 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:29:24 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target tensor (shape=torch.Size([185]), dtype=torch.int64).
2025-04-28 06:29:25 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:29:25 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:29:25 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([184, 3, 64, 64])) and target tensor (shape=torch.Size([184]), dtype=torch.int64).
2025-04-28 06:29:26 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:29:26 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:29:26 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target tensor (shape=torch.Size([185]), dtype=torch.int64).
2025-04-28 06:29:27 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:29:27 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:29:27 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target tensor (shape=torch.Size([185]), dtype=torch.int64).
2025-04-28 06:29:27 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:29:27 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:29:27 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([184, 3, 64, 64])) and target tensor (shape=torch.Size([184]), dtype=torch.int64).
2025-04-28 06:29:28 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:29:28 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:29:28 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target tensor (shape=torch.Size([185]), dtype=torch.int64).
2025-04-28 06:29:29 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:29:29 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:29:29 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target tensor (shape=torch.Size([185]), dtype=torch.int64).
2025-04-28 06:29:29 [ERROR] ‚ùó !!! Method 'non_nested_grid_search' failed at step 1: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1226, in fit_loop
    self.notify("on_epoch_end", **on_epoch_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 429, in on_epoch_end
    current_score = net.history[-1, self.monitor]
                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 291, in __getitem__
    raise KeyError(keyerror_msg.format(key))
KeyError: "Key 'valid_loss' was not found in history."
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2515, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1636, in non_nested_grid_search
    search.fit(train_dataset, y=y_train)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1024, in fit
    self._run_search(evaluate_candidates)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1571, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1001, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 517, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1226, in fit_loop
    self.notify("on_epoch_end", **on_epoch_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 429, in on_epoch_end
    current_score = net.history[-1, self.monitor]
                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 291, in __getitem__
    raise KeyError(keyerror_msg.format(key))
KeyError: "Key 'valid_loss' was not found in history."

2025-04-28 06:29:29 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 06:29:29 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 06:29:29 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 06:29:29 [ERROR] ‚ùó Method non_nested_grid_search_0: FAILED - 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1226, in fit_loop
    self.notify("on_epoch_end", **on_epoch_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 429, in on_epoch_end
    current_score = net.history[-1, self.monitor]
                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 291, in __getitem__
    raise KeyError(keyerror_msg.format(key))
KeyError: "Key 'valid_loss' was not found in history."

2025-04-28 06:36:04 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 06:36:04 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 06:36:04 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 06:36:04 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 06:36:04 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 06:36:04 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 06:36:04 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 06:36:04 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 06:36:04 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 06:36:04 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 06:36:04 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 06:36:04 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 06:36:04 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 06:36:04 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 06:36:04 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 06:36:04 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 06:36:04 [DEBUG] üîç Method validation successful.
2025-04-28 06:36:04 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 06:36:04 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 06:36:04 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 06:36:04 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 06:36:04 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 06:36:04 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 06:36:04 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 06:36:04 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 06:36:04 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 06:36:05 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:36:05 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:36:05 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([184, 3, 64, 64])) and target tensor (shape=torch.Size([184]), dtype=torch.int64).
2025-04-28 06:36:06 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:36:06 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:36:06 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target tensor (shape=torch.Size([185]), dtype=torch.int64).
2025-04-28 06:36:07 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:36:07 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:36:07 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target tensor (shape=torch.Size([185]), dtype=torch.int64).
2025-04-28 06:36:08 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:36:08 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:36:08 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([184, 3, 64, 64])) and target tensor (shape=torch.Size([184]), dtype=torch.int64).
2025-04-28 06:36:09 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:36:09 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:36:09 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target tensor (shape=torch.Size([185]), dtype=torch.int64).
2025-04-28 06:36:10 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:36:10 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:36:10 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target tensor (shape=torch.Size([185]), dtype=torch.int64).
2025-04-28 06:36:10 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:36:10 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:36:10 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([184, 3, 64, 64])) and target tensor (shape=torch.Size([184]), dtype=torch.int64).
2025-04-28 06:36:11 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:36:11 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:36:11 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target tensor (shape=torch.Size([185]), dtype=torch.int64).
2025-04-28 06:36:12 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:36:12 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:36:12 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target tensor (shape=torch.Size([185]), dtype=torch.int64).
2025-04-28 06:36:13 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:36:13 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:36:13 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([184, 3, 64, 64])) and target tensor (shape=torch.Size([184]), dtype=torch.int64).
2025-04-28 06:36:14 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:36:14 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:36:14 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target tensor (shape=torch.Size([185]), dtype=torch.int64).
2025-04-28 06:36:14 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:36:14 [DEBUG] üîç [DEBUG] Adapter.get_dataset: X is list of tuples. Manual unpacking and stacking.
2025-04-28 06:36:14 [DEBUG] üîç [DEBUG] Adapter.get_dataset: Instantiating SkorchDataset with stacked tensor (shape=torch.Size([185, 3, 64, 64])) and target tensor (shape=torch.Size([185]), dtype=torch.int64).
2025-04-28 06:36:15 [ERROR] ‚ùó !!! Method 'non_nested_grid_search' failed at step 1: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1226, in fit_loop
    self.notify("on_epoch_end", **on_epoch_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 429, in on_epoch_end
    current_score = net.history[-1, self.monitor]
                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 291, in __getitem__
    raise KeyError(keyerror_msg.format(key))
KeyError: "Key 'valid_loss' was not found in history."
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2519, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1637, in non_nested_grid_search
    search.fit(train_dataset, y=y_train)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1024, in fit
    self._run_search(evaluate_candidates)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1571, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1001, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 517, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1226, in fit_loop
    self.notify("on_epoch_end", **on_epoch_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 429, in on_epoch_end
    current_score = net.history[-1, self.monitor]
                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 291, in __getitem__
    raise KeyError(keyerror_msg.format(key))
KeyError: "Key 'valid_loss' was not found in history."

2025-04-28 06:36:15 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 06:36:15 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 06:36:15 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 06:36:15 [ERROR] ‚ùó Method non_nested_grid_search_0: FAILED - 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1226, in fit_loop
    self.notify("on_epoch_end", **on_epoch_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 416, in notify
    getattr(cb, method_name)(self, **cb_kwargs)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\callbacks\training.py", line 429, in on_epoch_end
    current_score = net.history[-1, self.monitor]
                    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\history.py", line 291, in __getitem__
    raise KeyError(keyerror_msg.format(key))
KeyError: "Key 'valid_loss' was not found in history."

2025-04-28 06:46:51 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 06:46:51 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 06:46:51 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 06:46:51 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 06:46:51 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 06:46:51 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 06:46:51 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 06:46:51 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 06:46:51 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 06:46:51 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 06:46:51 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 06:46:51 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 06:46:51 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 06:46:51 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 06:46:51 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 06:46:51 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 06:46:51 [DEBUG] üîç Method validation successful.
2025-04-28 06:46:51 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 06:46:51 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 06:46:51 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 06:46:51 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 06:46:51 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 06:46:51 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 06:46:51 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 06:46:51 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 06:46:51 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 06:46:52 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:46:53 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:46:54 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:46:55 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:46:55 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:46:56 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:48:22 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 06:48:22 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 06:48:22 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 06:48:22 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 06:48:22 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 06:48:22 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 06:48:22 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 06:48:22 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 06:48:22 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 06:48:22 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 06:48:22 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 06:48:22 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 06:48:22 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 06:48:22 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 06:48:22 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 06:48:22 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 06:48:22 [DEBUG] üîç Method validation successful.
2025-04-28 06:48:22 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 06:48:22 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 06:48:22 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 06:48:22 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 06:48:22 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 06:48:22 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 06:48:22 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 06:48:22 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 06:48:22 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 06:48:22 [DEBUG] üîç Wrapping train_dataset in skorch.dataset.SliceDataset
2025-04-28 06:48:22 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:48:22 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:48:22 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:48:22 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:48:22 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:48:22 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:48:22 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:48:23 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:48:23 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:48:23 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:48:23 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:48:23 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:48:23 [ERROR] ‚ùó !!! Method 'non_nested_grid_search' failed at step 1: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1220, in fit_loop
    self.run_single_epoch(iterator_train, training=True, prefix="train",
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1256, in run_single_epoch
    step = step_fn(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1135, in train_step
    self._step_optimizer(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1090, in _step_optimizer
    optimizer.step(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 487, in wrapper
    out = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 91, in _use_grad
    ret = func(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\adamw.py", line 197, in step
    loss = closure()
           ^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1124, in step_fn
    step = self.train_step_single(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1024, in train_step_single
    loss = self.get_loss(y_pred, yi, X=Xi, training=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 150, in get_loss
    return super().get_loss(y_pred, y_true, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1695, in get_loss
    return self.criterion_(y_pred, y_true)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\loss.py", line 1293, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\functional.py", line 3479, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: "nll_loss_forward_reduce_cuda_kernel_2d_index" not implemented for 'Int'
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2532, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1650, in non_nested_grid_search
    search.fit(X_wrapped, y=y_train)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1024, in fit
    self._run_search(evaluate_candidates)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1571, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1001, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 517, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1220, in fit_loop
    self.run_single_epoch(iterator_train, training=True, prefix="train",
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1256, in run_single_epoch
    step = step_fn(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1135, in train_step
    self._step_optimizer(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1090, in _step_optimizer
    optimizer.step(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 487, in wrapper
    out = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 91, in _use_grad
    ret = func(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\adamw.py", line 197, in step
    loss = closure()
           ^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1124, in step_fn
    step = self.train_step_single(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1024, in train_step_single
    loss = self.get_loss(y_pred, yi, X=Xi, training=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 150, in get_loss
    return super().get_loss(y_pred, y_true, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1695, in get_loss
    return self.criterion_(y_pred, y_true)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\loss.py", line 1293, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\functional.py", line 3479, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: "nll_loss_forward_reduce_cuda_kernel_2d_index" not implemented for 'Int'

2025-04-28 06:48:23 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 06:48:23 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 06:48:23 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 06:48:23 [ERROR] ‚ùó Method non_nested_grid_search_0: FAILED - 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1220, in fit_loop
    self.run_single_epoch(iterator_train, training=True, prefix="train",
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1256, in run_single_epoch
    step = step_fn(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1135, in train_step
    self._step_optimizer(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1090, in _step_optimizer
    optimizer.step(step_fn)
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 487, in wrapper
    out = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\optimizer.py", line 91, in _use_grad
    ret = func(self, *args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\optim\adamw.py", line 197, in step
    loss = closure()
           ^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1124, in step_fn
    step = self.train_step_single(batch, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1024, in train_step_single
    loss = self.get_loss(y_pred, yi, X=Xi, training=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 150, in get_loss
    return super().get_loss(y_pred, y_true, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1695, in get_loss
    return self.criterion_(y_pred, y_true)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\modules\loss.py", line 1293, in forward
    return F.cross_entropy(
           ^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\nn\functional.py", line 3479, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: "nll_loss_forward_reduce_cuda_kernel_2d_index" not implemented for 'Int'

2025-04-28 06:58:14 [DEBUG] üîç Chosen sequence: [('non_nested_grid_search', {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True})]
2025-04-28 06:58:14 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 06:58:14 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 06:58:14 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 06:58:14 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 06:58:14 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 06:58:14 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 06:58:14 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 06:58:15 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 06:58:15 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 06:58:15 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 06:58:15 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 06:58:15 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 06:58:15 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 06:58:15 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 06:58:15 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 06:58:15 [DEBUG] üîç Method validation successful.
2025-04-28 06:58:15 [INFO] ‚ÑπÔ∏è Executor configured to run methods: non_nested_grid_search
2025-04-28 06:58:15 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 06:58:15 [INFO] ‚ÑπÔ∏è --- Running Method 1/1: non_nested_grid_search ---
2025-04-28 06:58:15 [DEBUG] üîç Parameters for non_nested_grid_search: {'param_grid': {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}, 'cv': 3, 'method': 'grid', 'scoring': 'accuracy', 'save_results': True}
2025-04-28 06:58:15 [INFO] ‚ÑπÔ∏è Performing non-nested 'grid' search with 3-fold CV on training data.
2025-04-28 06:58:15 [INFO] ‚ÑπÔ∏è Parameter Grid: {'lr': [0.001, 0.0005], 'optimizer__weight_decay': [0.01, 0.001]}
2025-04-28 06:58:15 [INFO] ‚ÑπÔ∏è Scoring Metric: accuracy
2025-04-28 06:58:15 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 06:58:15 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 06:58:15 [INFO] ‚ÑπÔ∏è Fitting GridSearchCV on the training dataset...
2025-04-28 06:58:15 [DEBUG] üîç Extracted y_train with shape (277,) for CV splitter.
2025-04-28 06:58:15 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:58:16 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:58:17 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:58:18 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:58:18 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:58:19 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:58:20 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:58:21 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:58:21 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:58:22 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:58:23 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:58:24 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 06:58:24 [ERROR] ‚ùó !!! Method 'non_nested_grid_search' failed at step 1: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1791, in get_split_datasets
    dataset = self.get_dataset(X, y)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 2513, in run
    result = pipeline_method(**params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\code_v5.py", line 1631, in non_nested_grid_search
    search.fit(train_dataset, y=y_train)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1024, in fit
    self._run_search(evaluate_candidates)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1571, in _run_search
    evaluate_candidates(ParameterGrid(self.param_grid))
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_search.py", line 1001, in evaluate_candidates
    _warn_or_raise_about_fit_failures(out, self.error_score)
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 517, in _warn_or_raise_about_fit_failures
    raise ValueError(all_fits_failed_message)
ValueError: 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1791, in get_split_datasets
    dataset = self.get_dataset(X, y)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

2025-04-28 06:58:24 [ERROR] ‚ùó !!! Pipeline execution stopped due to error.
2025-04-28 06:58:24 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 06:58:24 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 06:58:24 [ERROR] ‚ùó Method non_nested_grid_search_0: FAILED - 
All the 12 fits failed.
It is very likely that your model is misconfigured.
You can try to debug the error by setting error_score='raise'.

Below are more details about the failures:
--------------------------------------------------------------------------------
12 fits failed with the following error:
Traceback (most recent call last):
  File "C:\Users\Stefan\.venv\Lib\site-packages\sklearn\model_selection\_validation.py", line 866, in _fit_and_score
    estimator.fit(X_train, y_train, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1206, in fit_loop
    dataset_train, dataset_valid = self.get_split_datasets(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1791, in get_split_datasets
    dataset = self.get_dataset(X, y)
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 163, in __init__
    raise ValueError("X and y have inconsistent lengths.")
ValueError: X and y have inconsistent lengths.

2025-04-28 07:01:59 [DEBUG] üîç Chosen sequence: [('single_train', {'max_epochs': 5, 'save_model': True}), ('single_eval', {'save_results': True})]
2025-04-28 07:01:59 [INFO] ‚ÑπÔ∏è Initializing Pipeline Executor for model 'cnn' on dataset 'mini-GCD-flat'...
2025-04-28 07:01:59 [INFO] ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-04-28 07:01:59 [INFO] ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat
2025-04-28 07:01:59 [INFO] ‚ÑπÔ∏è   Model Type: cnn
2025-04-28 07:01:59 [DEBUG] üîç Did not find standard 'train'/'test' structure. Assuming FLAT structure.
2025-04-28 07:01:59 [INFO] ‚ÑπÔ∏è Detected dataset structure: flat
2025-04-28 07:01:59 [INFO] ‚ÑπÔ∏è Loading FLAT dataset from C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\..\data\mini-GCD-flat...
2025-04-28 07:01:59 [INFO] ‚ÑπÔ∏è Full dataset loaded: 434 samples.
2025-04-28 07:01:59 [DEBUG] üîç Initial split: 347 train+val, 87 test indices.
2025-04-28 07:01:59 [DEBUG] üîç Train/Val split: 277 train, 70 validation indices.
2025-04-28 07:01:59 [INFO] ‚ÑπÔ∏è FLAT Dataset splits: 277 train, 70 validation, 87 test samples.
2025-04-28 07:01:59 [INFO] ‚ÑπÔ∏è Found 7 classes: 1_cumulus, 2_altocumulus, 3_cirrus, 4_clearsky, 5_stratocumulus, 6_cumulonimbus, 7_mixed
2025-04-28 07:01:59 [INFO] ‚ÑπÔ∏è   Results will be saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn
2025-04-28 07:01:59 [INFO] ‚ÑπÔ∏è   Model Adapter: Initialized with SimpleCNN
2025-04-28 07:01:59 [INFO] ‚ÑπÔ∏è Pipeline initialized successfully for cnn model and flat dataset structure.
2025-04-28 07:01:59 [DEBUG] üîç Method validation successful.
2025-04-28 07:01:59 [INFO] ‚ÑπÔ∏è Executor configured to run methods: single_train, single_eval
2025-04-28 07:01:59 [INFO] ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-04-28 07:01:59 [INFO] ‚ÑπÔ∏è --- Running Method 1/2: single_train ---
2025-04-28 07:01:59 [DEBUG] üîç Parameters for single_train: {'max_epochs': 5, 'save_model': True}
2025-04-28 07:01:59 [INFO] ‚ÑπÔ∏è Starting single training run...
2025-04-28 07:01:59 [INFO] ‚ÑπÔ∏è Combining train (277) and validation (70) sets for skorch internal split (total: 347 samples).
2025-04-28 07:01:59 [INFO] ‚ÑπÔ∏è Overriding model adapter parameters for this run: {'max_epochs': 5}
2025-04-28 07:01:59 [DEBUG] üîç Extracted combined targets (shape=(347,)) for skorch fit.
2025-04-28 07:01:59 [DEBUG] üîç SimpleCNN initialized with 7 output classes.
2025-04-28 07:02:04 [INFO] ‚ÑπÔ∏è Training finished. Best validation performance at Epoch 5 (valid_loss=1.2328)
2025-04-28 07:02:04 [INFO] ‚ÑπÔ∏è Model state_dict saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\cnn_epoch5_val_valid-loss1.2328_20250428_070204.pt
2025-04-28 07:02:04 [INFO] ‚ÑπÔ∏è Detailed results saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\single_train_batch_size=16_early_stopping_patience=5_lr=0.001_max_epochs=5_20250428_070204.json
2025-04-28 07:02:04 [INFO] ‚ÑπÔ∏è Summary results updated in: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\summary_results.csv
2025-04-28 07:02:04 [INFO] ‚ÑπÔ∏è --- Method single_train completed successfully ---
2025-04-28 07:02:04 [INFO] ‚ÑπÔ∏è --- Running Method 2/2: single_eval ---
2025-04-28 07:02:04 [DEBUG] üîç Parameters for single_eval: {'save_results': True}
2025-04-28 07:02:04 [INFO] ‚ÑπÔ∏è Starting model evaluation on the test set...
2025-04-28 07:02:04 [INFO] ‚ÑπÔ∏è Evaluating on 87 test samples.
2025-04-28 07:02:04 [DEBUG] üîç Generating predictions on the test set...
2025-04-28 07:02:05 [DEBUG] üîç Generating probabilities on the test set...
2025-04-28 07:02:05 [DEBUG] üîç Predictions and probabilities generated.
2025-04-28 07:02:05 [DEBUG] üîç Extracting true labels from the test set...
2025-04-28 07:02:35 [DEBUG] üîç True labels extracted.
2025-04-28 07:02:35 [DEBUG] üîç Computing evaluation metrics...
2025-04-28 07:02:35 [DEBUG] üîç Computed Metrics: Acc=0.6207, Macro F1=0.5973, Macro ROC AUC=0.8906, Macro PR AUC=0.6359
2025-04-28 07:02:35 [INFO] ‚ÑπÔ∏è Evaluation metrics computed.
2025-04-28 07:02:35 [INFO] ‚ÑπÔ∏è Detailed results saved to: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\single_eval_20250428_070235.json
2025-04-28 07:02:35 [INFO] ‚ÑπÔ∏è Summary results updated in: C:\Users\Stefan\Documents\GitHub\UBB-Y3-AI-Research\model_src\pipeline_v2\results\mini-GCD-flat\cnn\summary_results.csv
2025-04-28 07:02:35 [INFO] ‚ÑπÔ∏è Evaluation Summary:
2025-04-28 07:02:35 [INFO] ‚ÑπÔ∏è   Accuracy: 0.6207
2025-04-28 07:02:35 [INFO] ‚ÑπÔ∏è   Macro Precision: 0.6737
2025-04-28 07:02:35 [INFO] ‚ÑπÔ∏è   Macro Recall: 0.6227
2025-04-28 07:02:35 [INFO] ‚ÑπÔ∏è   Macro Specificity: 0.9368
2025-04-28 07:02:35 [INFO] ‚ÑπÔ∏è   Macro F1-Score: 0.5973
2025-04-28 07:02:35 [INFO] ‚ÑπÔ∏è   Macro ROC AUC: 0.8906
2025-04-28 07:02:35 [INFO] ‚ÑπÔ∏è   Macro PR AUC: 0.6359
2025-04-28 07:02:35 [INFO] ‚ÑπÔ∏è --- Method single_eval completed successfully ---
2025-04-28 07:02:35 [INFO] ‚ÑπÔ∏è Pipeline execution finished.
2025-04-28 07:02:35 [INFO] ‚ÑπÔ∏è --- Final Execution Results ---
2025-04-28 07:02:35 [INFO] ‚ÑπÔ∏è Method single_train_0: Completed. (Accuracy/MeanAccuracy: nan, BestScore: nan)
2025-04-28 07:02:35 [INFO] ‚ÑπÔ∏è Method single_eval_1: Completed. (Accuracy/MeanAccuracy: 0.6207, BestScore: nan)
