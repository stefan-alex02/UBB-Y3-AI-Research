2025-04-26 20:10:48 - âœ¨ INFO - [pipeline.py:70] - ğŸš€ Initializing Classification Pipeline...
2025-04-26 20:10:48 - âœ¨ INFO - [pipeline.py:71] - Dataset: mini-GCD
2025-04-26 20:10:48 - âœ¨ INFO - [pipeline.py:72] - Model: dummycnn
2025-04-26 20:10:48 - âœ¨ INFO - [pipeline.py:73] - Output Dir: results_pipeline
2025-04-26 20:10:48 - âœ¨ INFO - [pipeline.py:74] - Seed: 42
2025-04-26 20:10:48 - ğŸ› DEBUG - [datasets.py:93] - Detected FIXED dataset structure.
2025-04-26 20:10:48 - âœ¨ INFO - [datasets.py:137] - FIXED: Loaded 75 train images and 75 test images.
2025-04-26 20:10:48 - âœ¨ INFO - [datasets.py:83] - ğŸ“ Dataset 'mini-GCD' loaded. Structure: FIXED. Classes: 3
2025-04-26 20:10:48 - âœ¨ INFO - [pipeline.py:87] - ğŸ’» Device: CUDA
2025-04-26 20:10:48 - âœ¨ INFO - [pipeline.py:155] - âœ¨ Initializing NEW model: dummycnn...
2025-04-26 20:10:48 - âœ¨ INFO - [adapters.py:147] - ğŸ¤– Initializing SkorchImageClassifier with device: cuda
2025-04-26 20:10:48 - âœ¨ INFO - [adapters.py:148] - Callbacks: ['early_stopping']
2025-04-26 20:10:48 - âœ¨ INFO - [pipeline.py:161] - âœ… New model adapter created.
2025-04-26 20:10:48 - âœ¨ INFO - [pipeline.py:186] - â• Added method to pipeline: single_train with config: {'val_size': 0.25, 'save_results': True, 'name': 'single_train', 'dataset_name': 'mini-GCD', 'model_name': 'dummycnn'}
2025-04-26 20:10:48 - âœ¨ INFO - [pipeline.py:186] - â• Added method to pipeline: single_eval with config: {'save_results': True, 'name': 'single_eval', 'dataset_name': 'mini-GCD', 'model_name': 'dummycnn'}
2025-04-26 20:10:48 - âœ¨ INFO - [pipeline.py:190] - ğŸ Starting pipeline execution with 2 steps...
2025-04-26 20:10:48 - âœ¨ INFO - [pipeline.py:200] - 
--- Running Step 1/2: single_train ---
2025-04-26 20:10:48 - âœ¨ INFO - [methods.py:448] - ğŸš€ Starting Single Train process...
2025-04-26 20:10:48 - âœ¨ INFO - [datasets.py:218] - Split data: 56 train, 19 validation samples.
2025-04-26 20:10:48 - âœ¨ INFO - [methods.py:473] - ğŸ’ª Starting training on 56 samples, validating on 19 samples...
2025-04-26 20:10:48 - âœ¨ INFO - [adapters.py:195] - Passing validation data (paths and labels) directly to super().fit.
2025-04-26 20:10:48 - ğŸ› DEBUG - [adapters.py:199] - Calling super().fit with: X=List(len=56), y=np.array(shape=(56,)), X_valid=<class 'list'>(len=19), y_valid=<class 'numpy.ndarray'>(shape=(19,))
2025-04-26 20:10:55 - ğŸ› DEBUG - [adapters.py:101] - Collate Path/Label: Successfully processed 16 images. Shape Img: torch.Size([16, 3, 128, 128]), Shape Lbl: torch.Size([16]), Lbl dtype: torch.int64
2025-04-26 20:15:40 - âœ¨ INFO - [methods.py:487] - âœ… Single Train completed.
2025-04-26 20:15:40 - âœ¨ INFO - [methods.py:524] - ğŸ“‰ Training history summary (last epoch): Train loss nan (Validation loss not recorded in history)
2025-04-26 20:15:40 - âœ¨ INFO - [methods.py:42] - ğŸ“Š Metrics saved to results_pipeline\mini-GCD\dummycnn\single_train_f2aa8ee6\metrics.json
2025-04-26 20:15:40 - âœ¨ INFO - [methods.py:53] - ğŸ’¾ Model saved to results_pipeline\mini-GCD\dummycnn\single_train_f2aa8ee6\trained_model.pt
2025-04-26 20:15:40 - âœ¨ INFO - [pipeline.py:260] - âœ… Step 1 ('single_train') completed successfully.
2025-04-26 20:15:40 - âœ¨ INFO - [pipeline.py:264] - ğŸ”„ Pipeline model adapter updated by 'single_train'.
2025-04-26 20:15:40 - âœ¨ INFO - [pipeline.py:200] - 
--- Running Step 2/2: single_eval ---
2025-04-26 20:15:40 - âœ¨ INFO - [methods.py:581] - ğŸš€ Starting Single Evaluation on Test Set...
2025-04-26 20:15:40 - âœ¨ INFO - [methods.py:604] - ğŸ§ª Evaluating model on 75 test samples...
2025-04-26 20:15:40 - âŒ ERROR - [methods.py:646] - âŒ Single Evaluation failed: default_collate: batch must contain tensors, numpy arrays, numbers, dicts or lists; found <class 'NoneType'>
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\Github\UBB-Y3-AI-Research\model_src\pipeline\methods.py", line 608, in run_single_eval
    y_pred = model_adapter.predict(X_test.tolist()) # Pass list of paths
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 232, in predict
    return self.predict_proba(X).argmax(axis=1)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 200, in predict_proba
    return super().predict_proba(X)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1625, in predict_proba
    for yp in self.forward_iter(X, training=False):
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1470, in forward_iter
    for batch in iterator:
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\utils\data\dataloader.py", line 701, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\utils\data\dataloader.py", line 757, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\utils\data\_utils\fetch.py", line 55, in fetch
    return self.collate_fn(data)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\Documents\Github\UBB-Y3-AI-Research\model_src\pipeline\adapters.py", line 95, in collate_path_label_data
    labels_tensor = default_collate(labels) # default_collate likely makes Long, but let's be explicit
                    ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\utils\data\_utils\collate.py", line 398, in default_collate
    return collate(batch, collate_fn_map=default_collate_fn_map)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\torch\utils\data\_utils\collate.py", line 240, in collate
    raise TypeError(default_collate_err_msg_format.format(elem_type))
TypeError: default_collate: batch must contain tensors, numpy arrays, numbers, dicts or lists; found <class 'NoneType'>
2025-04-26 20:15:40 - âœ¨ INFO - [pipeline.py:285] - 
ğŸ Pipeline execution finished in 291.67 seconds.
2025-04-26 20:15:40 - âœ¨ INFO - [pipeline.py:289] - ğŸ’¾ Saving final model state to: results_pipeline\mini-GCD\dummycnn\final_pipeline_model.pt
2025-04-26 20:15:40 - âœ¨ INFO - [pipeline.py:295] - âœ… Final model saved successfully.
2025-04-26 20:15:40 - âœ¨ INFO - [main.py:148] - 
--- Pipeline Completed ---
