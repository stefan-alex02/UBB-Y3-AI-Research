2025-04-26 14:59:03 - âœ¨ INFO - [pipeline.py:69] - ğŸš€ Initializing Classification Pipeline...
2025-04-26 14:59:03 - âœ¨ INFO - [pipeline.py:70] - Dataset: mini-GCD
2025-04-26 14:59:03 - âœ¨ INFO - [pipeline.py:71] - Model: dummycnn
2025-04-26 14:59:03 - âœ¨ INFO - [pipeline.py:72] - Output Dir: results_pipeline
2025-04-26 14:59:03 - âœ¨ INFO - [pipeline.py:73] - Seed: 42
2025-04-26 14:59:03 - âœ¨ INFO - [datasets.py:137] - FIXED: Loaded 75 train images and 75 test images.
2025-04-26 14:59:03 - âœ¨ INFO - [datasets.py:83] - ğŸ“ Dataset 'mini-GCD' loaded. Structure: FIXED. Classes: 3
2025-04-26 14:59:03 - âœ¨ INFO - [pipeline.py:86] - ğŸ’» Device: CUDA
2025-04-26 14:59:03 - âœ¨ INFO - [pipeline.py:154] - âœ¨ Initializing NEW model: dummycnn...
2025-04-26 14:59:03 - âœ¨ INFO - [adapters.py:134] - ğŸ¤– Initializing SkorchImageClassifier with device: cuda
2025-04-26 14:59:03 - âœ¨ INFO - [adapters.py:135] - Callbacks: ['early_stopping']
2025-04-26 14:59:03 - âœ¨ INFO - [pipeline.py:160] - âœ… New model adapter created.
2025-04-26 14:59:03 - âœ¨ INFO - [pipeline.py:185] - â• Added method to pipeline: single_train with config: {'val_size': 0.25, 'save_results': True, 'name': 'single_train', 'dataset_name': 'mini-GCD', 'model_name': 'dummycnn'}
2025-04-26 14:59:03 - âœ¨ INFO - [pipeline.py:185] - â• Added method to pipeline: single_eval with config: {'save_results': True, 'name': 'single_eval', 'dataset_name': 'mini-GCD', 'model_name': 'dummycnn'}
2025-04-26 14:59:03 - âœ¨ INFO - [pipeline.py:189] - ğŸ Starting pipeline execution with 2 steps...
2025-04-26 14:59:03 - âœ¨ INFO - [pipeline.py:199] - 
--- Running Step 1/2: single_train ---
2025-04-26 14:59:03 - âœ¨ INFO - [methods.py:448] - ğŸš€ Starting Single Train process...
2025-04-26 14:59:03 - âœ¨ INFO - [datasets.py:218] - Split data: 56 train, 19 validation samples.
2025-04-26 14:59:03 - âœ¨ INFO - [methods.py:473] - ğŸ’ª Starting training on 56 samples, validating on 19 samples...
2025-04-26 14:59:03 - âœ¨ INFO - [adapters.py:207] - Fitting with provided validation data.
2025-04-26 14:59:03 - âŒ ERROR - [methods.py:514] - âŒ Single Train failed: Cannot convert this data type to a numpy array.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\Github\UBB-Y3-AI-Research\model_src\pipeline\methods.py", line 485, in run_single_train
    model_adapter.fit(X_train.tolist(), y_train.tolist(), **fit_params)
  File "C:\Users\Stefan\Documents\Github\UBB-Y3-AI-Research\model_src\pipeline\adapters.py", line 208, in fit
    super().fit(X=dataset, y=None, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 165, in fit
    return super(NeuralNetClassifier, self).fit(X, y, **fit_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1349, in fit
    self.partial_fit(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1308, in partial_fit
    self.fit_loop(X, y, **fit_params)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1202, in fit_loop
    self.check_data(X, y)
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 134, in check_data
    self.classes_inferred_ = np.unique(to_numpy(y_ds))
                                       ^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\utils.py", line 153, in to_numpy
    raise TypeError("Cannot convert this data type to a numpy array.")
TypeError: Cannot convert this data type to a numpy array.
2025-04-26 14:59:03 - âœ¨ INFO - [pipeline.py:199] - 
--- Running Step 2/2: single_eval ---
2025-04-26 14:59:03 - âœ¨ INFO - [methods.py:542] - ğŸš€ Starting Single Evaluation on Test Set...
2025-04-26 14:59:03 - âœ¨ INFO - [methods.py:565] - ğŸ§ª Evaluating model on 75 test samples...
2025-04-26 14:59:03 - âŒ ERROR - [methods.py:607] - âŒ Single Evaluation failed: Dataset does not have consistent lengths.
Traceback (most recent call last):
  File "C:\Users\Stefan\Documents\Github\UBB-Y3-AI-Research\model_src\pipeline\methods.py", line 569, in run_single_eval
    y_pred = model_adapter.predict(X_test.tolist()) # Pass list of paths
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 232, in predict
    return self.predict_proba(X).argmax(axis=1)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\classifier.py", line 200, in predict_proba
    return super().predict_proba(X)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1625, in predict_proba
    for yp in self.forward_iter(X, training=False):
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1468, in forward_iter
    dataset = self.get_dataset(X)
              ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\net.py", line 1746, in get_dataset
    return dataset(X, y, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 159, in __init__
    len_X = get_len(X)
            ^^^^^^^^^^
  File "C:\Users\Stefan\.venv\Lib\site-packages\skorch\dataset.py", line 82, in get_len
    raise ValueError("Dataset does not have consistent lengths.")
ValueError: Dataset does not have consistent lengths.
2025-04-26 14:59:03 - âœ¨ INFO - [pipeline.py:284] - 
ğŸ Pipeline execution finished in 0.32 seconds.
2025-04-26 14:59:03 - âœ¨ INFO - [pipeline.py:288] - ğŸ’¾ Saving final model state to: results_pipeline\mini-GCD\dummycnn\final_pipeline_model.pt
2025-04-26 14:59:03 - âœ¨ INFO - [pipeline.py:294] - âœ… Final model saved successfully.
2025-04-26 14:59:03 - âœ¨ INFO - [main.py:148] - 
--- Pipeline Completed ---
