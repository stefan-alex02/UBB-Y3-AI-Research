Timestamp           | Level    | Location                             | Message
--------------------+----------+--------------------------------------+---------------------------------------------------
2025-05-30 14:17:06 | INFO     | [logger_...:setup_logger      : 153] | ‚ÑπÔ∏è Logger 'ImgClassPipe' initialized. Log file: C:\Users\Stefan Alexandrescu\Documents\GitHub\UBB-Y3-AI-Research\model_src\experiments\Swimcat-extend\hvit\20250530_141706_seed42\experiment_run_20250530_141706_seed42.log
2025-05-30 14:17:06 | INFO     | [executor  :__init__          : 100] | ‚ÑπÔ∏è --- Starting Experiment Run (ID: 20250530_141706_seed42) ---
2025-05-30 14:17:06 | INFO     | [executor  :__init__          : 101] | ‚ÑπÔ∏è Executor initialized for model 'hvit' on dataset 'Swimcat-extend'
2025-05-30 14:17:06 | INFO     | [executor  :__init__          : 104] | ‚ÑπÔ∏è Local artifact storage base: C:\Users\Stefan Alexandrescu\Documents\GitHub\UBB-Y3-AI-Research\model_src
2025-05-30 14:17:06 | INFO     | [executor  :__init__          : 108] | ‚ÑπÔ∏è Base key/prefix for this run's artifacts: experiments/Swimcat-extend/hvit/20250530_141706_seed42
2025-05-30 14:17:06 | INFO     | [executor  :__init__          : 110] | ‚ÑπÔ∏è Local log file for this run (might be temporary): C:\Users\Stefan Alexandrescu\Documents\GitHub\UBB-Y3-AI-Research\model_src\experiments\Swimcat-extend\hvit\20250530_141706_seed42\experiment_run_20250530_141706_seed42.log
2025-05-30 14:17:06 | INFO     | [pipeline  :__init__          : 173] | ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-05-30 14:17:06 | INFO     | [pipeline  :__init__          : 174] | ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan Alexandrescu\Documents\GitHub\UBB-Y3-AI-Research\model_src\data\Swimcat-extend
2025-05-30 14:17:06 | INFO     | [pipeline  :__init__          : 175] | ‚ÑπÔ∏è   Model Type: hvit
2025-05-30 14:17:06 | INFO     | [pipeline  :__init__          : 178] | ‚ÑπÔ∏è   Artifact base key prefix for this run: experiments/Swimcat-extend/hvit/20250530_141706_seed42 (using LocalFileSystemRepository)
2025-05-30 14:17:06 | INFO     | [pipeline  :__init__          : 182] | ‚ÑπÔ∏è   Default Augmentation Strategy: AugmentationStrategy.CCSN_MODERATE
2025-05-30 14:17:06 | INFO     | [pipeline  :__init__          : 183] | ‚ÑπÔ∏è   Default Show First Batch Aug: True
2025-05-30 14:17:06 | INFO     | [dataset...:__init__          : 268] | ‚ÑπÔ∏è Using augmentation strategy: AugmentationStrategy.CCSN_MODERATE
2025-05-30 14:17:06 | INFO     | [dataset...:__init__          : 293] | ‚ÑπÔ∏è Detected dataset structure: flat
2025-05-30 14:17:06 | INFO     | [dataset...:_load_paths_and...: 368] | ‚ÑπÔ∏è Scanning FLAT dataset from C:\Users\Stefan Alexandrescu\Documents\GitHub\UBB-Y3-AI-Research\model_src\data\Swimcat-extend...
2025-05-30 14:17:06 | INFO     | [dataset...:__init__          : 313] | ‚ÑπÔ∏è Found 6 classes: A-Clear Sky, B-Patterned Clouds, C-Thin White Clouds, D-Thick White Clouds, E-Thick Dark Clouds, F-Veil Clouds
2025-05-30 14:17:06 | INFO     | [dataset...:__init__          : 316] | ‚ÑπÔ∏è Dataset sizes: 1680 train+val, 420 test. Total: 2100
2025-05-30 14:17:06 | INFO     | [pipeline  :__init__          : 192] | ‚ÑπÔ∏è   Artifact base key prefix for this run: experiments/Swimcat-extend/hvit/20250530_141706_seed42 (using LocalFileSystemRepository)
2025-05-30 14:17:06 | INFO     | [pipeline  :__init__          : 223] | ‚ÑπÔ∏è   Using Optimizer: AdamW
2025-05-30 14:17:06 | DEBUG    | [callbacks :get_default_cal...: 198] | üêû Default LRScheduler callback instance created with policy: ReduceLROnPlateau, kwargs: {'patience': 2, 'mode': 'min', 'factor': 0.1, 'min_lr': 1e-06, 'verbose': False}, monitor: valid_loss
2025-05-30 14:17:06 | INFO     | [pipeline  :__init__          : 266] | ‚ÑπÔ∏è   Model Adapter: Initialized with HybridViT
2025-05-30 14:17:06 | DEBUG    | [executor  :_validate_methods : 152] | üêû Basic method validation successful.
2025-05-30 14:17:06 | INFO     | [executor  :__init__          : 136] | ‚ÑπÔ∏è Executor configured to run methods: cv_model_evaluation
2025-05-30 14:17:06 | INFO     | [executor  :run               : 162] | ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-05-30 14:17:06 | INFO     | [executor  :run               : 166] | ‚ÑπÔ∏è --- Running Method 1/1: cv_model_evaluation (cv_model_evaluation_0) ---
2025-05-30 14:17:06 | DEBUG    | [executor  :run               : 191] | üêû Running with effective parameters: {'params': {'max_epochs': 70, 'lr': 5e-05, 'batch_size': 32, 'optimizer': 'AdamW', 'optimizer__weight_decay': 0.2, 'callbacks__default_lr_scheduler__policy': 'CosineAnnealingLR', 'callbacks__default_lr_scheduler__T_max': 70, 'callbacks__default_lr_scheduler__eta_min': 1e-06, 'callbacks__default_early_stopping__patience': 15, 'criterion__label_smoothing': 0.1, 'module__cnn_extractor_type': 'standard_cnn', 'module__cnn_model_name': 'efficientnet_b0', 'module__cnn_pretrained_imagenet': True, 'module__cnn_output_channels_target': 192, 'module__cnn_freeze_extractor': False, 'module__cnn_num_frozen_stages': 4, 'module__cnn_fine_tuned_weights_path': None, 'module__vit_model_variant': 'vit_b_16', 'module__vit_pretrained_imagenet': True, 'module__unfreeze_strategy': 'encoder_tail', 'module__num_transformer_blocks_to_unfreeze': 2, 'module__unfreeze_cls_token': True, 'module__unfreeze_pos_embedding': True, 'module__unfreeze_patch_embedding': True, 'module__unfreeze_encoder_layernorm': True, 'module__custom_head_hidden_dims': None, 'module__head_dropout_rate': 0.5, 'module__pipeline_img_h': 224, 'module__pipeline_img_w': 224}, 'internal_val_split_ratio': 0.2, 'cv': 5, 'evaluate_on': 'full', 'results_detail_level': 3}
2025-05-30 14:17:06 | INFO     | [pipeline  :cv_model_evalua...:1157] | ‚ÑπÔ∏è Performing 5-fold CV for evaluation with fixed parameters.
2025-05-30 14:17:06 | INFO     | [pipeline  :cv_model_evalua...:1177] | ‚ÑπÔ∏è Using full dataset (2100 samples) for CV evaluation.
2025-05-30 14:17:06 | INFO     | [pipeline  :cv_model_evalua...:1203] | ‚ÑπÔ∏è Using provided parameters for CV evaluation: {'max_epochs': 70, 'lr': 5e-05, 'batch_size': 32, 'optimizer': 'AdamW', 'optimizer__weight_decay': 0.2, 'callbacks__default_lr_scheduler__policy': 'CosineAnnealingLR', 'callbacks__default_lr_scheduler__T_max': 70, 'callbacks__default_lr_scheduler__eta_min': 1e-06, 'callbacks__default_early_stopping__patience': 15, 'criterion__label_smoothing': 0.1, 'module__cnn_extractor_type': 'standard_cnn', 'module__cnn_model_name': 'efficientnet_b0', 'module__cnn_pretrained_imagenet': True, 'module__cnn_output_channels_target': 192, 'module__cnn_freeze_extractor': False, 'module__cnn_num_frozen_stages': 4, 'module__cnn_fine_tuned_weights_path': None, 'module__vit_model_variant': 'vit_b_16', 'module__vit_pretrained_imagenet': True, 'module__unfreeze_strategy': 'encoder_tail', 'module__num_transformer_blocks_to_unfreeze': 2, 'module__unfreeze_cls_token': True, 'module__unfreeze_pos_embedding': True, 'module__unfreeze_patch_embedding': True, 'module__unfreeze_encoder_layernorm': True, 'module__custom_head_hidden_dims': None, 'module__head_dropout_rate': 0.5, 'module__pipeline_img_h': 224, 'module__pipeline_img_w': 224}
2025-05-30 14:17:06 | DEBUG    | [param_g...:parse_fixed_hyp...: 151] | üêû Created LRScheduler instance: policy=CosineAnnealingLR, direct_args={}, constructor_kwargs={'T_max': 70, 'eta_min': 1e-06}
2025-05-30 14:17:06 | INFO     | [pipeline  :cv_model_evalua...:1226] | ‚ÑπÔ∏è Skorch internal validation split configured: 20.0% of each CV fold's training data.
2025-05-30 14:17:06 | DEBUG    | [pipeline  :cv_model_evalua...:1256] | üêû Will compute detailed metrics (detail_level=3, plot_level=2)
2025-05-30 14:17:06 | INFO     | [pipeline  :cv_model_evalua...:1262] | ‚ÑπÔ∏è --- Starting CV Evaluation Fold 1/5 ---
2025-05-30 14:17:06 | DEBUG    | [pipeline  :cv_model_evalua...:1269] | üêû Outer split (full set): 1680 train / 420 test samples.
2025-05-30 14:17:06 | DEBUG    | [pipeline  :cv_model_evalua...:1289] | üêû Fold 1: Internal split: ~1344 train / ~336 valid.
2025-05-30 14:17:06 | INFO     | [pipeline  :cv_model_evalua...:1299] | ‚ÑπÔ∏è Fitting model for fold 1...
2025-05-30 14:17:06 | INFO     | [standar...:__init__          :  48] | ‚ÑπÔ∏è Loaded efficientnet_b0 as feature extractor. Pretrained: True. Natural output channels: 1280
2025-05-30 14:17:06 | INFO     | [standar...:__init__          :  59] | ‚ÑπÔ∏è Added final 1x1 projection: 1280 -> 192 channels.
2025-05-30 14:17:06 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 0 of efficientnet_b0 features.
2025-05-30 14:17:06 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 1 of efficientnet_b0 features.
2025-05-30 14:17:06 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 2 of efficientnet_b0 features.
2025-05-30 14:17:06 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 3 of efficientnet_b0 features.
2025-05-30 14:17:06 | INFO     | [hybrid_...:__init__          :  67] | ‚ÑπÔ∏è Determined CNN feature extractor output size: 7x7 for input 224x224
2025-05-30 14:17:06 | DEBUG    | [pretrai...:__init__          :  38] | üêû Initializing PretrainedViT:
2025-05-30 14:17:06 | DEBUG    | [pretrai...:__init__          :  39] | üêû   Model Variant: vit_b_16, Pretrained: True
2025-05-30 14:17:06 | DEBUG    | [pretrai...:__init__          :  40] | üêû   Is Hybrid Input: True
2025-05-30 14:17:06 | DEBUG    | [pretrai...:__init__          :  42] | üêû   Hybrid In Channels: 192
2025-05-30 14:17:06 | DEBUG    | [pretrai...:__init__          :  43] | üêû   Unfreeze Strategy (Encoder Blocks): encoder_tail
2025-05-30 14:17:06 | DEBUG    | [pretrai...:__init__          :  45] | üêû   Num Transformer Blocks to Unfreeze: 2
2025-05-30 14:17:06 | DEBUG    | [pretrai...:__init__          :  46] | üêû   Unfreeze CLS: True, PosEmb: True, PatchEmb: True, EncoderLN: True
2025-05-30 14:17:06 | DEBUG    | [pretrai...:__init__          :  48] | üêû   Custom Head Hidden Dims: None, Head Dropout: 0.5
2025-05-30 14:17:07 | DEBUG    | [pretrai...:__init__          :  69] | üêû Loaded vit_b_16 from torchvision.
2025-05-30 14:17:07 | INFO     | [pretrai...:__init__          : 101] | ‚ÑπÔ∏è Adapting ViT 'vit_b_16' for hybrid input. Expected CNN feature map: 7x7.
2025-05-30 14:17:07 | INFO     | [pretrai...:__init__          : 110] | ‚ÑπÔ∏è Created hybrid input projection: 192 -> 768 channels.
2025-05-30 14:17:07 | INFO     | [pretrai...:__init__          : 180] | ‚ÑπÔ∏è Interpolating positional embedding in __init__ for hybrid ViT. Original patches: 196, Expected feature patches: 49 (7x7)
2025-05-30 14:17:07 | DEBUG    | [pretrai...:__init__          : 214] | üêû Unfroze custom hybrid input projection layer for ViT.
2025-05-30 14:17:07 | DEBUG    | [pretrai...:__init__          : 313] | üêû Created simple linear head (dropout: 0.5), in_feat=768.
2025-05-30 14:17:07 | INFO     | [pretrai...:__init__          : 323] | ‚ÑπÔ∏è PretrainedViT (hybrid) - Trainable: Hybrid Projection, CLS Token, Positional Embeddings, 2 Encoder Blocks, Encoder LayerNorm, Classification Head.
2025-05-30 14:17:07 | INFO     | [pretrai...:__init__          : 348] | ‚ÑπÔ∏è PretrainedViT (hybrid): Trainable params: 14.52M / Total params: 85.95M (16.89%)
2025-05-30 14:17:07 | DEBUG    | [adapter   :get_split_datasets: 131] | üêû Split created: 1344 train, 336 validation.
2025-05-30 14:17:07 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=1344, batch_size=32, shuffle=True, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 14:17:07 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for training.
2025-05-30 14:17:07 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=336, batch_size=32, shuffle=False, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 14:17:07 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for validation/evaluation.
2025-05-30 14:17:19 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è   epoch    train_acc    train_loss    valid_acc    valid_loss   cp           lr      dur
2025-05-30 14:17:19 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è -------  -----------  ------------  -----------  ------------  ----  ----------  -------
2025-05-30 14:17:19 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       1     ‚ñ≤ 0.5461      ‚ñº 1.3295     ‚ñ≤ 0.8036      ‚ñº 0.8324        4.9975e-05  12.3246
2025-05-30 14:17:29 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       2     ‚ñ≤ 0.8504      ‚ñº 0.7520     ‚ñ≤ 0.8571      ‚ñº 0.7264        4.9901e-05  10.1419
2025-05-30 14:17:39 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       3     ‚ñ≤ 0.9010      ‚ñº 0.6558     ‚ñ≤ 0.8750      ‚ñº 0.6812        4.9778e-05  9.4276
2025-05-30 14:17:49 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       4     ‚ñ≤ 0.9375      ‚ñº 0.5846     ‚ñ≤ 0.8958      ‚ñº 0.6370        4.9606e-05  9.7324
2025-05-30 14:17:58 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       5     ‚ñ≤ 0.9412      ‚ñº 0.5669     ‚ñ≤ 0.9315      ‚ñº 0.5940        4.9386e-05  9.5025
2025-05-30 14:18:08 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       6     ‚ñ≤ 0.9583      ‚ñº 0.5422       0.9137        0.6121        4.9117e-05  9.8575
2025-05-30 14:18:18 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       7       0.9568        0.5448       0.9256        0.6073        4.8801e-05  10.0545
2025-05-30 14:18:28 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       8     ‚ñ≤ 0.9665      ‚ñº 0.5192       0.9226        0.5971        4.8438e-05  9.6718
2025-05-30 14:18:38 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       9       0.9628         0.533       0.9107        0.6106        4.8028e-05  9.8737
2025-05-30 14:18:48 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      10       0.9658      ‚ñº 0.5165     ‚ñ≤ 0.9315      ‚ñº 0.5620        4.7574e-05  9.9435
2025-05-30 14:18:57 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      11     ‚ñ≤ 0.9725      ‚ñº 0.5089     ‚ñ≤ 0.9464      ‚ñº 0.5496        4.7075e-05  9.2406
2025-05-30 14:19:07 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      12       0.9688      ‚ñº 0.5046       0.9375        0.5726        4.6532e-05  10.0516
2025-05-30 14:19:17 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      13        0.971        0.5059     ‚ñ≤ 0.9643      ‚ñº 0.5290        4.5947e-05  10.1684
2025-05-30 14:19:26 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      14     ‚ñ≤ 0.9732      ‚ñº 0.4944     ‚ñ≤ 0.9702      ‚ñº 0.5074        4.5321e-05  9.2262
2025-05-30 14:19:36 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      15     ‚ñ≤ 0.9740      ‚ñº 0.4928       0.9315        0.5627        4.4655e-05  9.8659
2025-05-30 14:19:46 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      16     ‚ñ≤ 0.9814      ‚ñº 0.4772       0.9345        0.5515        4.395e-05  9.9241
2025-05-30 14:19:55 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      17       0.9762        0.4904       0.9167        0.5775        4.3208e-05  9.209
2025-05-30 14:20:05 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      18       0.9732        0.4968       0.9464        0.5478        4.2431e-05  9.9645
2025-05-30 14:20:16 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      19       0.9784         0.484       0.9464        0.5344        4.1619e-05  10.7109
2025-05-30 14:20:27 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      20     ‚ñ≤ 0.9874      ‚ñº 0.4657       0.9464        0.5424        4.0776e-05  10.5411
2025-05-30 14:20:38 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      21       0.9829        0.4731       0.9583        0.5121        3.9901e-05  11.4178
2025-05-30 14:20:49 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      22        0.974        0.4934       0.9464        0.5305        3.8997e-05  10.9013
2025-05-30 14:20:59 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      23     ‚ñ≤ 0.9888      ‚ñº 0.4640       0.9524         0.516        3.8066e-05  10.4476
2025-05-30 14:21:09 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      24       0.9814        0.4718       0.9405         0.544        3.711e-05  9.8255
2025-05-30 14:21:19 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      25       0.9874        0.4643       0.9405        0.5319        3.613e-05  10.2122
2025-05-30 14:21:30 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      26     ‚ñ≤ 0.9911      ‚ñº 0.4591     ‚ñ≤ 0.9702      ‚ñº 0.4981        3.5129e-05  10.2015
2025-05-30 14:21:39 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      27       0.9836        0.4653       0.9643        0.5113        3.4109e-05  9.5048
2025-05-30 14:21:49 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      28       0.9881      ‚ñº 0.4544       0.9643        0.5146        3.3071e-05  10.0945
2025-05-30 14:21:59 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      29     ‚ñ≤ 0.9926      ‚ñº 0.4489       0.9583        0.5107        3.2018e-05  10.2054
2025-05-30 14:22:09 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      30     ‚ñ≤ 0.9926        0.4503       0.9673        0.4982        3.0952e-05  9.7072
2025-05-30 14:22:19 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      31     ‚ñ≤ 0.9940        0.4501       0.9524         0.518        2.9875e-05  10.1958
2025-05-30 14:22:30 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      32       0.9866        0.4572       0.9256        0.5903        2.8789e-05  10.2939
2025-05-30 14:22:39 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      33       0.9866         0.455       0.9673      ‚ñº 0.4941        2.7696e-05  9.6293
2025-05-30 14:22:49 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      34       0.9881        0.4583       0.9524         0.513        2.6599e-05  10.0375
2025-05-30 14:23:00 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      35       0.9911      ‚ñº 0.4477       0.9494         0.517        2.55e-05  10.1777
2025-05-30 14:23:09 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      36     ‚ñ≤ 0.9940      ‚ñº 0.4464     ‚ñ≤ 0.9702      ‚ñº 0.4876        2.4401e-05  9.3971
2025-05-30 14:23:19 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      37       0.9903        0.4485       0.9524        0.5237        2.3304e-05  9.9584
2025-05-30 14:23:29 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      38     ‚ñ≤ 0.9940      ‚ñº 0.4437       0.9524        0.5215        2.2211e-05  10.0493
2025-05-30 14:23:39 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      39       0.9866        0.4552       0.9613        0.4972        2.1125e-05  9.6044
2025-05-30 14:23:49 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      40       0.9911        0.4518       0.9643        0.5016        2.0048e-05  10.0383
2025-05-30 14:23:58 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      41     ‚ñ≤ 0.9940        0.4438       0.9673      ‚ñº 0.4829        1.8982e-05  9.4536
2025-05-30 14:24:08 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      42     ‚ñ≤ 0.9940        0.4441     ‚ñ≤ 0.9792      ‚ñº 0.4775        1.7929e-05  9.998
2025-05-30 14:24:18 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      43     ‚ñ≤ 0.9940        0.4442       0.9762      ‚ñº 0.4701        1.6891e-05  9.9437
2025-05-30 14:24:28 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      44     ‚ñ≤ 0.9940      ‚ñº 0.4431       0.9583        0.4899        1.5871e-05  9.6808
2025-05-30 14:24:38 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      45     ‚ñ≤ 0.9963      ‚ñº 0.4400       0.9762        0.4852        1.487e-05  10.2137
2025-05-30 14:24:48 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      46     ‚ñ≤ 0.9963      ‚ñº 0.4387       0.9554        0.4993        1.389e-05  9.8888
2025-05-30 14:24:57 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      47        0.994         0.441     ‚ñ≤ 0.9792        0.4743        1.2934e-05  9.5582
2025-05-30 14:25:08 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      48       0.9955      ‚ñº 0.4376     ‚ñ≤ 0.9821      ‚ñº 0.4684        1.2003e-05  10.0056
2025-05-30 14:25:17 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      49       0.9911        0.4443     ‚ñ≤ 0.9821         0.473        1.1099e-05  9.7066
2025-05-30 14:25:27 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      50     ‚ñ≤ 0.9963        0.4405     ‚ñ≤ 0.9851      ‚ñº 0.4557        1.0224e-05  9.5081
2025-05-30 14:25:37 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      51       0.9926        0.4467       0.9792        0.4793        9.3805e-06  9.959
2025-05-30 14:25:47 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      52       0.9874        0.4561       0.9673        0.4939        8.569e-06  9.8549
2025-05-30 14:25:56 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      53       0.9948        0.4419       0.9732        0.4825        7.7915e-06  9.3219
2025-05-30 14:26:06 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      54     ‚ñ≤ 0.9985      ‚ñº 0.4348       0.9673        0.4915        7.0497e-06  9.984
2025-05-30 14:26:16 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      55       0.9933        0.4416       0.9643        0.4884        6.3451e-06  9.9744
2025-05-30 14:26:26 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      56       0.9933        0.4429       0.9702        0.4855        5.6791e-06  9.6176
2025-05-30 14:26:36 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      57        0.994         0.447       0.9702        0.4816        5.053e-06  9.9946
2025-05-30 14:26:46 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      58        0.997        0.4389       0.9643        0.5004        4.468e-06  10.1579
2025-05-30 14:26:55 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      59       0.9933        0.4404       0.9702         0.492        3.9254e-06  9.3847
2025-05-30 14:27:05 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      60       0.9963        0.4352       0.9673        0.4878        3.4263e-06  9.9572
2025-05-30 14:27:15 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      61        0.994        0.4423       0.9643        0.4929        2.9716e-06  10.0327
2025-05-30 14:27:25 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      62       0.9963      ‚ñº 0.4338       0.9554        0.5058        2.5622e-06  9.6063
2025-05-30 14:27:35 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      63       0.9948        0.4407       0.9732        0.4808        2.1991e-06  10.2961
2025-05-30 14:27:45 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      64       0.9933         0.441       0.9732        0.4799        1.8829e-06  10.253
2025-05-30 14:27:55 | INFO     | [pipeline  :cv_model_evalua...:1313] | ‚ÑπÔ∏è Using best model from epoch 65
2025-05-30 14:27:55 | INFO     | [pipeline  :cv_model_evalua...:1316] | ‚ÑπÔ∏è Evaluating model on outer test set for fold 1...
2025-05-30 14:27:55 | DEBUG    | [adapter   :get_iterator      : 250] | üêû get_iterator: Wrapping skorch Dataset's X (paths) with PathImageDataset for eval.
2025-05-30 14:27:55 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=420, batch_size=32, shuffle=False, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 14:27:55 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for validation/evaluation.
2025-05-30 14:27:56 | DEBUG    | [adapter   :get_iterator      : 250] | üêû get_iterator: Wrapping skorch Dataset's X (paths) with PathImageDataset for eval.
2025-05-30 14:27:56 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=420, batch_size=32, shuffle=False, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 14:27:56 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for validation/evaluation.
2025-05-30 14:27:57 | DEBUG    | [pipeline  :_compute_metrics  : 443] | üêû Computed Metrics: Acc=0.9714, Macro F1=0.9714
2025-05-30 14:27:57 | INFO     | [pipeline  :cv_model_evalua...:1336] | ‚ÑπÔ∏è Fold 1 Test Scores: Acc=0.9714, F1=0.9714
2025-05-30 14:27:57 | INFO     | [pipeline  :cv_model_evalua...:1262] | ‚ÑπÔ∏è --- Starting CV Evaluation Fold 2/5 ---
2025-05-30 14:27:57 | DEBUG    | [pipeline  :cv_model_evalua...:1269] | üêû Outer split (full set): 1680 train / 420 test samples.
2025-05-30 14:27:57 | DEBUG    | [pipeline  :cv_model_evalua...:1289] | üêû Fold 2: Internal split: ~1344 train / ~336 valid.
2025-05-30 14:27:57 | INFO     | [pipeline  :cv_model_evalua...:1299] | ‚ÑπÔ∏è Fitting model for fold 2...
2025-05-30 14:27:57 | INFO     | [standar...:__init__          :  48] | ‚ÑπÔ∏è Loaded efficientnet_b0 as feature extractor. Pretrained: True. Natural output channels: 1280
2025-05-30 14:27:57 | INFO     | [standar...:__init__          :  59] | ‚ÑπÔ∏è Added final 1x1 projection: 1280 -> 192 channels.
2025-05-30 14:27:57 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 0 of efficientnet_b0 features.
2025-05-30 14:27:57 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 1 of efficientnet_b0 features.
2025-05-30 14:27:57 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 2 of efficientnet_b0 features.
2025-05-30 14:27:57 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 3 of efficientnet_b0 features.
2025-05-30 14:27:57 | INFO     | [hybrid_...:__init__          :  67] | ‚ÑπÔ∏è Determined CNN feature extractor output size: 7x7 for input 224x224
2025-05-30 14:27:57 | DEBUG    | [pretrai...:__init__          :  38] | üêû Initializing PretrainedViT:
2025-05-30 14:27:57 | DEBUG    | [pretrai...:__init__          :  39] | üêû   Model Variant: vit_b_16, Pretrained: True
2025-05-30 14:27:57 | DEBUG    | [pretrai...:__init__          :  40] | üêû   Is Hybrid Input: True
2025-05-30 14:27:57 | DEBUG    | [pretrai...:__init__          :  42] | üêû   Hybrid In Channels: 192
2025-05-30 14:27:57 | DEBUG    | [pretrai...:__init__          :  43] | üêû   Unfreeze Strategy (Encoder Blocks): encoder_tail
2025-05-30 14:27:57 | DEBUG    | [pretrai...:__init__          :  45] | üêû   Num Transformer Blocks to Unfreeze: 2
2025-05-30 14:27:57 | DEBUG    | [pretrai...:__init__          :  46] | üêû   Unfreeze CLS: True, PosEmb: True, PatchEmb: True, EncoderLN: True
2025-05-30 14:27:57 | DEBUG    | [pretrai...:__init__          :  48] | üêû   Custom Head Hidden Dims: None, Head Dropout: 0.5
2025-05-30 14:27:58 | DEBUG    | [pretrai...:__init__          :  69] | üêû Loaded vit_b_16 from torchvision.
2025-05-30 14:27:58 | INFO     | [pretrai...:__init__          : 101] | ‚ÑπÔ∏è Adapting ViT 'vit_b_16' for hybrid input. Expected CNN feature map: 7x7.
2025-05-30 14:27:58 | INFO     | [pretrai...:__init__          : 110] | ‚ÑπÔ∏è Created hybrid input projection: 192 -> 768 channels.
2025-05-30 14:27:58 | INFO     | [pretrai...:__init__          : 180] | ‚ÑπÔ∏è Interpolating positional embedding in __init__ for hybrid ViT. Original patches: 196, Expected feature patches: 49 (7x7)
2025-05-30 14:27:58 | DEBUG    | [pretrai...:__init__          : 214] | üêû Unfroze custom hybrid input projection layer for ViT.
2025-05-30 14:27:58 | DEBUG    | [pretrai...:__init__          : 313] | üêû Created simple linear head (dropout: 0.5), in_feat=768.
2025-05-30 14:27:58 | INFO     | [pretrai...:__init__          : 323] | ‚ÑπÔ∏è PretrainedViT (hybrid) - Trainable: Hybrid Projection, CLS Token, Positional Embeddings, 2 Encoder Blocks, Encoder LayerNorm, Classification Head.
2025-05-30 14:27:58 | INFO     | [pretrai...:__init__          : 348] | ‚ÑπÔ∏è PretrainedViT (hybrid): Trainable params: 14.52M / Total params: 85.95M (16.89%)
2025-05-30 14:27:58 | DEBUG    | [adapter   :get_split_datasets: 131] | üêû Split created: 1344 train, 336 validation.
2025-05-30 14:27:58 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=1344, batch_size=32, shuffle=True, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 14:27:58 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for training.
2025-05-30 14:27:58 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=336, batch_size=32, shuffle=False, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 14:27:58 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for validation/evaluation.
2025-05-30 14:28:11 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è   epoch    train_acc    train_loss    valid_acc    valid_loss   cp           lr      dur
2025-05-30 14:28:11 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è -------  -----------  ------------  -----------  ------------  ----  ----------  -------
2025-05-30 14:28:11 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       1     ‚ñ≤ 0.5603      ‚ñº 1.2975     ‚ñ≤ 0.7649      ‚ñº 0.8742        4.9975e-05  12.6601
2025-05-30 14:28:21 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       2     ‚ñ≤ 0.8624      ‚ñº 0.7339     ‚ñ≤ 0.8750      ‚ñº 0.6991        4.9901e-05  10.329
2025-05-30 14:28:31 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       3     ‚ñ≤ 0.9211      ‚ñº 0.6276     ‚ñ≤ 0.8929      ‚ñº 0.6368        4.9778e-05  10.2222
2025-05-30 14:28:41 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       4     ‚ñ≤ 0.9368      ‚ñº 0.5937     ‚ñ≤ 0.9137      ‚ñº 0.6220        4.9606e-05  9.4333
2025-05-30 14:28:51 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       5     ‚ñ≤ 0.9524      ‚ñº 0.5568     ‚ñ≤ 0.9256      ‚ñº 0.6012        4.9386e-05  10.1012
2025-05-30 14:29:01 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       6     ‚ñ≤ 0.9561      ‚ñº 0.5430     ‚ñ≤ 0.9256      ‚ñº 0.5812        4.9117e-05  10.3336
2025-05-30 14:29:11 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       7     ‚ñ≤ 0.9591        0.5456     ‚ñ≤ 0.9345      ‚ñº 0.5681        4.8801e-05  9.6482
2025-05-30 14:29:21 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       8       0.9576      ‚ñº 0.5354     ‚ñ≤ 0.9375        0.5701        4.8438e-05  9.9977
2025-05-30 14:29:31 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       9     ‚ñ≤ 0.9598      ‚ñº 0.5291       0.9286        0.5834        4.8028e-05  10.1221
2025-05-30 14:29:40 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      10     ‚ñ≤ 0.9702      ‚ñº 0.5019     ‚ñ≤ 0.9375      ‚ñº 0.5423        4.7574e-05  9.5894
2025-05-30 14:29:51 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      11     ‚ñ≤ 0.9769        0.5061     ‚ñ≤ 0.9524      ‚ñº 0.5307        4.7075e-05  10.2734
2025-05-30 14:30:01 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      12       0.9688      ‚ñº 0.5006     ‚ñ≤ 0.9702      ‚ñº 0.5063        4.6532e-05  10.064
2025-05-30 14:30:10 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      13     ‚ñ≤ 0.9784      ‚ñº 0.4813       0.9673        0.5187        4.5947e-05  9.5499
2025-05-30 14:30:21 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      14     ‚ñ≤ 0.9881      ‚ñº 0.4702     ‚ñ≤ 0.9732      ‚ñº 0.4985        4.5321e-05  10.0583
2025-05-30 14:30:31 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      15       0.9762        0.4853       0.9702      ‚ñº 0.4974        4.4655e-05  9.9851
2025-05-30 14:30:40 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      16       0.9814        0.4782       0.9673        0.4998        4.395e-05  9.4419
2025-05-30 14:30:50 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      17       0.9769        0.4857       0.9643        0.5049        4.3208e-05  9.9594
2025-05-30 14:31:00 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      18       0.9874      ‚ñº 0.4664       0.9613        0.5089        4.2431e-05  10.0354
2025-05-30 14:31:09 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      19     ‚ñ≤ 0.9896      ‚ñº 0.4628     ‚ñ≤ 0.9732      ‚ñº 0.4905        4.1619e-05  9.4913
2025-05-30 14:31:19 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      20       0.9844        0.4702       0.9554        0.5105        4.0776e-05  9.7883
2025-05-30 14:31:29 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      21       0.9874        0.4703     ‚ñ≤ 0.9821      ‚ñº 0.4800        3.9901e-05  10.0523
2025-05-30 14:31:39 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      22       0.9799        0.4788       0.9673        0.4977        3.8997e-05  9.528
2025-05-30 14:31:49 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      23       0.9814        0.4731       0.9702      ‚ñº 0.4798        3.8066e-05  9.9125
2025-05-30 14:31:58 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      24     ‚ñ≤ 0.9926      ‚ñº 0.4544       0.9732        0.4825        3.711e-05  9.5835
2025-05-30 14:32:08 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      25       0.9903        0.4581       0.9702         0.502        3.613e-05  9.9353
2025-05-30 14:32:18 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      26       0.9844        0.4625       0.9643         0.503        3.5129e-05  9.9841
2025-05-30 14:32:28 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      27       0.9874         0.461       0.9762        0.4886        3.4109e-05  9.4676
2025-05-30 14:32:38 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      28       0.9896      ‚ñº 0.4535       0.9762        0.4822        3.3071e-05  9.9964
2025-05-30 14:32:48 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      29     ‚ñ≤ 0.9933      ‚ñº 0.4434       0.9673        0.4893        3.2018e-05  10.0377
2025-05-30 14:32:57 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      30       0.9881        0.4547       0.9762        0.4833        3.0952e-05  9.4893
2025-05-30 14:33:08 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      31       0.9903        0.4541       0.9702        0.4814        2.9875e-05  10.2129
2025-05-30 14:33:18 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      32       0.9911        0.4451     ‚ñ≤ 0.9821      ‚ñº 0.4725        2.8789e-05  9.9245
2025-05-30 14:33:27 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      33       0.9911         0.452       0.9792        0.4751        2.7696e-05  9.6317
2025-05-30 14:33:37 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      34       0.9844        0.4567     ‚ñ≤ 0.9821      ‚ñº 0.4701        2.6599e-05  9.8869
2025-05-30 14:33:47 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      35       0.9888        0.4549       0.9732        0.4792        2.55e-05  9.9225
2025-05-30 14:33:57 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      36       0.9918        0.4498     ‚ñ≤ 0.9851      ‚ñº 0.4683        2.4401e-05  9.6202
2025-05-30 14:34:07 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      37       0.9888        0.4478       0.9673        0.4926        2.3304e-05  10.0635
2025-05-30 14:34:17 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      38       0.9874        0.4505       0.9821      ‚ñº 0.4635        2.2211e-05  9.9662
2025-05-30 14:34:26 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      39     ‚ñ≤ 0.9948        0.4437       0.9732        0.4801        2.1125e-05  9.4634
2025-05-30 14:34:36 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      40     ‚ñ≤ 0.9948      ‚ñº 0.4416       0.9732        0.4765        2.0048e-05  10.2283
2025-05-30 14:34:46 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      41     ‚ñ≤ 0.9948        0.4419     ‚ñ≤ 0.9851        0.4654        1.8982e-05  10.0807
2025-05-30 14:34:56 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      42     ‚ñ≤ 0.9955      ‚ñº 0.4373       0.9732        0.4766        1.7929e-05  9.8503
2025-05-30 14:35:07 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      43       0.9926        0.4408       0.9792        0.4708        1.6891e-05  10.2956
2025-05-30 14:35:16 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      44       0.9926         0.445       0.9702        0.4829        1.5871e-05  9.7818
2025-05-30 14:35:26 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      45       0.9926        0.4454     ‚ñ≤ 0.9881      ‚ñº 0.4570        1.487e-05  9.3947
2025-05-30 14:35:36 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      46       0.9933        0.4423       0.9851        0.4639        1.389e-05  10.0652
2025-05-30 14:35:46 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      47     ‚ñ≤ 0.9955          0.44       0.9821        0.4642        1.2934e-05  10.0563
2025-05-30 14:35:56 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      48     ‚ñ≤ 0.9978      ‚ñº 0.4351       0.9732        0.4724        1.2003e-05  9.6018
2025-05-30 14:36:06 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      49       0.9888        0.4486     ‚ñ≤ 0.9881        0.4653        1.1099e-05  9.9908
2025-05-30 14:36:15 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      50       0.9948        0.4401       0.9732        0.4722        1.0224e-05  9.8454
2025-05-30 14:36:25 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      51        0.994        0.4374       0.9851        0.4639        9.3805e-06  9.4084
2025-05-30 14:36:35 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      52       0.9933        0.4428       0.9792        0.4737        8.569e-06  9.7942
2025-05-30 14:36:44 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      53        0.994        0.4405       0.9821         0.467        7.7915e-06  9.7593
2025-05-30 14:36:54 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      54        0.997         0.436     ‚ñ≤ 0.9881        0.4572        7.0497e-06  9.4743
2025-05-30 14:37:04 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      55       0.9963        0.4357     ‚ñ≤ 0.9881        0.4599        6.3451e-06  9.9706
2025-05-30 14:37:13 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      56       0.9911        0.4451     ‚ñ≤ 0.9881        0.4589        5.6791e-06  9.4183
2025-05-30 14:37:23 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      57        0.994        0.4371     ‚ñ≤ 0.9911        0.4598        5.053e-06  10.0673
2025-05-30 14:37:33 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      58       0.9896        0.4455       0.9821         0.465        4.468e-06  10.008
2025-05-30 14:37:43 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      59       0.9918        0.4426       0.9851        0.4585        3.9254e-06  9.2371
2025-05-30 14:37:53 | INFO     | [pipeline  :cv_model_evalua...:1313] | ‚ÑπÔ∏è Using best model from epoch 60
2025-05-30 14:37:53 | INFO     | [pipeline  :cv_model_evalua...:1316] | ‚ÑπÔ∏è Evaluating model on outer test set for fold 2...
2025-05-30 14:37:53 | DEBUG    | [adapter   :get_iterator      : 250] | üêû get_iterator: Wrapping skorch Dataset's X (paths) with PathImageDataset for eval.
2025-05-30 14:37:53 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=420, batch_size=32, shuffle=False, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 14:37:53 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for validation/evaluation.
2025-05-30 14:37:54 | DEBUG    | [adapter   :get_iterator      : 250] | üêû get_iterator: Wrapping skorch Dataset's X (paths) with PathImageDataset for eval.
2025-05-30 14:37:54 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=420, batch_size=32, shuffle=False, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 14:37:54 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for validation/evaluation.
2025-05-30 14:37:55 | DEBUG    | [pipeline  :_compute_metrics  : 443] | üêû Computed Metrics: Acc=0.9810, Macro F1=0.9809
2025-05-30 14:37:55 | INFO     | [pipeline  :cv_model_evalua...:1336] | ‚ÑπÔ∏è Fold 2 Test Scores: Acc=0.9810, F1=0.9809
2025-05-30 14:37:55 | INFO     | [pipeline  :cv_model_evalua...:1262] | ‚ÑπÔ∏è --- Starting CV Evaluation Fold 3/5 ---
2025-05-30 14:37:55 | DEBUG    | [pipeline  :cv_model_evalua...:1269] | üêû Outer split (full set): 1680 train / 420 test samples.
2025-05-30 14:37:55 | DEBUG    | [pipeline  :cv_model_evalua...:1289] | üêû Fold 3: Internal split: ~1344 train / ~336 valid.
2025-05-30 14:37:55 | INFO     | [pipeline  :cv_model_evalua...:1299] | ‚ÑπÔ∏è Fitting model for fold 3...
2025-05-30 14:37:55 | INFO     | [standar...:__init__          :  48] | ‚ÑπÔ∏è Loaded efficientnet_b0 as feature extractor. Pretrained: True. Natural output channels: 1280
2025-05-30 14:37:55 | INFO     | [standar...:__init__          :  59] | ‚ÑπÔ∏è Added final 1x1 projection: 1280 -> 192 channels.
2025-05-30 14:37:55 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 0 of efficientnet_b0 features.
2025-05-30 14:37:55 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 1 of efficientnet_b0 features.
2025-05-30 14:37:55 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 2 of efficientnet_b0 features.
2025-05-30 14:37:55 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 3 of efficientnet_b0 features.
2025-05-30 14:37:55 | INFO     | [hybrid_...:__init__          :  67] | ‚ÑπÔ∏è Determined CNN feature extractor output size: 7x7 for input 224x224
2025-05-30 14:37:55 | DEBUG    | [pretrai...:__init__          :  38] | üêû Initializing PretrainedViT:
2025-05-30 14:37:55 | DEBUG    | [pretrai...:__init__          :  39] | üêû   Model Variant: vit_b_16, Pretrained: True
2025-05-30 14:37:55 | DEBUG    | [pretrai...:__init__          :  40] | üêû   Is Hybrid Input: True
2025-05-30 14:37:55 | DEBUG    | [pretrai...:__init__          :  42] | üêû   Hybrid In Channels: 192
2025-05-30 14:37:55 | DEBUG    | [pretrai...:__init__          :  43] | üêû   Unfreeze Strategy (Encoder Blocks): encoder_tail
2025-05-30 14:37:55 | DEBUG    | [pretrai...:__init__          :  45] | üêû   Num Transformer Blocks to Unfreeze: 2
2025-05-30 14:37:55 | DEBUG    | [pretrai...:__init__          :  46] | üêû   Unfreeze CLS: True, PosEmb: True, PatchEmb: True, EncoderLN: True
2025-05-30 14:37:55 | DEBUG    | [pretrai...:__init__          :  48] | üêû   Custom Head Hidden Dims: None, Head Dropout: 0.5
2025-05-30 14:37:55 | DEBUG    | [pretrai...:__init__          :  69] | üêû Loaded vit_b_16 from torchvision.
2025-05-30 14:37:55 | INFO     | [pretrai...:__init__          : 101] | ‚ÑπÔ∏è Adapting ViT 'vit_b_16' for hybrid input. Expected CNN feature map: 7x7.
2025-05-30 14:37:55 | INFO     | [pretrai...:__init__          : 110] | ‚ÑπÔ∏è Created hybrid input projection: 192 -> 768 channels.
2025-05-30 14:37:55 | INFO     | [pretrai...:__init__          : 180] | ‚ÑπÔ∏è Interpolating positional embedding in __init__ for hybrid ViT. Original patches: 196, Expected feature patches: 49 (7x7)
2025-05-30 14:37:55 | DEBUG    | [pretrai...:__init__          : 214] | üêû Unfroze custom hybrid input projection layer for ViT.
2025-05-30 14:37:55 | DEBUG    | [pretrai...:__init__          : 313] | üêû Created simple linear head (dropout: 0.5), in_feat=768.
2025-05-30 14:37:55 | INFO     | [pretrai...:__init__          : 323] | ‚ÑπÔ∏è PretrainedViT (hybrid) - Trainable: Hybrid Projection, CLS Token, Positional Embeddings, 2 Encoder Blocks, Encoder LayerNorm, Classification Head.
2025-05-30 14:37:55 | INFO     | [pretrai...:__init__          : 348] | ‚ÑπÔ∏è PretrainedViT (hybrid): Trainable params: 14.52M / Total params: 85.95M (16.89%)
2025-05-30 14:37:55 | DEBUG    | [adapter   :get_split_datasets: 131] | üêû Split created: 1344 train, 336 validation.
2025-05-30 14:37:55 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=1344, batch_size=32, shuffle=True, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 14:37:55 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for training.
2025-05-30 14:37:55 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=336, batch_size=32, shuffle=False, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 14:37:55 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for validation/evaluation.
2025-05-30 14:38:08 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è   epoch    train_acc    train_loss    valid_acc    valid_loss   cp           lr    dur
2025-05-30 14:38:08 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è -------  -----------  ------------  -----------  ------------  ----  ----------  -----
2025-05-30 14:38:08 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       1     ‚ñ≤ 0.6004      ‚ñº 1.2505     ‚ñ≤ 0.8155      ‚ñº 0.8328        4.9975e-05  12.59
2025-05-30 14:38:18 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       2     ‚ñ≤ 0.8795      ‚ñº 0.6993     ‚ñ≤ 0.8780      ‚ñº 0.6861        4.9901e-05  9.9695
2025-05-30 14:38:27 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       3     ‚ñ≤ 0.9129      ‚ñº 0.6307     ‚ñ≤ 0.8988      ‚ñº 0.6525        4.9778e-05  9.245
2025-05-30 14:38:37 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       4     ‚ñ≤ 0.9487      ‚ñº 0.5885     ‚ñ≤ 0.9167      ‚ñº 0.6091        4.9606e-05  10.1275
2025-05-30 14:38:48 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       5     ‚ñ≤ 0.9583      ‚ñº 0.5618     ‚ñ≤ 0.9256      ‚ñº 0.5676        4.9386e-05  10.2535
2025-05-30 14:38:58 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       6       0.9546      ‚ñº 0.5409     ‚ñ≤ 0.9315      ‚ñº 0.5583        4.9117e-05  9.8491
2025-05-30 14:39:08 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       7     ‚ñ≤ 0.9621      ‚ñº 0.5278     ‚ñ≤ 0.9435      ‚ñº 0.5495        4.8801e-05  10.0449
2025-05-30 14:39:18 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       8     ‚ñ≤ 0.9717      ‚ñº 0.5167       0.9405      ‚ñº 0.5444        4.8438e-05  9.999
2025-05-30 14:39:27 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       9       0.9613        0.5187     ‚ñ≤ 0.9464      ‚ñº 0.5314        4.8028e-05  9.5313
2025-05-30 14:39:37 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      10     ‚ñ≤ 0.9725      ‚ñº 0.5083     ‚ñ≤ 0.9583      ‚ñº 0.5144        4.7574e-05  10.1427
2025-05-30 14:39:48 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      11       0.9643        0.5129       0.9494         0.519        4.7075e-05  10.1604
2025-05-30 14:39:57 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      12     ‚ñ≤ 0.9747      ‚ñº 0.4935     ‚ñ≤ 0.9643      ‚ñº 0.4941        4.6532e-05  9.4547
2025-05-30 14:40:07 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      13     ‚ñ≤ 0.9814      ‚ñº 0.4873       0.9583        0.5011        4.5947e-05  10.0715
2025-05-30 14:40:17 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      14     ‚ñ≤ 0.9866      ‚ñº 0.4754       0.9583        0.5022        4.5321e-05  9.8658
2025-05-30 14:40:27 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      15       0.9792        0.4832       0.9613      ‚ñº 0.4909        4.4655e-05  9.6462
2025-05-30 14:40:37 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      16       0.9836      ‚ñº 0.4708       0.9524        0.5043        4.395e-05  10.1737
2025-05-30 14:40:47 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      17       0.9829        0.4769     ‚ñ≤ 0.9673      ‚ñº 0.4797        4.3208e-05  10.1838
2025-05-30 14:40:57 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      18       0.9836        0.4715       0.9494        0.5081        4.2431e-05  9.5745
2025-05-30 14:41:07 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      19       0.9792        0.4815     ‚ñ≤ 0.9702        0.4859        4.1619e-05  10.1524
2025-05-30 14:41:17 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      20       0.9859      ‚ñº 0.4656     ‚ñ≤ 0.9702        0.4846        4.0776e-05  10.2159
2025-05-30 14:41:27 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      21     ‚ñ≤ 0.9888      ‚ñº 0.4656     ‚ñ≤ 0.9732        0.4803        3.9901e-05  9.8891
2025-05-30 14:41:37 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      22     ‚ñ≤ 0.9903      ‚ñº 0.4623     ‚ñ≤ 0.9732        0.4896        3.8997e-05  10.2958
2025-05-30 14:41:47 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      23       0.9881      ‚ñº 0.4539     ‚ñ≤ 0.9732        0.4892        3.8066e-05  10.0206
2025-05-30 14:41:57 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      24     ‚ñ≤ 0.9903        0.4544       0.9673      ‚ñº 0.4783        3.711e-05  9.7202
2025-05-30 14:42:07 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      25       0.9844        0.4612       0.9702        0.4793        3.613e-05  10.1722
2025-05-30 14:42:17 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      26       0.9829        0.4661       0.9673        0.4914        3.5129e-05  10.0414
2025-05-30 14:42:27 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      27     ‚ñ≤ 0.9911        0.4565     ‚ñ≤ 0.9821      ‚ñº 0.4715        3.4109e-05  9.774
2025-05-30 14:42:38 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      28       0.9874        0.4581       0.9643        0.5148        3.3071e-05  10.626
2025-05-30 14:42:48 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      29       0.9836        0.4664       0.9732        0.4865        3.2018e-05  10.3139
2025-05-30 14:42:58 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      30       0.9903      ‚ñº 0.4505       0.9702        0.4873        3.0952e-05  9.6691
2025-05-30 14:43:08 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      31       0.9888      ‚ñº 0.4498       0.9702         0.479        2.9875e-05  10.6217
2025-05-30 14:43:18 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      32     ‚ñ≤ 0.9911        0.4535       0.9762        0.4763        2.8789e-05  10.0975
2025-05-30 14:43:28 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      33       0.9866         0.454       0.9613        0.4958        2.7696e-05  9.7313
2025-05-30 14:43:39 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      34     ‚ñ≤ 0.9911          0.45       0.9673        0.4902        2.6599e-05  10.4553
2025-05-30 14:43:49 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      35     ‚ñ≤ 0.9918         0.451       0.9583        0.5066        2.55e-05  10.2789
2025-05-30 14:43:58 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      36     ‚ñ≤ 0.9955      ‚ñº 0.4404       0.9643        0.4987        2.4401e-05  9.6331
2025-05-30 14:44:09 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      37     ‚ñ≤ 0.9963        0.4419       0.9583        0.4991        2.3304e-05  10.041
2025-05-30 14:44:19 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      38       0.9926        0.4491       0.9673        0.4918        2.2211e-05  10.1478
2025-05-30 14:44:28 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      39       0.9926        0.4438       0.9613        0.5122        2.1125e-05  9.6777
2025-05-30 14:44:38 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      40     ‚ñ≤ 0.9978      ‚ñº 0.4365       0.9583        0.5128        2.0048e-05  10.0188
2025-05-30 14:44:49 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      41       0.9911        0.4472       0.9613        0.4958        1.8982e-05  10.1833
2025-05-30 14:44:58 | INFO     | [pipeline  :cv_model_evalua...:1313] | ‚ÑπÔ∏è Using best model from epoch 42
2025-05-30 14:44:58 | INFO     | [pipeline  :cv_model_evalua...:1316] | ‚ÑπÔ∏è Evaluating model on outer test set for fold 3...
2025-05-30 14:44:58 | DEBUG    | [adapter   :get_iterator      : 250] | üêû get_iterator: Wrapping skorch Dataset's X (paths) with PathImageDataset for eval.
2025-05-30 14:44:58 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=420, batch_size=32, shuffle=False, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 14:44:58 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for validation/evaluation.
2025-05-30 14:45:00 | DEBUG    | [adapter   :get_iterator      : 250] | üêû get_iterator: Wrapping skorch Dataset's X (paths) with PathImageDataset for eval.
2025-05-30 14:45:00 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=420, batch_size=32, shuffle=False, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 14:45:00 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for validation/evaluation.
2025-05-30 14:45:01 | DEBUG    | [pipeline  :_compute_metrics  : 443] | üêû Computed Metrics: Acc=0.9690, Macro F1=0.9691
2025-05-30 14:45:01 | INFO     | [pipeline  :cv_model_evalua...:1336] | ‚ÑπÔ∏è Fold 3 Test Scores: Acc=0.9690, F1=0.9691
2025-05-30 14:45:01 | INFO     | [pipeline  :cv_model_evalua...:1262] | ‚ÑπÔ∏è --- Starting CV Evaluation Fold 4/5 ---
2025-05-30 14:45:01 | DEBUG    | [pipeline  :cv_model_evalua...:1269] | üêû Outer split (full set): 1680 train / 420 test samples.
2025-05-30 14:45:01 | DEBUG    | [pipeline  :cv_model_evalua...:1289] | üêû Fold 4: Internal split: ~1344 train / ~336 valid.
2025-05-30 14:45:01 | INFO     | [pipeline  :cv_model_evalua...:1299] | ‚ÑπÔ∏è Fitting model for fold 4...
2025-05-30 14:45:01 | INFO     | [standar...:__init__          :  48] | ‚ÑπÔ∏è Loaded efficientnet_b0 as feature extractor. Pretrained: True. Natural output channels: 1280
2025-05-30 14:45:01 | INFO     | [standar...:__init__          :  59] | ‚ÑπÔ∏è Added final 1x1 projection: 1280 -> 192 channels.
2025-05-30 14:45:01 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 0 of efficientnet_b0 features.
2025-05-30 14:45:01 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 1 of efficientnet_b0 features.
2025-05-30 14:45:01 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 2 of efficientnet_b0 features.
2025-05-30 14:45:01 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 3 of efficientnet_b0 features.
2025-05-30 14:45:01 | INFO     | [hybrid_...:__init__          :  67] | ‚ÑπÔ∏è Determined CNN feature extractor output size: 7x7 for input 224x224
2025-05-30 14:45:01 | DEBUG    | [pretrai...:__init__          :  38] | üêû Initializing PretrainedViT:
2025-05-30 14:45:01 | DEBUG    | [pretrai...:__init__          :  39] | üêû   Model Variant: vit_b_16, Pretrained: True
2025-05-30 14:45:01 | DEBUG    | [pretrai...:__init__          :  40] | üêû   Is Hybrid Input: True
2025-05-30 14:45:01 | DEBUG    | [pretrai...:__init__          :  42] | üêû   Hybrid In Channels: 192
2025-05-30 14:45:01 | DEBUG    | [pretrai...:__init__          :  43] | üêû   Unfreeze Strategy (Encoder Blocks): encoder_tail
2025-05-30 14:45:01 | DEBUG    | [pretrai...:__init__          :  45] | üêû   Num Transformer Blocks to Unfreeze: 2
2025-05-30 14:45:01 | DEBUG    | [pretrai...:__init__          :  46] | üêû   Unfreeze CLS: True, PosEmb: True, PatchEmb: True, EncoderLN: True
2025-05-30 14:45:01 | DEBUG    | [pretrai...:__init__          :  48] | üêû   Custom Head Hidden Dims: None, Head Dropout: 0.5
2025-05-30 14:45:01 | DEBUG    | [pretrai...:__init__          :  69] | üêû Loaded vit_b_16 from torchvision.
2025-05-30 14:45:01 | INFO     | [pretrai...:__init__          : 101] | ‚ÑπÔ∏è Adapting ViT 'vit_b_16' for hybrid input. Expected CNN feature map: 7x7.
2025-05-30 14:45:01 | INFO     | [pretrai...:__init__          : 110] | ‚ÑπÔ∏è Created hybrid input projection: 192 -> 768 channels.
2025-05-30 14:45:01 | INFO     | [pretrai...:__init__          : 180] | ‚ÑπÔ∏è Interpolating positional embedding in __init__ for hybrid ViT. Original patches: 196, Expected feature patches: 49 (7x7)
2025-05-30 14:45:01 | DEBUG    | [pretrai...:__init__          : 214] | üêû Unfroze custom hybrid input projection layer for ViT.
2025-05-30 14:45:01 | DEBUG    | [pretrai...:__init__          : 313] | üêû Created simple linear head (dropout: 0.5), in_feat=768.
2025-05-30 14:45:01 | INFO     | [pretrai...:__init__          : 323] | ‚ÑπÔ∏è PretrainedViT (hybrid) - Trainable: Hybrid Projection, CLS Token, Positional Embeddings, 2 Encoder Blocks, Encoder LayerNorm, Classification Head.
2025-05-30 14:45:01 | INFO     | [pretrai...:__init__          : 348] | ‚ÑπÔ∏è PretrainedViT (hybrid): Trainable params: 14.52M / Total params: 85.95M (16.89%)
2025-05-30 14:45:01 | DEBUG    | [adapter   :get_split_datasets: 131] | üêû Split created: 1344 train, 336 validation.
2025-05-30 14:45:01 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=1344, batch_size=32, shuffle=True, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 14:45:01 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for training.
2025-05-30 14:45:01 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=336, batch_size=32, shuffle=False, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 14:45:01 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for validation/evaluation.
2025-05-30 14:45:13 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è   epoch    train_acc    train_loss    valid_acc    valid_loss   cp           lr      dur
2025-05-30 14:45:13 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è -------  -----------  ------------  -----------  ------------  ----  ----------  -------
2025-05-30 14:45:13 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       1     ‚ñ≤ 0.5744      ‚ñº 1.3002     ‚ñ≤ 0.8244      ‚ñº 0.7893        4.9975e-05  11.8351
2025-05-30 14:45:23 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       2     ‚ñ≤ 0.8743      ‚ñº 0.7119     ‚ñ≤ 0.8661      ‚ñº 0.7128        4.9901e-05  9.911
2025-05-30 14:45:33 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       3     ‚ñ≤ 0.9204      ‚ñº 0.6386     ‚ñ≤ 0.8899      ‚ñº 0.6632        4.9778e-05  10.0463
2025-05-30 14:45:43 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       4     ‚ñ≤ 0.9256      ‚ñº 0.6112     ‚ñ≤ 0.9167      ‚ñº 0.6030        4.9606e-05  9.5475
2025-05-30 14:45:53 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       5     ‚ñ≤ 0.9442      ‚ñº 0.5700     ‚ñ≤ 0.9315        0.6068        4.9386e-05  10.083
2025-05-30 14:46:03 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       6     ‚ñ≤ 0.9546      ‚ñº 0.5486     ‚ñ≤ 0.9315      ‚ñº 0.5684        4.9117e-05  10.0233
2025-05-30 14:46:13 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       7     ‚ñ≤ 0.9554      ‚ñº 0.5418       0.9286        0.5902        4.8801e-05  9.5205
2025-05-30 14:46:23 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       8     ‚ñ≤ 0.9717      ‚ñº 0.5145     ‚ñ≤ 0.9524      ‚ñº 0.5565        4.8438e-05  9.917
2025-05-30 14:46:33 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       9        0.968        0.5201     ‚ñ≤ 0.9673      ‚ñº 0.5144        4.8028e-05  10.3494
2025-05-30 14:46:42 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      10     ‚ñ≤ 0.9747      ‚ñº 0.5073       0.9494        0.5386        4.7574e-05  9.5662
2025-05-30 14:46:53 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      11     ‚ñ≤ 0.9814      ‚ñº 0.4845     ‚ñ≤ 0.9732      ‚ñº 0.5003        4.7075e-05  10.1899
2025-05-30 14:47:03 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      12        0.974        0.4916       0.9643        0.5152        4.6532e-05  10.2614
2025-05-30 14:47:13 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      13       0.9732        0.4956       0.9315        0.5758        4.5947e-05  9.5807
2025-05-30 14:47:22 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      14       0.9777         0.489       0.9345        0.5668        4.5321e-05  9.8634
2025-05-30 14:47:33 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      15     ‚ñ≤ 0.9836      ‚ñº 0.4807       0.9643        0.5261        4.4655e-05  10.1409
2025-05-30 14:47:42 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      16       0.9769        0.4826       0.9613        0.5123        4.395e-05  9.2996
2025-05-30 14:47:52 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      17       0.9777      ‚ñº 0.4771       0.9673        0.5081        4.3208e-05  10.1753
2025-05-30 14:48:02 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      18       0.9814      ‚ñº 0.4763       0.9405        0.5463        4.2431e-05  10.1158
2025-05-30 14:48:12 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      19     ‚ñ≤ 0.9896      ‚ñº 0.4602       0.9702        0.5107        4.1619e-05  9.5214
2025-05-30 14:48:22 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      20       0.9836        0.4671       0.9613        0.5184        4.0776e-05  10.0413
2025-05-30 14:48:32 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      21       0.9829        0.4686       0.9583        0.5109        3.9901e-05  10.0338
2025-05-30 14:48:41 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      22     ‚ñ≤ 0.9903      ‚ñº 0.4599       0.9494        0.5209        3.8997e-05  9.4901
2025-05-30 14:48:52 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      23       0.9881      ‚ñº 0.4586       0.9643        0.5151        3.8066e-05  10.3799
2025-05-30 14:49:02 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      24     ‚ñ≤ 0.9903      ‚ñº 0.4527       0.9673        0.5142        3.711e-05  10.2044
2025-05-30 14:49:11 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      25     ‚ñ≤ 0.9911        0.4532       0.9702        0.5004        3.613e-05  9.3738
2025-05-30 14:49:21 | INFO     | [pipeline  :cv_model_evalua...:1313] | ‚ÑπÔ∏è Using best model from epoch 26
2025-05-30 14:49:21 | INFO     | [pipeline  :cv_model_evalua...:1316] | ‚ÑπÔ∏è Evaluating model on outer test set for fold 4...
2025-05-30 14:49:21 | DEBUG    | [adapter   :get_iterator      : 250] | üêû get_iterator: Wrapping skorch Dataset's X (paths) with PathImageDataset for eval.
2025-05-30 14:49:21 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=420, batch_size=32, shuffle=False, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 14:49:21 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for validation/evaluation.
2025-05-30 14:49:22 | DEBUG    | [adapter   :get_iterator      : 250] | üêû get_iterator: Wrapping skorch Dataset's X (paths) with PathImageDataset for eval.
2025-05-30 14:49:22 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=420, batch_size=32, shuffle=False, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 14:49:22 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for validation/evaluation.
2025-05-30 14:49:23 | DEBUG    | [pipeline  :_compute_metrics  : 443] | üêû Computed Metrics: Acc=0.9619, Macro F1=0.9615
2025-05-30 14:49:23 | INFO     | [pipeline  :cv_model_evalua...:1336] | ‚ÑπÔ∏è Fold 4 Test Scores: Acc=0.9619, F1=0.9615
2025-05-30 14:49:23 | INFO     | [pipeline  :cv_model_evalua...:1262] | ‚ÑπÔ∏è --- Starting CV Evaluation Fold 5/5 ---
2025-05-30 14:49:23 | DEBUG    | [pipeline  :cv_model_evalua...:1269] | üêû Outer split (full set): 1680 train / 420 test samples.
2025-05-30 14:49:23 | DEBUG    | [pipeline  :cv_model_evalua...:1289] | üêû Fold 5: Internal split: ~1344 train / ~336 valid.
2025-05-30 14:49:23 | INFO     | [pipeline  :cv_model_evalua...:1299] | ‚ÑπÔ∏è Fitting model for fold 5...
2025-05-30 14:49:23 | INFO     | [standar...:__init__          :  48] | ‚ÑπÔ∏è Loaded efficientnet_b0 as feature extractor. Pretrained: True. Natural output channels: 1280
2025-05-30 14:49:23 | INFO     | [standar...:__init__          :  59] | ‚ÑπÔ∏è Added final 1x1 projection: 1280 -> 192 channels.
2025-05-30 14:49:23 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 0 of efficientnet_b0 features.
2025-05-30 14:49:23 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 1 of efficientnet_b0 features.
2025-05-30 14:49:23 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 2 of efficientnet_b0 features.
2025-05-30 14:49:23 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 3 of efficientnet_b0 features.
2025-05-30 14:49:23 | INFO     | [hybrid_...:__init__          :  67] | ‚ÑπÔ∏è Determined CNN feature extractor output size: 7x7 for input 224x224
2025-05-30 14:49:23 | DEBUG    | [pretrai...:__init__          :  38] | üêû Initializing PretrainedViT:
2025-05-30 14:49:23 | DEBUG    | [pretrai...:__init__          :  39] | üêû   Model Variant: vit_b_16, Pretrained: True
2025-05-30 14:49:23 | DEBUG    | [pretrai...:__init__          :  40] | üêû   Is Hybrid Input: True
2025-05-30 14:49:23 | DEBUG    | [pretrai...:__init__          :  42] | üêû   Hybrid In Channels: 192
2025-05-30 14:49:23 | DEBUG    | [pretrai...:__init__          :  43] | üêû   Unfreeze Strategy (Encoder Blocks): encoder_tail
2025-05-30 14:49:23 | DEBUG    | [pretrai...:__init__          :  45] | üêû   Num Transformer Blocks to Unfreeze: 2
2025-05-30 14:49:23 | DEBUG    | [pretrai...:__init__          :  46] | üêû   Unfreeze CLS: True, PosEmb: True, PatchEmb: True, EncoderLN: True
2025-05-30 14:49:23 | DEBUG    | [pretrai...:__init__          :  48] | üêû   Custom Head Hidden Dims: None, Head Dropout: 0.5
2025-05-30 14:49:24 | DEBUG    | [pretrai...:__init__          :  69] | üêû Loaded vit_b_16 from torchvision.
2025-05-30 14:49:24 | INFO     | [pretrai...:__init__          : 101] | ‚ÑπÔ∏è Adapting ViT 'vit_b_16' for hybrid input. Expected CNN feature map: 7x7.
2025-05-30 14:49:24 | INFO     | [pretrai...:__init__          : 110] | ‚ÑπÔ∏è Created hybrid input projection: 192 -> 768 channels.
2025-05-30 14:49:24 | INFO     | [pretrai...:__init__          : 180] | ‚ÑπÔ∏è Interpolating positional embedding in __init__ for hybrid ViT. Original patches: 196, Expected feature patches: 49 (7x7)
2025-05-30 14:49:24 | DEBUG    | [pretrai...:__init__          : 214] | üêû Unfroze custom hybrid input projection layer for ViT.
2025-05-30 14:49:24 | DEBUG    | [pretrai...:__init__          : 313] | üêû Created simple linear head (dropout: 0.5), in_feat=768.
2025-05-30 14:49:24 | INFO     | [pretrai...:__init__          : 323] | ‚ÑπÔ∏è PretrainedViT (hybrid) - Trainable: Hybrid Projection, CLS Token, Positional Embeddings, 2 Encoder Blocks, Encoder LayerNorm, Classification Head.
2025-05-30 14:49:24 | INFO     | [pretrai...:__init__          : 348] | ‚ÑπÔ∏è PretrainedViT (hybrid): Trainable params: 14.52M / Total params: 85.95M (16.89%)
2025-05-30 14:49:24 | DEBUG    | [adapter   :get_split_datasets: 131] | üêû Split created: 1344 train, 336 validation.
2025-05-30 14:49:24 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=1344, batch_size=32, shuffle=True, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 14:49:24 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for training.
2025-05-30 14:49:24 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=336, batch_size=32, shuffle=False, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 14:49:24 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for validation/evaluation.
2025-05-30 14:49:37 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è   epoch    train_acc    train_loss    valid_acc    valid_loss   cp           lr      dur
2025-05-30 14:49:37 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è -------  -----------  ------------  -----------  ------------  ----  ----------  -------
2025-05-30 14:49:37 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       1     ‚ñ≤ 0.5677      ‚ñº 1.2926     ‚ñ≤ 0.8333      ‚ñº 0.7996        4.9975e-05  13.1082
2025-05-30 14:49:47 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       2     ‚ñ≤ 0.8802      ‚ñº 0.7074     ‚ñ≤ 0.8869      ‚ñº 0.6510        4.9901e-05  10.2062
2025-05-30 14:49:56 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       3     ‚ñ≤ 0.9353      ‚ñº 0.5980     ‚ñ≤ 0.9137      ‚ñº 0.6255        4.9778e-05  9.1463
2025-05-30 14:50:06 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       4     ‚ñ≤ 0.9427      ‚ñº 0.5790       0.9018        0.6344        4.9606e-05  10.0855
2025-05-30 14:50:16 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       5     ‚ñ≤ 0.9531      ‚ñº 0.5709     ‚ñ≤ 0.9226      ‚ñº 0.5884        4.9386e-05  10.0302
2025-05-30 14:50:26 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       6     ‚ñ≤ 0.9613      ‚ñº 0.5334       0.9167        0.5944        4.9117e-05  9.7118
2025-05-30 14:50:36 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       7       0.9501        0.5444     ‚ñ≤ 0.9464      ‚ñº 0.5552        4.8801e-05  10.1611
2025-05-30 14:50:46 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       8       0.9606      ‚ñº 0.5301       0.9375      ‚ñº 0.5501        4.8438e-05  10.0683
2025-05-30 14:50:56 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       9     ‚ñ≤ 0.9688      ‚ñº 0.5117       0.9048        0.6038        4.8028e-05  9.7998
2025-05-30 14:51:07 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      10     ‚ñ≤ 0.9710      ‚ñº 0.5057       0.9107        0.6048        4.7574e-05  10.3522
2025-05-30 14:51:17 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      11        0.965      ‚ñº 0.5025       0.9435      ‚ñº 0.5379        4.7075e-05  10.2392
2025-05-30 14:51:27 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      12     ‚ñ≤ 0.9732      ‚ñº 0.4933       0.9405        0.5597        4.6532e-05  9.9131
2025-05-30 14:51:37 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      13     ‚ñ≤ 0.9799      ‚ñº 0.4853     ‚ñ≤ 0.9464        0.5395        4.5947e-05  10.3162
2025-05-30 14:51:47 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      14     ‚ñ≤ 0.9807         0.488       0.9315        0.5743        4.5321e-05  10.1531
2025-05-30 14:51:57 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      15     ‚ñ≤ 0.9859      ‚ñº 0.4765       0.9405        0.5641        4.4655e-05  9.6194
2025-05-30 14:52:07 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      16       0.9754        0.4816     ‚ñ≤ 0.9494        0.5434        4.395e-05  10.0733
2025-05-30 14:52:17 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      17     ‚ñ≤ 0.9926      ‚ñº 0.4592     ‚ñ≤ 0.9583      ‚ñº 0.5296        4.3208e-05  9.9934
2025-05-30 14:52:27 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      18     ‚ñ≤ 0.9940      ‚ñº 0.4537       0.9524        0.5399        4.2431e-05  9.7524
2025-05-30 14:52:37 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      19       0.9866        0.4739       0.9464        0.5665        4.1619e-05  10.1442
2025-05-30 14:52:47 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      20       0.9829        0.4695       0.9554        0.5394        4.0776e-05  9.8573
2025-05-30 14:52:56 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      21       0.9814        0.4684     ‚ñ≤ 0.9613      ‚ñº 0.5124        3.9901e-05  9.4824
2025-05-30 14:53:06 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      22       0.9903        0.4566       0.9524        0.5217        3.8997e-05  10.0538
2025-05-30 14:53:16 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      23       0.9807        0.4713       0.9583        0.5215        3.8066e-05  9.8396
2025-05-30 14:53:26 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      24       0.9829        0.4631       0.9524        0.5483        3.711e-05  9.6216
2025-05-30 14:53:36 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      25       0.9866        0.4608       0.9554        0.5126        3.613e-05  9.9769
2025-05-30 14:53:46 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      26       0.9933      ‚ñº 0.4499       0.9524        0.5344        3.5129e-05  9.9845
2025-05-30 14:53:55 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      27       0.9918      ‚ñº 0.4478       0.9583        0.5254        3.4109e-05  9.6631
2025-05-30 14:54:05 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      28       0.9926      ‚ñº 0.4463       0.9583         0.531        3.3071e-05  10.0717
2025-05-30 14:54:16 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      29       0.9903        0.4541       0.9554        0.5454        3.2018e-05  10.043
2025-05-30 14:54:25 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      30     ‚ñ≤ 0.9955      ‚ñº 0.4443     ‚ñ≤ 0.9613        0.5485        3.0952e-05  9.7132
2025-05-30 14:54:36 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      31       0.9948      ‚ñº 0.4393       0.9554        0.5451        2.9875e-05  10.2413
2025-05-30 14:54:46 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      32       0.9948        0.4445       0.9375         0.567        2.8789e-05  10.2267
2025-05-30 14:54:55 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      33       0.9926         0.446     ‚ñ≤ 0.9613        0.5246        2.7696e-05  9.3271
2025-05-30 14:55:05 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      34       0.9911        0.4479       0.9583        0.5156        2.6599e-05  10.1076
2025-05-30 14:55:15 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      35       0.9874        0.4538     ‚ñ≤ 0.9613        0.5414        2.55e-05  9.9908
2025-05-30 14:55:25 | INFO     | [pipeline  :cv_model_evalua...:1313] | ‚ÑπÔ∏è Using best model from epoch 36
2025-05-30 14:55:25 | INFO     | [pipeline  :cv_model_evalua...:1316] | ‚ÑπÔ∏è Evaluating model on outer test set for fold 5...
2025-05-30 14:55:25 | DEBUG    | [adapter   :get_iterator      : 250] | üêû get_iterator: Wrapping skorch Dataset's X (paths) with PathImageDataset for eval.
2025-05-30 14:55:25 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=420, batch_size=32, shuffle=False, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 14:55:25 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for validation/evaluation.
2025-05-30 14:55:26 | DEBUG    | [adapter   :get_iterator      : 250] | üêû get_iterator: Wrapping skorch Dataset's X (paths) with PathImageDataset for eval.
2025-05-30 14:55:26 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=420, batch_size=32, shuffle=False, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 14:55:26 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for validation/evaluation.
2025-05-30 14:55:27 | DEBUG    | [pipeline  :_compute_metrics  : 443] | üêû Computed Metrics: Acc=0.9786, Macro F1=0.9785
2025-05-30 14:55:27 | INFO     | [pipeline  :cv_model_evalua...:1336] | ‚ÑπÔ∏è Fold 5 Test Scores: Acc=0.9786, F1=0.9785
2025-05-30 14:55:27 | DEBUG    | [pipeline  :_save_results     : 463] | üêû Results detail level overridden for this run to: 3
2025-05-30 14:55:27 | DEBUG    | [pipeline  :_save_results     : 471] | üêû Saving results for cv_model_evaluation_full_141706 (detail level: 3)
2025-05-30 14:55:27 | INFO     | [pipeline  :_save_results     : 580] | ‚ÑπÔ∏è Results JSON saved via repository to: experiments/Swimcat-extend/hvit/20250530_141706_seed42/cv_model_evaluation_full_141706/cv_model_evaluation_results.json
2025-05-30 14:55:27 | INFO     | [pipeline  :cv_model_evalua...:1454] | ‚ÑπÔ∏è Plotting cv for eval results for cv_model_evaluation_full_141706 (plot level 2).
2025-05-30 14:55:27 | INFO     | [plotter   :plot_cv_model_e...: 854] | ‚ÑπÔ∏è Plotting cv_model_evaluation results for: cv_model_evaluation_full_141706
2025-05-30 14:55:27 | INFO     | [plotter   :_generate_aggre...: 301] | ‚ÑπÔ∏è Aggregated metrics CSV saved via repository to: experiments/Swimcat-extend/hvit/20250530_141706_seed42/cv_model_evaluation_full_141706/cv_model_evaluation_plots/aggregated_metrics_table.csv
2025-05-30 14:55:29 | INFO     | [plotter   :plot_cv_model_e...: 910] | ‚ÑπÔ∏è Generating grouped plots per fold for 5 folds...
2025-05-30 14:55:36 | INFO     | [plotter   :_generate_metri...: 246] | ‚ÑπÔ∏è Metrics CSV saved via repository to: experiments/Swimcat-extend/hvit/20250530_141706_seed42/cv_model_evaluation_full_141706/cv_model_evaluation_plots/fold_1_metrics_table.csv
2025-05-30 14:55:36 | INFO     | [plotter   :_generate_metri...: 246] | ‚ÑπÔ∏è Metrics CSV saved via repository to: experiments/Swimcat-extend/hvit/20250530_141706_seed42/cv_model_evaluation_full_141706/cv_model_evaluation_plots/fold_2_metrics_table.csv
2025-05-30 14:55:36 | INFO     | [plotter   :_generate_metri...: 246] | ‚ÑπÔ∏è Metrics CSV saved via repository to: experiments/Swimcat-extend/hvit/20250530_141706_seed42/cv_model_evaluation_full_141706/cv_model_evaluation_plots/fold_3_metrics_table.csv
2025-05-30 14:55:36 | INFO     | [plotter   :_generate_metri...: 246] | ‚ÑπÔ∏è Metrics CSV saved via repository to: experiments/Swimcat-extend/hvit/20250530_141706_seed42/cv_model_evaluation_full_141706/cv_model_evaluation_plots/fold_4_metrics_table.csv
2025-05-30 14:55:36 | INFO     | [plotter   :_generate_metri...: 246] | ‚ÑπÔ∏è Metrics CSV saved via repository to: experiments/Swimcat-extend/hvit/20250530_141706_seed42/cv_model_evaluation_full_141706/cv_model_evaluation_plots/fold_5_metrics_table.csv
2025-05-30 14:55:36 | INFO     | [plotter   :plot_cv_model_e...:1061] | ‚ÑπÔ∏è Finished plotting for cv_model_evaluation: cv_model_evaluation_full_141706
2025-05-30 14:55:36 | INFO     | [pipeline  :cv_model_evalua...:1470] | ‚ÑπÔ∏è CV Evaluation Summary (on full data, 5 folds, 95% CI):
2025-05-30 14:55:36 | INFO     | [pipeline  :cv_model_evalua...:1476] | ‚ÑπÔ∏è   Accuracy            : 0.9724 +/- 0.0095
2025-05-30 14:55:36 | INFO     | [pipeline  :cv_model_evalua...:1476] | ‚ÑπÔ∏è   F1 Macro            : 0.9723 +/- 0.0097
2025-05-30 14:55:36 | INFO     | [pipeline  :cv_model_evalua...:1476] | ‚ÑπÔ∏è   Precision Macro     : 0.9735 +/- 0.0093
2025-05-30 14:55:36 | INFO     | [pipeline  :cv_model_evalua...:1476] | ‚ÑπÔ∏è   Recall Macro        : 0.9724 +/- 0.0095
2025-05-30 14:55:36 | INFO     | [pipeline  :cv_model_evalua...:1476] | ‚ÑπÔ∏è   Specificity Macro   : 0.9945 +/- 0.0019
2025-05-30 14:55:36 | INFO     | [pipeline  :cv_model_evalua...:1476] | ‚ÑπÔ∏è   Roc Auc Macro       : 0.9981 +/- 0.0012
2025-05-30 14:55:36 | INFO     | [pipeline  :cv_model_evalua...:1476] | ‚ÑπÔ∏è   Pr Auc Macro        : 0.9883 +/- 0.0032
2025-05-30 14:55:36 | INFO     | [executor  :run               : 198] | ‚ÑπÔ∏è --- Method cv_model_evaluation (cv_model_evaluation_0) completed successfully in 2309.56s ---
2025-05-30 14:55:36 | INFO     | [executor  :run               : 217] | ‚ÑπÔ∏è Pipeline execution finished in 2309.56s.
2025-05-30 14:55:36 | INFO     | [executor  :run               : 313] | ‚ÑπÔ∏è Final log file available at: C:\Users\Stefan Alexandrescu\Documents\GitHub\UBB-Y3-AI-Research\model_src\experiments\Swimcat-extend\hvit\20250530_141706_seed42\experiment_run_20250530_141706_seed42.log
2025-05-30 14:55:36 | INFO     | [main      :<module>          : 310] | ‚ÑπÔ∏è --- Final Execution Results Summary ---
2025-05-30 14:55:36 | INFO     | [main      :<module>          : 319] | ‚ÑπÔ∏è Method cv_model_evaluation_0: Completed. (Acc: 0.9724, F1: 0.9723, BestScore: nan)
