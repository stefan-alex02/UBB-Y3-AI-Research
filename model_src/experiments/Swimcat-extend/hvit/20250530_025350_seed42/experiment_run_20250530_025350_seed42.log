Timestamp           | Level    | Location                             | Message
--------------------+----------+--------------------------------------+---------------------------------------------------
2025-05-30 02:53:50 | INFO     | [logger_...:setup_logger      : 153] | ‚ÑπÔ∏è Logger 'ImgClassPipe' initialized. Log file: C:\Users\Stefan Alexandrescu\Documents\GitHub\UBB-Y3-AI-Research\model_src\experiments\Swimcat-extend\hvit\20250530_025350_seed42\experiment_run_20250530_025350_seed42.log
2025-05-30 02:53:50 | INFO     | [executor  :__init__          : 100] | ‚ÑπÔ∏è --- Starting Experiment Run (ID: 20250530_025350_seed42) ---
2025-05-30 02:53:50 | INFO     | [executor  :__init__          : 101] | ‚ÑπÔ∏è Executor initialized for model 'hvit' on dataset 'Swimcat-extend'
2025-05-30 02:53:50 | INFO     | [executor  :__init__          : 104] | ‚ÑπÔ∏è Local artifact storage base: C:\Users\Stefan Alexandrescu\Documents\GitHub\UBB-Y3-AI-Research\model_src
2025-05-30 02:53:50 | INFO     | [executor  :__init__          : 108] | ‚ÑπÔ∏è Base key/prefix for this run's artifacts: experiments/Swimcat-extend/hvit/20250530_025350_seed42
2025-05-30 02:53:50 | INFO     | [executor  :__init__          : 110] | ‚ÑπÔ∏è Local log file for this run (might be temporary): C:\Users\Stefan Alexandrescu\Documents\GitHub\UBB-Y3-AI-Research\model_src\experiments\Swimcat-extend\hvit\20250530_025350_seed42\experiment_run_20250530_025350_seed42.log
2025-05-30 02:53:50 | INFO     | [pipeline  :__init__          : 173] | ‚ÑπÔ∏è Initializing Classification Pipeline:
2025-05-30 02:53:50 | INFO     | [pipeline  :__init__          : 174] | ‚ÑπÔ∏è   Dataset Path: C:\Users\Stefan Alexandrescu\Documents\GitHub\UBB-Y3-AI-Research\model_src\data\Swimcat-extend
2025-05-30 02:53:50 | INFO     | [pipeline  :__init__          : 175] | ‚ÑπÔ∏è   Model Type: hvit
2025-05-30 02:53:50 | INFO     | [pipeline  :__init__          : 178] | ‚ÑπÔ∏è   Artifact base key prefix for this run: experiments/Swimcat-extend/hvit/20250530_025350_seed42 (using LocalFileSystemRepository)
2025-05-30 02:53:50 | INFO     | [pipeline  :__init__          : 182] | ‚ÑπÔ∏è   Default Augmentation Strategy: AugmentationStrategy.PAPER_CCSN
2025-05-30 02:53:50 | INFO     | [pipeline  :__init__          : 183] | ‚ÑπÔ∏è   Default Show First Batch Aug: True
2025-05-30 02:53:50 | INFO     | [dataset...:__init__          : 277] | ‚ÑπÔ∏è Using augmentation strategy: AugmentationStrategy.PAPER_CCSN
2025-05-30 02:53:50 | INFO     | [dataset...:__init__          : 302] | ‚ÑπÔ∏è Detected dataset structure: flat
2025-05-30 02:53:50 | INFO     | [dataset...:_load_paths_and...: 377] | ‚ÑπÔ∏è Scanning FLAT dataset from C:\Users\Stefan Alexandrescu\Documents\GitHub\UBB-Y3-AI-Research\model_src\data\Swimcat-extend...
2025-05-30 02:53:50 | INFO     | [dataset...:__init__          : 322] | ‚ÑπÔ∏è Found 6 classes: A-Clear Sky, B-Patterned Clouds, C-Thin White Clouds, D-Thick White Clouds, E-Thick Dark Clouds, F-Veil Clouds
2025-05-30 02:53:50 | INFO     | [dataset...:__init__          : 325] | ‚ÑπÔ∏è Dataset sizes: 1680 train+val, 420 test. Total: 2100
2025-05-30 02:53:50 | INFO     | [pipeline  :__init__          : 192] | ‚ÑπÔ∏è   Artifact base key prefix for this run: experiments/Swimcat-extend/hvit/20250530_025350_seed42 (using LocalFileSystemRepository)
2025-05-30 02:53:50 | INFO     | [pipeline  :__init__          : 223] | ‚ÑπÔ∏è   Using Optimizer: AdamW
2025-05-30 02:53:50 | DEBUG    | [callbacks :get_default_cal...: 198] | üêû Default LRScheduler callback instance created with policy: ReduceLROnPlateau, kwargs: {'patience': 2, 'mode': 'min', 'factor': 0.1, 'min_lr': 1e-06, 'verbose': False}, monitor: valid_loss
2025-05-30 02:53:50 | INFO     | [pipeline  :__init__          : 266] | ‚ÑπÔ∏è   Model Adapter: Initialized with HybridViT
2025-05-30 02:53:50 | DEBUG    | [executor  :_validate_methods : 152] | üêû Basic method validation successful.
2025-05-30 02:53:50 | INFO     | [executor  :__init__          : 136] | ‚ÑπÔ∏è Executor configured to run methods: cv_model_evaluation
2025-05-30 02:53:50 | INFO     | [executor  :run               : 162] | ‚ÑπÔ∏è Starting execution of pipeline methods...
2025-05-30 02:53:50 | INFO     | [executor  :run               : 166] | ‚ÑπÔ∏è --- Running Method 1/1: cv_model_evaluation (cv_model_evaluation_0) ---
2025-05-30 02:53:50 | DEBUG    | [executor  :run               : 191] | üêû Running with effective parameters: {'params': {'max_epochs': 70, 'lr': 5e-05, 'batch_size': 32, 'optimizer': 'AdamW', 'optimizer__weight_decay': 0.2, 'callbacks__default_lr_scheduler__policy': 'CosineAnnealingLR', 'callbacks__default_lr_scheduler__T_max': 70, 'callbacks__default_lr_scheduler__eta_min': 1e-06, 'callbacks__default_early_stopping__patience': 15, 'criterion__label_smoothing': 0.1, 'module__cnn_extractor_type': 'standard_cnn', 'module__cnn_model_name': 'efficientnet_b0', 'module__cnn_pretrained_imagenet': True, 'module__cnn_output_channels_target': 192, 'module__cnn_freeze_extractor': False, 'module__cnn_num_frozen_stages': 4, 'module__cnn_fine_tuned_weights_path': None, 'module__vit_model_variant': 'vit_b_16', 'module__vit_pretrained_imagenet': True, 'module__unfreeze_strategy': 'encoder_tail', 'module__num_transformer_blocks_to_unfreeze': 2, 'module__unfreeze_cls_token': True, 'module__unfreeze_pos_embedding': True, 'module__unfreeze_patch_embedding': True, 'module__unfreeze_encoder_layernorm': True, 'module__custom_head_hidden_dims': None, 'module__head_dropout_rate': 0.5, 'module__pipeline_img_h': 224, 'module__pipeline_img_w': 224}, 'internal_val_split_ratio': 0.2, 'cv': 5, 'evaluate_on': 'full', 'results_detail_level': 3}
2025-05-30 02:53:50 | INFO     | [pipeline  :cv_model_evalua...:1157] | ‚ÑπÔ∏è Performing 5-fold CV for evaluation with fixed parameters.
2025-05-30 02:53:50 | INFO     | [pipeline  :cv_model_evalua...:1177] | ‚ÑπÔ∏è Using full dataset (2100 samples) for CV evaluation.
2025-05-30 02:53:50 | INFO     | [pipeline  :cv_model_evalua...:1203] | ‚ÑπÔ∏è Using provided parameters for CV evaluation: {'max_epochs': 70, 'lr': 5e-05, 'batch_size': 32, 'optimizer': 'AdamW', 'optimizer__weight_decay': 0.2, 'callbacks__default_lr_scheduler__policy': 'CosineAnnealingLR', 'callbacks__default_lr_scheduler__T_max': 70, 'callbacks__default_lr_scheduler__eta_min': 1e-06, 'callbacks__default_early_stopping__patience': 15, 'criterion__label_smoothing': 0.1, 'module__cnn_extractor_type': 'standard_cnn', 'module__cnn_model_name': 'efficientnet_b0', 'module__cnn_pretrained_imagenet': True, 'module__cnn_output_channels_target': 192, 'module__cnn_freeze_extractor': False, 'module__cnn_num_frozen_stages': 4, 'module__cnn_fine_tuned_weights_path': None, 'module__vit_model_variant': 'vit_b_16', 'module__vit_pretrained_imagenet': True, 'module__unfreeze_strategy': 'encoder_tail', 'module__num_transformer_blocks_to_unfreeze': 2, 'module__unfreeze_cls_token': True, 'module__unfreeze_pos_embedding': True, 'module__unfreeze_patch_embedding': True, 'module__unfreeze_encoder_layernorm': True, 'module__custom_head_hidden_dims': None, 'module__head_dropout_rate': 0.5, 'module__pipeline_img_h': 224, 'module__pipeline_img_w': 224}
2025-05-30 02:53:50 | DEBUG    | [param_g...:parse_fixed_hyp...: 151] | üêû Created LRScheduler instance: policy=CosineAnnealingLR, direct_args={}, constructor_kwargs={'T_max': 70, 'eta_min': 1e-06}
2025-05-30 02:53:50 | INFO     | [pipeline  :cv_model_evalua...:1226] | ‚ÑπÔ∏è Skorch internal validation split configured: 20.0% of each CV fold's training data.
2025-05-30 02:53:50 | DEBUG    | [pipeline  :cv_model_evalua...:1256] | üêû Will compute detailed metrics (detail_level=3, plot_level=2)
2025-05-30 02:53:50 | INFO     | [pipeline  :cv_model_evalua...:1262] | ‚ÑπÔ∏è --- Starting CV Evaluation Fold 1/5 ---
2025-05-30 02:53:50 | DEBUG    | [pipeline  :cv_model_evalua...:1269] | üêû Outer split (full set): 1680 train / 420 test samples.
2025-05-30 02:53:50 | DEBUG    | [pipeline  :cv_model_evalua...:1289] | üêû Fold 1: Internal split: ~1344 train / ~336 valid.
2025-05-30 02:53:50 | INFO     | [pipeline  :cv_model_evalua...:1299] | ‚ÑπÔ∏è Fitting model for fold 1...
2025-05-30 02:53:50 | INFO     | [standar...:__init__          :  48] | ‚ÑπÔ∏è Loaded efficientnet_b0 as feature extractor. Pretrained: True. Natural output channels: 1280
2025-05-30 02:53:50 | INFO     | [standar...:__init__          :  59] | ‚ÑπÔ∏è Added final 1x1 projection: 1280 -> 192 channels.
2025-05-30 02:53:50 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 0 of efficientnet_b0 features.
2025-05-30 02:53:50 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 1 of efficientnet_b0 features.
2025-05-30 02:53:50 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 2 of efficientnet_b0 features.
2025-05-30 02:53:50 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 3 of efficientnet_b0 features.
2025-05-30 02:53:50 | INFO     | [hybrid_...:__init__          :  67] | ‚ÑπÔ∏è Determined CNN feature extractor output size: 7x7 for input 224x224
2025-05-30 02:53:50 | DEBUG    | [pretrai...:__init__          :  38] | üêû Initializing PretrainedViT:
2025-05-30 02:53:50 | DEBUG    | [pretrai...:__init__          :  39] | üêû   Model Variant: vit_b_16, Pretrained: True
2025-05-30 02:53:50 | DEBUG    | [pretrai...:__init__          :  40] | üêû   Is Hybrid Input: True
2025-05-30 02:53:50 | DEBUG    | [pretrai...:__init__          :  42] | üêû   Hybrid In Channels: 192
2025-05-30 02:53:50 | DEBUG    | [pretrai...:__init__          :  43] | üêû   Unfreeze Strategy (Encoder Blocks): encoder_tail
2025-05-30 02:53:50 | DEBUG    | [pretrai...:__init__          :  45] | üêû   Num Transformer Blocks to Unfreeze: 2
2025-05-30 02:53:50 | DEBUG    | [pretrai...:__init__          :  46] | üêû   Unfreeze CLS: True, PosEmb: True, PatchEmb: True, EncoderLN: True
2025-05-30 02:53:50 | DEBUG    | [pretrai...:__init__          :  48] | üêû   Custom Head Hidden Dims: None, Head Dropout: 0.5
2025-05-30 02:53:51 | DEBUG    | [pretrai...:__init__          :  69] | üêû Loaded vit_b_16 from torchvision.
2025-05-30 02:53:51 | INFO     | [pretrai...:__init__          : 101] | ‚ÑπÔ∏è Adapting ViT 'vit_b_16' for hybrid input. Expected CNN feature map: 7x7.
2025-05-30 02:53:51 | INFO     | [pretrai...:__init__          : 110] | ‚ÑπÔ∏è Created hybrid input projection: 192 -> 768 channels.
2025-05-30 02:53:51 | INFO     | [pretrai...:__init__          : 180] | ‚ÑπÔ∏è Interpolating positional embedding in __init__ for hybrid ViT. Original patches: 196, Expected feature patches: 49 (7x7)
2025-05-30 02:53:51 | DEBUG    | [pretrai...:__init__          : 214] | üêû Unfroze custom hybrid input projection layer for ViT.
2025-05-30 02:53:51 | DEBUG    | [pretrai...:__init__          : 313] | üêû Created simple linear head (dropout: 0.5), in_feat=768.
2025-05-30 02:53:51 | INFO     | [pretrai...:__init__          : 323] | ‚ÑπÔ∏è PretrainedViT (hybrid) - Trainable: Hybrid Projection, CLS Token, Positional Embeddings, 2 Encoder Blocks, Encoder LayerNorm, Classification Head.
2025-05-30 02:53:51 | INFO     | [pretrai...:__init__          : 348] | ‚ÑπÔ∏è PretrainedViT (hybrid): Trainable params: 14.52M / Total params: 85.95M (16.89%)
2025-05-30 02:53:51 | DEBUG    | [adapter   :get_split_datasets: 131] | üêû Split created: 1344 train, 336 validation.
2025-05-30 02:53:51 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=1344, batch_size=32, shuffle=True, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 02:53:51 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for training.
2025-05-30 02:53:51 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=336, batch_size=32, shuffle=False, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 02:53:51 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for validation/evaluation.
2025-05-30 02:54:02 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è   epoch    train_acc    train_loss    valid_acc    valid_loss   cp           lr      dur
2025-05-30 02:54:02 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è -------  -----------  ------------  -----------  ------------  ----  ----------  -------
2025-05-30 02:54:02 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       1     ‚ñ≤ 0.5565      ‚ñº 1.3257     ‚ñ≤ 0.8036      ‚ñº 0.8582        4.9975e-05  11.1223
2025-05-30 02:54:10 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       2     ‚ñ≤ 0.8579      ‚ñº 0.7568     ‚ñ≤ 0.9315      ‚ñº 0.6216        4.9901e-05  7.945
2025-05-30 02:54:18 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       3     ‚ñ≤ 0.9122      ‚ñº 0.6449     ‚ñ≤ 0.9583      ‚ñº 0.5722        4.9778e-05  7.8835
2025-05-30 02:54:26 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       4     ‚ñ≤ 0.9301      ‚ñº 0.6111       0.9494      ‚ñº 0.5721        4.9606e-05  7.797
2025-05-30 02:54:34 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       5     ‚ñ≤ 0.9472      ‚ñº 0.5700     ‚ñ≤ 0.9583      ‚ñº 0.5399        4.9386e-05  8.2897
2025-05-30 02:54:42 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       6     ‚ñ≤ 0.9613      ‚ñº 0.5433     ‚ñ≤ 0.9673      ‚ñº 0.5276        4.9117e-05  8.098
2025-05-30 02:54:50 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       7       0.9546        0.5474     ‚ñ≤ 0.9762      ‚ñº 0.5093        4.8801e-05  7.6276
2025-05-30 02:54:58 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       8       0.9554      ‚ñº 0.5400       0.9673        0.5116        4.8438e-05  7.7412
2025-05-30 02:55:05 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       9     ‚ñ≤ 0.9702      ‚ñº 0.5128       0.9702      ‚ñº 0.5086        4.8028e-05  7.8014
2025-05-30 02:55:13 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      10       0.9606        0.5278       0.9732      ‚ñº 0.4912        4.7574e-05  7.6292
2025-05-30 02:55:21 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      11     ‚ñ≤ 0.9732      ‚ñº 0.5063     ‚ñ≤ 0.9792      ‚ñº 0.4891        4.7075e-05  7.5332
2025-05-30 02:55:28 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      12     ‚ñ≤ 0.9821      ‚ñº 0.4846     ‚ñ≤ 0.9792      ‚ñº 0.4722        4.6532e-05  7.8259
2025-05-30 02:55:36 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      13       0.9777        0.4943     ‚ñ≤ 0.9821        0.4747        4.5947e-05  7.8094
2025-05-30 02:55:44 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      14     ‚ñ≤ 0.9821      ‚ñº 0.4788     ‚ñ≤ 0.9881      ‚ñº 0.4619        4.5321e-05  7.8231
2025-05-30 02:55:52 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      15       0.9799         0.488       0.9762         0.476        4.4655e-05  7.5961
2025-05-30 02:55:59 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      16       0.9792      ‚ñº 0.4779       0.9851        0.4679        4.395e-05  7.6747
2025-05-30 02:56:07 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      17     ‚ñ≤ 0.9859      ‚ñº 0.4701       0.9851        0.4665        4.3208e-05  7.5545
2025-05-30 02:56:14 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      18       0.9844        0.4719       0.9762        0.4769        4.2431e-05  7.5036
2025-05-30 02:56:22 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      19       0.9814        0.4749       0.9851        0.4661        4.1619e-05  7.8624
2025-05-30 02:56:30 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      20       0.9807         0.473       0.9851      ‚ñº 0.4610        4.0776e-05  7.768
2025-05-30 02:56:38 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      21       0.9844      ‚ñº 0.4658     ‚ñ≤ 0.9881        0.4618        3.9901e-05  7.6857
2025-05-30 02:56:45 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      22     ‚ñ≤ 0.9881      ‚ñº 0.4602       0.9821         0.466        3.8997e-05  7.4765
2025-05-30 02:56:53 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      23     ‚ñ≤ 0.9903      ‚ñº 0.4571     ‚ñ≤ 0.9881        0.4616        3.8066e-05  7.5771
2025-05-30 02:57:01 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      24     ‚ñ≤ 0.9911      ‚ñº 0.4500     ‚ñ≤ 0.9881      ‚ñº 0.4586        3.711e-05  7.6073
2025-05-30 02:57:08 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      25       0.9866        0.4677       0.9821        0.4611        3.613e-05  7.635
2025-05-30 02:57:16 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      26       0.9851        0.4639     ‚ñ≤ 0.9881      ‚ñº 0.4523        3.5129e-05  7.6151
2025-05-30 02:57:23 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      27       0.9888        0.4598       0.9821        0.4605        3.4109e-05  7.6471
2025-05-30 02:57:31 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      28       0.9896        0.4566     ‚ñ≤ 0.9911      ‚ñº 0.4432        3.3071e-05  7.5891
2025-05-30 02:57:39 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      29       0.9881      ‚ñº 0.4495       0.9821         0.455        3.2018e-05  7.6294
2025-05-30 02:57:46 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      30       0.9888        0.4534     ‚ñ≤ 0.9911         0.445        3.0952e-05  7.7342
2025-05-30 02:57:54 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      31       0.9903        0.4539       0.9851        0.4543        2.9875e-05  8.0613
2025-05-30 02:58:02 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      32     ‚ñ≤ 0.9955      ‚ñº 0.4443     ‚ñ≤ 0.9911        0.4456        2.8789e-05  7.6458
2025-05-30 02:58:10 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      33       0.9903         0.453       0.9881        0.4529        2.7696e-05  7.5894
2025-05-30 02:58:17 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      34     ‚ñ≤ 0.9955        0.4461       0.9881        0.4497        2.6599e-05  7.5841
2025-05-30 02:58:25 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      35       0.9903        0.4511     ‚ñ≤ 0.9911        0.4465        2.55e-05  7.7421
2025-05-30 02:58:33 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      36       0.9933         0.445     ‚ñ≤ 0.9911         0.448        2.4401e-05  7.7192
2025-05-30 02:58:40 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      37       0.9903        0.4474       0.9881         0.451        2.3304e-05  7.5796
2025-05-30 02:58:48 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      38       0.9881        0.4541     ‚ñ≤ 0.9911        0.4502        2.2211e-05  7.6811
2025-05-30 02:58:56 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      39       0.9926         0.446       0.9851        0.4553        2.1125e-05  7.632
2025-05-30 02:59:03 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      40        0.994      ‚ñº 0.4419       0.9881        0.4556        2.0048e-05  7.5878
2025-05-30 02:59:11 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      41     ‚ñ≤ 0.9955        0.4421     ‚ñ≤ 0.9911        0.4506        1.8982e-05  7.5973
2025-05-30 02:59:18 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      42       0.9903        0.4482       0.9851        0.4621        1.7929e-05  7.5056
2025-05-30 02:59:26 | INFO     | [pipeline  :cv_model_evalua...:1313] | ‚ÑπÔ∏è Using best model from epoch 43
2025-05-30 02:59:26 | INFO     | [pipeline  :cv_model_evalua...:1316] | ‚ÑπÔ∏è Evaluating model on outer test set for fold 1...
2025-05-30 02:59:26 | DEBUG    | [adapter   :get_iterator      : 250] | üêû get_iterator: Wrapping skorch Dataset's X (paths) with PathImageDataset for eval.
2025-05-30 02:59:26 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=420, batch_size=32, shuffle=False, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 02:59:26 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for validation/evaluation.
2025-05-30 02:59:27 | DEBUG    | [adapter   :get_iterator      : 250] | üêû get_iterator: Wrapping skorch Dataset's X (paths) with PathImageDataset for eval.
2025-05-30 02:59:27 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=420, batch_size=32, shuffle=False, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 02:59:27 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for validation/evaluation.
2025-05-30 02:59:28 | DEBUG    | [pipeline  :_compute_metrics  : 443] | üêû Computed Metrics: Acc=0.9881, Macro F1=0.9881
2025-05-30 02:59:28 | INFO     | [pipeline  :cv_model_evalua...:1336] | ‚ÑπÔ∏è Fold 1 Test Scores: Acc=0.9881, F1=0.9881
2025-05-30 02:59:28 | INFO     | [pipeline  :cv_model_evalua...:1262] | ‚ÑπÔ∏è --- Starting CV Evaluation Fold 2/5 ---
2025-05-30 02:59:28 | DEBUG    | [pipeline  :cv_model_evalua...:1269] | üêû Outer split (full set): 1680 train / 420 test samples.
2025-05-30 02:59:28 | DEBUG    | [pipeline  :cv_model_evalua...:1289] | üêû Fold 2: Internal split: ~1344 train / ~336 valid.
2025-05-30 02:59:28 | INFO     | [pipeline  :cv_model_evalua...:1299] | ‚ÑπÔ∏è Fitting model for fold 2...
2025-05-30 02:59:28 | INFO     | [standar...:__init__          :  48] | ‚ÑπÔ∏è Loaded efficientnet_b0 as feature extractor. Pretrained: True. Natural output channels: 1280
2025-05-30 02:59:28 | INFO     | [standar...:__init__          :  59] | ‚ÑπÔ∏è Added final 1x1 projection: 1280 -> 192 channels.
2025-05-30 02:59:28 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 0 of efficientnet_b0 features.
2025-05-30 02:59:28 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 1 of efficientnet_b0 features.
2025-05-30 02:59:28 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 2 of efficientnet_b0 features.
2025-05-30 02:59:28 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 3 of efficientnet_b0 features.
2025-05-30 02:59:28 | INFO     | [hybrid_...:__init__          :  67] | ‚ÑπÔ∏è Determined CNN feature extractor output size: 7x7 for input 224x224
2025-05-30 02:59:28 | DEBUG    | [pretrai...:__init__          :  38] | üêû Initializing PretrainedViT:
2025-05-30 02:59:28 | DEBUG    | [pretrai...:__init__          :  39] | üêû   Model Variant: vit_b_16, Pretrained: True
2025-05-30 02:59:28 | DEBUG    | [pretrai...:__init__          :  40] | üêû   Is Hybrid Input: True
2025-05-30 02:59:28 | DEBUG    | [pretrai...:__init__          :  42] | üêû   Hybrid In Channels: 192
2025-05-30 02:59:28 | DEBUG    | [pretrai...:__init__          :  43] | üêû   Unfreeze Strategy (Encoder Blocks): encoder_tail
2025-05-30 02:59:28 | DEBUG    | [pretrai...:__init__          :  45] | üêû   Num Transformer Blocks to Unfreeze: 2
2025-05-30 02:59:28 | DEBUG    | [pretrai...:__init__          :  46] | üêû   Unfreeze CLS: True, PosEmb: True, PatchEmb: True, EncoderLN: True
2025-05-30 02:59:28 | DEBUG    | [pretrai...:__init__          :  48] | üêû   Custom Head Hidden Dims: None, Head Dropout: 0.5
2025-05-30 02:59:29 | DEBUG    | [pretrai...:__init__          :  69] | üêû Loaded vit_b_16 from torchvision.
2025-05-30 02:59:29 | INFO     | [pretrai...:__init__          : 101] | ‚ÑπÔ∏è Adapting ViT 'vit_b_16' for hybrid input. Expected CNN feature map: 7x7.
2025-05-30 02:59:29 | INFO     | [pretrai...:__init__          : 110] | ‚ÑπÔ∏è Created hybrid input projection: 192 -> 768 channels.
2025-05-30 02:59:29 | INFO     | [pretrai...:__init__          : 180] | ‚ÑπÔ∏è Interpolating positional embedding in __init__ for hybrid ViT. Original patches: 196, Expected feature patches: 49 (7x7)
2025-05-30 02:59:29 | DEBUG    | [pretrai...:__init__          : 214] | üêû Unfroze custom hybrid input projection layer for ViT.
2025-05-30 02:59:29 | DEBUG    | [pretrai...:__init__          : 313] | üêû Created simple linear head (dropout: 0.5), in_feat=768.
2025-05-30 02:59:29 | INFO     | [pretrai...:__init__          : 323] | ‚ÑπÔ∏è PretrainedViT (hybrid) - Trainable: Hybrid Projection, CLS Token, Positional Embeddings, 2 Encoder Blocks, Encoder LayerNorm, Classification Head.
2025-05-30 02:59:29 | INFO     | [pretrai...:__init__          : 348] | ‚ÑπÔ∏è PretrainedViT (hybrid): Trainable params: 14.52M / Total params: 85.95M (16.89%)
2025-05-30 02:59:29 | DEBUG    | [adapter   :get_split_datasets: 131] | üêû Split created: 1344 train, 336 validation.
2025-05-30 02:59:29 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=1344, batch_size=32, shuffle=True, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 02:59:29 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for training.
2025-05-30 02:59:29 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=336, batch_size=32, shuffle=False, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 02:59:29 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for validation/evaluation.
2025-05-30 02:59:39 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è   epoch    train_acc    train_loss    valid_acc    valid_loss   cp           lr      dur
2025-05-30 02:59:39 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è -------  -----------  ------------  -----------  ------------  ----  ----------  -------
2025-05-30 02:59:39 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       1     ‚ñ≤ 0.5379      ‚ñº 1.3170     ‚ñ≤ 0.8333      ‚ñº 0.8305        4.9975e-05  10.3982
2025-05-30 02:59:47 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       2     ‚ñ≤ 0.8549      ‚ñº 0.7489     ‚ñ≤ 0.8661      ‚ñº 0.6970        4.9901e-05  7.8025
2025-05-30 02:59:55 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       3     ‚ñ≤ 0.9159      ‚ñº 0.6356     ‚ñ≤ 0.9286      ‚ñº 0.6015        4.9778e-05  7.8791
2025-05-30 03:00:03 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       4     ‚ñ≤ 0.9375      ‚ñº 0.5973     ‚ñ≤ 0.9435      ‚ñº 0.5588        4.9606e-05  7.8097
2025-05-30 03:00:10 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       5     ‚ñ≤ 0.9561      ‚ñº 0.5528       0.9345        0.5685        4.9386e-05  7.691
2025-05-30 03:00:18 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       6       0.9554      ‚ñº 0.5490     ‚ñ≤ 0.9554      ‚ñº 0.5279        4.9117e-05  7.623
2025-05-30 03:00:26 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       7     ‚ñ≤ 0.9680      ‚ñº 0.5344     ‚ñ≤ 0.9643        0.5308        4.8801e-05  7.6112
2025-05-30 03:00:33 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       8       0.9621      ‚ñº 0.5283     ‚ñ≤ 0.9643      ‚ñº 0.5111        4.8438e-05  7.6128
2025-05-30 03:00:41 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       9     ‚ñ≤ 0.9777      ‚ñº 0.5069       0.9613      ‚ñº 0.5101        4.8028e-05  7.6818
2025-05-30 03:00:49 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      10     ‚ñ≤ 0.9777      ‚ñº 0.5031     ‚ñ≤ 0.9792      ‚ñº 0.4801        4.7574e-05  7.688
2025-05-30 03:00:56 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      11       0.9673        0.5045     ‚ñ≤ 0.9792        0.4882        4.7075e-05  7.6563
2025-05-30 03:01:04 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      12       0.9762      ‚ñº 0.4904       0.9732        0.4807        4.6532e-05  7.6034
2025-05-30 03:01:12 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      13       0.9717        0.5017     ‚ñ≤ 0.9821      ‚ñº 0.4726        4.5947e-05  7.6472
2025-05-30 03:01:19 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      14     ‚ñ≤ 0.9836      ‚ñº 0.4800       0.9792      ‚ñº 0.4686        4.5321e-05  7.6239
2025-05-30 03:01:27 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      15       0.9784      ‚ñº 0.4784     ‚ñ≤ 0.9821        0.4728        4.4655e-05  7.7133
2025-05-30 03:01:35 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      16       0.9829      ‚ñº 0.4748     ‚ñ≤ 0.9851      ‚ñº 0.4666        4.395e-05  7.6388
2025-05-30 03:01:42 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      17       0.9799        0.4912       0.9821        0.4687        4.3208e-05  7.5513
2025-05-30 03:01:50 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      18     ‚ñ≤ 0.9859      ‚ñº 0.4701       0.9732        0.4731        4.2431e-05  7.6225
2025-05-30 03:01:58 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      19       0.9777         0.483     ‚ñ≤ 0.9851      ‚ñº 0.4659        4.1619e-05  7.6278
2025-05-30 03:02:05 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      20     ‚ñ≤ 0.9926      ‚ñº 0.4573     ‚ñ≤ 0.9851      ‚ñº 0.4544        4.0776e-05  7.6295
2025-05-30 03:02:13 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      21     ‚ñ≤ 0.9926      ‚ñº 0.4551     ‚ñ≤ 0.9940      ‚ñº 0.4499        3.9901e-05  7.4883
2025-05-30 03:02:20 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      22     ‚ñ≤ 0.9926      ‚ñº 0.4544       0.9851        0.4592        3.8997e-05  7.5642
2025-05-30 03:02:28 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      23       0.9918      ‚ñº 0.4497       0.9911        0.4505        3.8066e-05  7.8724
2025-05-30 03:02:36 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      24       0.9881        0.4541     ‚ñ≤ 0.9940      ‚ñº 0.4459        3.711e-05  7.5249
2025-05-30 03:02:43 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      25       0.9918        0.4552       0.9911        0.4524        3.613e-05  7.6409
2025-05-30 03:02:51 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      26       0.9903         0.454       0.9881        0.4547        3.5129e-05  7.6369
2025-05-30 03:02:59 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      27       0.9859        0.4605     ‚ñ≤ 0.9940         0.448        3.4109e-05  7.5777
2025-05-30 03:03:06 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      28     ‚ñ≤ 0.9933        0.4509       0.9851        0.4552        3.3071e-05  7.6842
2025-05-30 03:03:14 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      29     ‚ñ≤ 0.9940      ‚ñº 0.4470       0.9911        0.4532        3.2018e-05  7.5824
2025-05-30 03:03:21 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      30       0.9896        0.4532       0.9911        0.4489        3.0952e-05  7.5342
2025-05-30 03:03:29 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      31       0.9933        0.4472       0.9881        0.4513        2.9875e-05  7.9002
2025-05-30 03:03:37 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      32       0.9918      ‚ñº 0.4434       0.9911          0.45        2.8789e-05  7.503
2025-05-30 03:03:44 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      33       0.9926        0.4449       0.9881        0.4497        2.7696e-05  7.5622
2025-05-30 03:03:52 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      34       0.9896        0.4525       0.9911        0.4477        2.6599e-05  7.5489
2025-05-30 03:04:00 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      35       0.9903        0.4508       0.9911        0.4508        2.55e-05  7.5684
2025-05-30 03:04:07 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      36     ‚ñ≤ 0.9948      ‚ñº 0.4400       0.9851         0.457        2.4401e-05  7.5433
2025-05-30 03:04:15 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      37       0.9903        0.4473       0.9911      ‚ñº 0.4456        2.3304e-05  7.9055
2025-05-30 03:04:23 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      38     ‚ñ≤ 0.9948         0.442       0.9851        0.4493        2.2211e-05  7.7819
2025-05-30 03:04:30 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      39     ‚ñ≤ 0.9963      ‚ñº 0.4379       0.9881        0.4535        2.1125e-05  7.5593
2025-05-30 03:04:38 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      40       0.9955        0.4403       0.9911        0.4472        2.0048e-05  7.6176
2025-05-30 03:04:46 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      41       0.9918        0.4457       0.9851        0.4539        1.8982e-05  7.6373
2025-05-30 03:04:53 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      42     ‚ñ≤ 0.9970         0.438       0.9881      ‚ñº 0.4428        1.7929e-05  7.5733
2025-05-30 03:05:01 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      43       0.9933        0.4426     ‚ñ≤ 0.9940        0.4429        1.6891e-05  7.6687
2025-05-30 03:05:09 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      44       0.9955         0.441       0.9881        0.4442        1.5871e-05  7.9917
2025-05-30 03:05:16 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      45        0.994        0.4415       0.9881        0.4497        1.487e-05  7.6044
2025-05-30 03:05:24 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      46     ‚ñ≤ 0.9970      ‚ñº 0.4340       0.9911        0.4496        1.389e-05  7.5333
2025-05-30 03:05:32 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      47       0.9926        0.4425       0.9911        0.4448        1.2934e-05  7.6333
2025-05-30 03:05:39 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      48     ‚ñ≤ 0.9970        0.4347       0.9881        0.4505        1.2003e-05  7.5496
2025-05-30 03:05:47 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      49     ‚ñ≤ 0.9978      ‚ñº 0.4333       0.9881        0.4534        1.1099e-05  7.6207
2025-05-30 03:05:55 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      50     ‚ñ≤ 0.9978        0.4343       0.9851        0.4499        1.0224e-05  7.7915
2025-05-30 03:06:02 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      51     ‚ñ≤ 0.9978      ‚ñº 0.4322       0.9881        0.4519        9.3805e-06  7.725
2025-05-30 03:06:10 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      52       0.9963        0.4344       0.9851        0.4546        8.569e-06  7.6555
2025-05-30 03:06:18 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      53       0.9948        0.4381       0.9881        0.4517        7.7915e-06  7.6016
2025-05-30 03:06:25 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      54       0.9948        0.4369       0.9821         0.455        7.0497e-06  7.5987
2025-05-30 03:06:33 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      55     ‚ñ≤ 0.9985        0.4327       0.9851        0.4538        6.3451e-06  7.5442
2025-05-30 03:06:40 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      56       0.9963        0.4342       0.9911         0.447        5.6791e-06  7.6649
2025-05-30 03:06:48 | INFO     | [pipeline  :cv_model_evalua...:1313] | ‚ÑπÔ∏è Using best model from epoch 57
2025-05-30 03:06:48 | INFO     | [pipeline  :cv_model_evalua...:1316] | ‚ÑπÔ∏è Evaluating model on outer test set for fold 2...
2025-05-30 03:06:48 | DEBUG    | [adapter   :get_iterator      : 250] | üêû get_iterator: Wrapping skorch Dataset's X (paths) with PathImageDataset for eval.
2025-05-30 03:06:48 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=420, batch_size=32, shuffle=False, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 03:06:48 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for validation/evaluation.
2025-05-30 03:06:49 | DEBUG    | [adapter   :get_iterator      : 250] | üêû get_iterator: Wrapping skorch Dataset's X (paths) with PathImageDataset for eval.
2025-05-30 03:06:49 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=420, batch_size=32, shuffle=False, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 03:06:49 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for validation/evaluation.
2025-05-30 03:06:50 | DEBUG    | [pipeline  :_compute_metrics  : 443] | üêû Computed Metrics: Acc=0.9905, Macro F1=0.9905
2025-05-30 03:06:50 | INFO     | [pipeline  :cv_model_evalua...:1336] | ‚ÑπÔ∏è Fold 2 Test Scores: Acc=0.9905, F1=0.9905
2025-05-30 03:06:50 | INFO     | [pipeline  :cv_model_evalua...:1262] | ‚ÑπÔ∏è --- Starting CV Evaluation Fold 3/5 ---
2025-05-30 03:06:50 | DEBUG    | [pipeline  :cv_model_evalua...:1269] | üêû Outer split (full set): 1680 train / 420 test samples.
2025-05-30 03:06:50 | DEBUG    | [pipeline  :cv_model_evalua...:1289] | üêû Fold 3: Internal split: ~1344 train / ~336 valid.
2025-05-30 03:06:50 | INFO     | [pipeline  :cv_model_evalua...:1299] | ‚ÑπÔ∏è Fitting model for fold 3...
2025-05-30 03:06:50 | INFO     | [standar...:__init__          :  48] | ‚ÑπÔ∏è Loaded efficientnet_b0 as feature extractor. Pretrained: True. Natural output channels: 1280
2025-05-30 03:06:50 | INFO     | [standar...:__init__          :  59] | ‚ÑπÔ∏è Added final 1x1 projection: 1280 -> 192 channels.
2025-05-30 03:06:50 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 0 of efficientnet_b0 features.
2025-05-30 03:06:50 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 1 of efficientnet_b0 features.
2025-05-30 03:06:50 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 2 of efficientnet_b0 features.
2025-05-30 03:06:50 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 3 of efficientnet_b0 features.
2025-05-30 03:06:50 | INFO     | [hybrid_...:__init__          :  67] | ‚ÑπÔ∏è Determined CNN feature extractor output size: 7x7 for input 224x224
2025-05-30 03:06:50 | DEBUG    | [pretrai...:__init__          :  38] | üêû Initializing PretrainedViT:
2025-05-30 03:06:50 | DEBUG    | [pretrai...:__init__          :  39] | üêû   Model Variant: vit_b_16, Pretrained: True
2025-05-30 03:06:50 | DEBUG    | [pretrai...:__init__          :  40] | üêû   Is Hybrid Input: True
2025-05-30 03:06:50 | DEBUG    | [pretrai...:__init__          :  42] | üêû   Hybrid In Channels: 192
2025-05-30 03:06:50 | DEBUG    | [pretrai...:__init__          :  43] | üêû   Unfreeze Strategy (Encoder Blocks): encoder_tail
2025-05-30 03:06:50 | DEBUG    | [pretrai...:__init__          :  45] | üêû   Num Transformer Blocks to Unfreeze: 2
2025-05-30 03:06:50 | DEBUG    | [pretrai...:__init__          :  46] | üêû   Unfreeze CLS: True, PosEmb: True, PatchEmb: True, EncoderLN: True
2025-05-30 03:06:50 | DEBUG    | [pretrai...:__init__          :  48] | üêû   Custom Head Hidden Dims: None, Head Dropout: 0.5
2025-05-30 03:06:50 | DEBUG    | [pretrai...:__init__          :  69] | üêû Loaded vit_b_16 from torchvision.
2025-05-30 03:06:50 | INFO     | [pretrai...:__init__          : 101] | ‚ÑπÔ∏è Adapting ViT 'vit_b_16' for hybrid input. Expected CNN feature map: 7x7.
2025-05-30 03:06:50 | INFO     | [pretrai...:__init__          : 110] | ‚ÑπÔ∏è Created hybrid input projection: 192 -> 768 channels.
2025-05-30 03:06:51 | INFO     | [pretrai...:__init__          : 180] | ‚ÑπÔ∏è Interpolating positional embedding in __init__ for hybrid ViT. Original patches: 196, Expected feature patches: 49 (7x7)
2025-05-30 03:06:51 | DEBUG    | [pretrai...:__init__          : 214] | üêû Unfroze custom hybrid input projection layer for ViT.
2025-05-30 03:06:51 | DEBUG    | [pretrai...:__init__          : 313] | üêû Created simple linear head (dropout: 0.5), in_feat=768.
2025-05-30 03:06:51 | INFO     | [pretrai...:__init__          : 323] | ‚ÑπÔ∏è PretrainedViT (hybrid) - Trainable: Hybrid Projection, CLS Token, Positional Embeddings, 2 Encoder Blocks, Encoder LayerNorm, Classification Head.
2025-05-30 03:06:51 | INFO     | [pretrai...:__init__          : 348] | ‚ÑπÔ∏è PretrainedViT (hybrid): Trainable params: 14.52M / Total params: 85.95M (16.89%)
2025-05-30 03:06:51 | DEBUG    | [adapter   :get_split_datasets: 131] | üêû Split created: 1344 train, 336 validation.
2025-05-30 03:06:51 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=1344, batch_size=32, shuffle=True, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 03:06:51 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for training.
2025-05-30 03:06:51 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=336, batch_size=32, shuffle=False, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 03:06:51 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for validation/evaluation.
2025-05-30 03:07:01 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è   epoch    train_acc    train_loss    valid_acc    valid_loss   cp           lr      dur
2025-05-30 03:07:01 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è -------  -----------  ------------  -----------  ------------  ----  ----------  -------
2025-05-30 03:07:01 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       1     ‚ñ≤ 0.5521      ‚ñº 1.3209     ‚ñ≤ 0.7649      ‚ñº 0.8882        4.9975e-05  10.2322
2025-05-30 03:07:09 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       2     ‚ñ≤ 0.8824      ‚ñº 0.7097     ‚ñ≤ 0.9077      ‚ñº 0.6341        4.9901e-05  7.7872
2025-05-30 03:07:16 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       3     ‚ñ≤ 0.9263      ‚ñº 0.6219     ‚ñ≤ 0.9226      ‚ñº 0.6003        4.9778e-05  7.6293
2025-05-30 03:07:24 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       4     ‚ñ≤ 0.9442      ‚ñº 0.5748     ‚ñ≤ 0.9405      ‚ñº 0.5550        4.9606e-05  7.9168
2025-05-30 03:07:32 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       5     ‚ñ≤ 0.9479      ‚ñº 0.5676     ‚ñ≤ 0.9524      ‚ñº 0.5354        4.9386e-05  8.0459
2025-05-30 03:07:40 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       6     ‚ñ≤ 0.9554      ‚ñº 0.5615     ‚ñ≤ 0.9643      ‚ñº 0.5184        4.9117e-05  7.6289
2025-05-30 03:07:48 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       7     ‚ñ≤ 0.9665      ‚ñº 0.5294       0.9554      ‚ñº 0.5140        4.8801e-05  7.5909
2025-05-30 03:07:55 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       8        0.965      ‚ñº 0.5173     ‚ñ≤ 0.9643      ‚ñº 0.4958        4.8438e-05  7.6252
2025-05-30 03:08:03 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       9     ‚ñ≤ 0.9732      ‚ñº 0.5153       0.9583        0.5024        4.8028e-05  7.6887
2025-05-30 03:08:11 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      10     ‚ñ≤ 0.9777      ‚ñº 0.4956       0.9613        0.4959        4.7574e-05  7.6759
2025-05-30 03:08:19 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      11        0.971        0.5045       0.9613      ‚ñº 0.4880        4.7075e-05  7.999
2025-05-30 03:08:26 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      12     ‚ñ≤ 0.9777      ‚ñº 0.4862     ‚ñ≤ 0.9673        0.4924        4.6532e-05  7.6668
2025-05-30 03:08:34 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      13       0.9769        0.4878     ‚ñ≤ 0.9673      ‚ñº 0.4745        4.5947e-05  7.6151
2025-05-30 03:08:42 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      14     ‚ñ≤ 0.9844      ‚ñº 0.4805       0.9554        0.4883        4.5321e-05  7.7186
2025-05-30 03:08:49 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      15       0.9821      ‚ñº 0.4787     ‚ñ≤ 0.9732        0.4765        4.4655e-05  7.6832
2025-05-30 03:08:57 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      16       0.9829      ‚ñº 0.4686       0.9702        0.4803        4.395e-05  7.5851
2025-05-30 03:09:05 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      17     ‚ñ≤ 0.9874      ‚ñº 0.4652       0.9702        0.4774        4.3208e-05  7.758
2025-05-30 03:09:13 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      18       0.9799        0.4735       0.9702        0.4794        4.2431e-05  7.9022
2025-05-30 03:09:20 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      19       0.9866        0.4684       0.9702      ‚ñº 0.4723        4.1619e-05  7.6165
2025-05-30 03:09:28 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      20     ‚ñ≤ 0.9896      ‚ñº 0.4587     ‚ñ≤ 0.9792      ‚ñº 0.4709        4.0776e-05  7.6457
2025-05-30 03:09:35 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      21     ‚ñ≤ 0.9896      ‚ñº 0.4568     ‚ñ≤ 0.9792      ‚ñº 0.4660        3.9901e-05  7.4683
2025-05-30 03:09:43 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      22       0.9814        0.4744     ‚ñ≤ 0.9851      ‚ñº 0.4620        3.8997e-05  7.6768
2025-05-30 03:09:51 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      23     ‚ñ≤ 0.9926      ‚ñº 0.4520       0.9821      ‚ñº 0.4605        3.8066e-05  7.7592
2025-05-30 03:09:59 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      24       0.9903      ‚ñº 0.4517     ‚ñ≤ 0.9851        0.4622        3.711e-05  7.9732
2025-05-30 03:10:06 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      25       0.9888        0.4537       0.9762        0.4719        3.613e-05  7.5347
2025-05-30 03:10:14 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      26       0.9911        0.4525       0.9792        0.4627        3.5129e-05  7.5441
2025-05-30 03:10:22 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      27       0.9881        0.4609       0.9732        0.4791        3.4109e-05  7.5797
2025-05-30 03:10:29 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      28     ‚ñ≤ 0.9933      ‚ñº 0.4479       0.9821        0.4684        3.3071e-05  7.6033
2025-05-30 03:10:37 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      29     ‚ñ≤ 0.9955      ‚ñº 0.4428       0.9732        0.4731        3.2018e-05  7.5738
2025-05-30 03:10:44 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      30        0.994        0.4455       0.9732        0.4689        3.0952e-05  7.623
2025-05-30 03:10:52 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      31       0.9896        0.4529       0.9702        0.4728        2.9875e-05  7.6423
2025-05-30 03:11:00 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      32       0.9821        0.4677       0.9821         0.467        2.8789e-05  7.8575
2025-05-30 03:11:07 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      33       0.9896        0.4495     ‚ñ≤ 0.9881      ‚ñº 0.4572        2.7696e-05  7.5222
2025-05-30 03:11:15 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      34     ‚ñ≤ 0.9970      ‚ñº 0.4374       0.9821        0.4594        2.6599e-05  7.6302
2025-05-30 03:11:23 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      35       0.9888        0.4518       0.9702        0.4649        2.55e-05  7.6093
2025-05-30 03:11:30 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      36        0.994         0.447       0.9821        0.4635        2.4401e-05  7.495
2025-05-30 03:11:38 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      37     ‚ñ≤ 0.9970      ‚ñº 0.4373       0.9792        0.4698        2.3304e-05  7.5992
2025-05-30 03:11:46 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      38        0.994        0.4409       0.9732        0.4767        2.2211e-05  7.9362
2025-05-30 03:11:53 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      39       0.9963        0.4383     ‚ñ≤ 0.9881        0.4579        2.1125e-05  7.7786
2025-05-30 03:12:01 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      40       0.9933         0.441       0.9702        0.4807        2.0048e-05  7.5777
2025-05-30 03:12:09 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      41        0.994         0.441       0.9762          0.47        1.8982e-05  7.6806
2025-05-30 03:12:16 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      42       0.9918        0.4447       0.9732        0.4673        1.7929e-05  7.5726
2025-05-30 03:12:24 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      43       0.9933        0.4428       0.9851      ‚ñº 0.4543        1.6891e-05  7.572
2025-05-30 03:12:32 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      44       0.9933         0.441       0.9821        0.4667        1.5871e-05  7.6728
2025-05-30 03:12:39 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      45       0.9963      ‚ñº 0.4349       0.9821        0.4544        1.487e-05  7.8911
2025-05-30 03:12:47 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      46       0.9955        0.4383       0.9851        0.4544        1.389e-05  7.6193
2025-05-30 03:12:55 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      47       0.9955      ‚ñº 0.4335       0.9821         0.458        1.2934e-05  7.5561
2025-05-30 03:13:02 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      48       0.9918        0.4434       0.9851        0.4555        1.2003e-05  7.6845
2025-05-30 03:13:10 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      49     ‚ñ≤ 0.9970        0.4345       0.9792      ‚ñº 0.4514        1.1099e-05  7.5739
2025-05-30 03:13:18 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      50       0.9933        0.4393       0.9792        0.4624        1.0224e-05  7.7683
2025-05-30 03:13:26 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      51       0.9926        0.4416       0.9732        0.4582        9.3805e-06  7.9457
2025-05-30 03:13:33 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      52     ‚ñ≤ 0.9970        0.4361       0.9851        0.4518        8.569e-06  7.8076
2025-05-30 03:13:41 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      53       0.9948        0.4352       0.9762        0.4639        7.7915e-06  7.7162
2025-05-30 03:13:49 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      54       0.9963        0.4363     ‚ñ≤ 0.9911      ‚ñº 0.4508        7.0497e-06  7.7787
2025-05-30 03:13:57 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      55       0.9963        0.4342       0.9851        0.4569        6.3451e-06  7.6655
2025-05-30 03:14:04 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      56        0.994         0.438       0.9851        0.4541        5.6791e-06  7.7361
2025-05-30 03:14:12 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      57     ‚ñ≤ 0.9970        0.4344       0.9881      ‚ñº 0.4466        5.053e-06  7.8006
2025-05-30 03:14:20 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      58       0.9955         0.439       0.9881        0.4501        4.468e-06  7.7046
2025-05-30 03:14:28 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      59       0.9955        0.4405       0.9762         0.462        3.9254e-06  7.7203
2025-05-30 03:14:35 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      60       0.9948        0.4385       0.9851      ‚ñº 0.4458        3.4263e-06  7.6992
2025-05-30 03:14:43 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      61     ‚ñ≤ 0.9970        0.4359     ‚ñ≤ 0.9911      ‚ñº 0.4455        2.9716e-06  7.695
2025-05-30 03:14:51 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      62       0.9926        0.4423       0.9881         0.452        2.5622e-06  7.7156
2025-05-30 03:14:59 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      63       0.9955        0.4386       0.9881        0.4506        2.1991e-06  7.751
2025-05-30 03:15:06 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      64       0.9948        0.4367       0.9821        0.4512        1.8829e-06  7.7098
2025-05-30 03:15:14 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      65       0.9933        0.4446     ‚ñ≤ 0.9911          0.45        1.6143e-06  7.7075
2025-05-30 03:15:22 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      66       0.9918        0.4393       0.9881        0.4488        1.3937e-06  7.7187
2025-05-30 03:15:29 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      67        0.994        0.4387       0.9851        0.4508        1.2217e-06  7.6693
2025-05-30 03:15:37 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      68       0.9963        0.4337       0.9851         0.457        1.0986e-06  7.6284
2025-05-30 03:15:45 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      69       0.9933        0.4423       0.9732        0.4673        1.0247e-06  7.7132
2025-05-30 03:15:52 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      70     ‚ñ≤ 0.9985      ‚ñº 0.4327       0.9881        0.4509        1e-06  7.6379
2025-05-30 03:15:52 | INFO     | [pipeline  :cv_model_evalua...:1313] | ‚ÑπÔ∏è Using best model from epoch 70
2025-05-30 03:15:52 | INFO     | [pipeline  :cv_model_evalua...:1316] | ‚ÑπÔ∏è Evaluating model on outer test set for fold 3...
2025-05-30 03:15:52 | DEBUG    | [adapter   :get_iterator      : 250] | üêû get_iterator: Wrapping skorch Dataset's X (paths) with PathImageDataset for eval.
2025-05-30 03:15:52 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=420, batch_size=32, shuffle=False, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 03:15:52 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for validation/evaluation.
2025-05-30 03:15:53 | DEBUG    | [adapter   :get_iterator      : 250] | üêû get_iterator: Wrapping skorch Dataset's X (paths) with PathImageDataset for eval.
2025-05-30 03:15:53 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=420, batch_size=32, shuffle=False, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 03:15:53 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for validation/evaluation.
2025-05-30 03:15:54 | DEBUG    | [pipeline  :_compute_metrics  : 443] | üêû Computed Metrics: Acc=0.9952, Macro F1=0.9952
2025-05-30 03:15:54 | INFO     | [pipeline  :cv_model_evalua...:1336] | ‚ÑπÔ∏è Fold 3 Test Scores: Acc=0.9952, F1=0.9952
2025-05-30 03:15:54 | INFO     | [pipeline  :cv_model_evalua...:1262] | ‚ÑπÔ∏è --- Starting CV Evaluation Fold 4/5 ---
2025-05-30 03:15:54 | DEBUG    | [pipeline  :cv_model_evalua...:1269] | üêû Outer split (full set): 1680 train / 420 test samples.
2025-05-30 03:15:54 | DEBUG    | [pipeline  :cv_model_evalua...:1289] | üêû Fold 4: Internal split: ~1344 train / ~336 valid.
2025-05-30 03:15:54 | INFO     | [pipeline  :cv_model_evalua...:1299] | ‚ÑπÔ∏è Fitting model for fold 4...
2025-05-30 03:15:54 | INFO     | [standar...:__init__          :  48] | ‚ÑπÔ∏è Loaded efficientnet_b0 as feature extractor. Pretrained: True. Natural output channels: 1280
2025-05-30 03:15:54 | INFO     | [standar...:__init__          :  59] | ‚ÑπÔ∏è Added final 1x1 projection: 1280 -> 192 channels.
2025-05-30 03:15:54 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 0 of efficientnet_b0 features.
2025-05-30 03:15:54 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 1 of efficientnet_b0 features.
2025-05-30 03:15:54 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 2 of efficientnet_b0 features.
2025-05-30 03:15:54 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 3 of efficientnet_b0 features.
2025-05-30 03:15:54 | INFO     | [hybrid_...:__init__          :  67] | ‚ÑπÔ∏è Determined CNN feature extractor output size: 7x7 for input 224x224
2025-05-30 03:15:54 | DEBUG    | [pretrai...:__init__          :  38] | üêû Initializing PretrainedViT:
2025-05-30 03:15:54 | DEBUG    | [pretrai...:__init__          :  39] | üêû   Model Variant: vit_b_16, Pretrained: True
2025-05-30 03:15:54 | DEBUG    | [pretrai...:__init__          :  40] | üêû   Is Hybrid Input: True
2025-05-30 03:15:54 | DEBUG    | [pretrai...:__init__          :  42] | üêû   Hybrid In Channels: 192
2025-05-30 03:15:54 | DEBUG    | [pretrai...:__init__          :  43] | üêû   Unfreeze Strategy (Encoder Blocks): encoder_tail
2025-05-30 03:15:54 | DEBUG    | [pretrai...:__init__          :  45] | üêû   Num Transformer Blocks to Unfreeze: 2
2025-05-30 03:15:54 | DEBUG    | [pretrai...:__init__          :  46] | üêû   Unfreeze CLS: True, PosEmb: True, PatchEmb: True, EncoderLN: True
2025-05-30 03:15:54 | DEBUG    | [pretrai...:__init__          :  48] | üêû   Custom Head Hidden Dims: None, Head Dropout: 0.5
2025-05-30 03:15:55 | DEBUG    | [pretrai...:__init__          :  69] | üêû Loaded vit_b_16 from torchvision.
2025-05-30 03:15:55 | INFO     | [pretrai...:__init__          : 101] | ‚ÑπÔ∏è Adapting ViT 'vit_b_16' for hybrid input. Expected CNN feature map: 7x7.
2025-05-30 03:15:55 | INFO     | [pretrai...:__init__          : 110] | ‚ÑπÔ∏è Created hybrid input projection: 192 -> 768 channels.
2025-05-30 03:15:55 | INFO     | [pretrai...:__init__          : 180] | ‚ÑπÔ∏è Interpolating positional embedding in __init__ for hybrid ViT. Original patches: 196, Expected feature patches: 49 (7x7)
2025-05-30 03:15:55 | DEBUG    | [pretrai...:__init__          : 214] | üêû Unfroze custom hybrid input projection layer for ViT.
2025-05-30 03:15:55 | DEBUG    | [pretrai...:__init__          : 313] | üêû Created simple linear head (dropout: 0.5), in_feat=768.
2025-05-30 03:15:55 | INFO     | [pretrai...:__init__          : 323] | ‚ÑπÔ∏è PretrainedViT (hybrid) - Trainable: Hybrid Projection, CLS Token, Positional Embeddings, 2 Encoder Blocks, Encoder LayerNorm, Classification Head.
2025-05-30 03:15:55 | INFO     | [pretrai...:__init__          : 348] | ‚ÑπÔ∏è PretrainedViT (hybrid): Trainable params: 14.52M / Total params: 85.95M (16.89%)
2025-05-30 03:15:55 | DEBUG    | [adapter   :get_split_datasets: 131] | üêû Split created: 1344 train, 336 validation.
2025-05-30 03:15:55 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=1344, batch_size=32, shuffle=True, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 03:15:55 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for training.
2025-05-30 03:15:55 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=336, batch_size=32, shuffle=False, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 03:15:55 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for validation/evaluation.
2025-05-30 03:16:05 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è   epoch    train_acc    train_loss    valid_acc    valid_loss   cp           lr     dur
2025-05-30 03:16:05 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è -------  -----------  ------------  -----------  ------------  ----  ----------  ------
2025-05-30 03:16:05 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       1     ‚ñ≤ 0.5826      ‚ñº 1.2701     ‚ñ≤ 0.8185      ‚ñº 0.8367        4.9975e-05  10.387
2025-05-30 03:16:13 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       2     ‚ñ≤ 0.8787      ‚ñº 0.7054     ‚ñ≤ 0.9018      ‚ñº 0.6489        4.9901e-05  7.8619
2025-05-30 03:16:21 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       3     ‚ñ≤ 0.9189      ‚ñº 0.6336     ‚ñ≤ 0.9405      ‚ñº 0.5704        4.9778e-05  7.7354
2025-05-30 03:16:29 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       4     ‚ñ≤ 0.9442      ‚ñº 0.5915     ‚ñ≤ 0.9613      ‚ñº 0.5394        4.9606e-05  7.7304
2025-05-30 03:16:36 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       5     ‚ñ≤ 0.9576      ‚ñº 0.5414     ‚ñ≤ 0.9613      ‚ñº 0.5254        4.9386e-05  7.7105
2025-05-30 03:16:44 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       6     ‚ñ≤ 0.9606        0.5457     ‚ñ≤ 0.9762      ‚ñº 0.5132        4.9117e-05  7.7369
2025-05-30 03:16:52 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       7     ‚ñ≤ 0.9643      ‚ñº 0.5249     ‚ñ≤ 0.9762      ‚ñº 0.4972        4.8801e-05  7.7075
2025-05-30 03:17:00 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       8       0.9606        0.5251     ‚ñ≤ 0.9821      ‚ñº 0.4899        4.8438e-05  7.6516
2025-05-30 03:17:07 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       9       0.9598         0.529       0.9762      ‚ñº 0.4847        4.8028e-05  7.6476
2025-05-30 03:17:15 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      10     ‚ñ≤ 0.9807      ‚ñº 0.4960       0.9792      ‚ñº 0.4829        4.7574e-05  7.7352
2025-05-30 03:17:23 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      11       0.9792      ‚ñº 0.4842     ‚ñ≤ 0.9821      ‚ñº 0.4748        4.7075e-05  7.8023
2025-05-30 03:17:31 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      12     ‚ñ≤ 0.9851      ‚ñº 0.4787     ‚ñ≤ 0.9851      ‚ñº 0.4704        4.6532e-05  7.6327
2025-05-30 03:17:38 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      13       0.9769        0.4881       0.9762        0.4733        4.5947e-05  7.5829
2025-05-30 03:17:46 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      14       0.9807         0.482       0.9702        0.4974        4.5321e-05  7.7642
2025-05-30 03:17:54 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      15       0.9807      ‚ñº 0.4775       0.9673        0.4904        4.4655e-05  7.6998
2025-05-30 03:18:01 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      16     ‚ñ≤ 0.9851      ‚ñº 0.4722       0.9821        0.4773        4.395e-05  7.6532
2025-05-30 03:18:09 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      17       0.9844        0.4723       0.9792        0.4733        4.3208e-05  7.7353
2025-05-30 03:18:17 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      18     ‚ñ≤ 0.9859      ‚ñº 0.4680       0.9821        0.4742        4.2431e-05  7.7428
2025-05-30 03:18:24 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      19     ‚ñ≤ 0.9896      ‚ñº 0.4573       0.9792        0.4713        4.1619e-05  7.6815
2025-05-30 03:18:32 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      20     ‚ñ≤ 0.9896        0.4591       0.9792        0.4714        4.0776e-05  7.6756
2025-05-30 03:18:40 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      21       0.9851        0.4716       0.9792      ‚ñº 0.4685        3.9901e-05  7.7764
2025-05-30 03:18:48 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      22     ‚ñ≤ 0.9926      ‚ñº 0.4512       0.9792        0.4688        3.8997e-05  7.8276
2025-05-30 03:18:55 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      23     ‚ñ≤ 0.9926        0.4519       0.9821      ‚ñº 0.4653        3.8066e-05  7.7103
2025-05-30 03:19:03 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      24       0.9888        0.4585       0.9792        0.4712        3.711e-05  7.8842
2025-05-30 03:19:11 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      25       0.9874        0.4611       0.9792      ‚ñº 0.4626        3.613e-05  7.7336
2025-05-30 03:19:19 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      26     ‚ñ≤ 0.9926      ‚ñº 0.4499       0.9821         0.464        3.5129e-05  7.7457
2025-05-30 03:19:27 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      27       0.9903      ‚ñº 0.4483     ‚ñ≤ 0.9881      ‚ñº 0.4564        3.4109e-05  7.6971
2025-05-30 03:19:34 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      28     ‚ñ≤ 0.9948      ‚ñº 0.4462       0.9792        0.4691        3.3071e-05  7.7407
2025-05-30 03:19:42 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      29     ‚ñ≤ 0.9948      ‚ñº 0.4428       0.9821        0.4667        3.2018e-05  7.5988
2025-05-30 03:19:50 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      30     ‚ñ≤ 0.9948      ‚ñº 0.4415       0.9821        0.4693        3.0952e-05  7.7718
2025-05-30 03:19:57 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      31     ‚ñ≤ 0.9963      ‚ñº 0.4397       0.9851        0.4584        2.9875e-05  7.6443
2025-05-30 03:20:05 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      32       0.9933        0.4458       0.9821        0.4573        2.8789e-05  7.7216
2025-05-30 03:20:13 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      33       0.9926        0.4481       0.9792        0.4651        2.7696e-05  7.7126
2025-05-30 03:20:20 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      34       0.9903        0.4561       0.9851        0.4666        2.6599e-05  7.6476
2025-05-30 03:20:28 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      35        0.994        0.4436     ‚ñ≤ 0.9881        0.4583        2.55e-05  7.6007
2025-05-30 03:20:36 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      36       0.9918        0.4435     ‚ñ≤ 0.9881        0.4565        2.4401e-05  7.6966
2025-05-30 03:20:44 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      37        0.994        0.4417     ‚ñ≤ 0.9881        0.4583        2.3304e-05  7.7654
2025-05-30 03:20:51 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      38        0.994      ‚ñº 0.4392       0.9821        0.4618        2.2211e-05   7.69
2025-05-30 03:20:59 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      39       0.9948        0.4431     ‚ñ≤ 0.9881         0.461        2.1125e-05  7.8431
2025-05-30 03:21:07 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      40     ‚ñ≤ 0.9963      ‚ñº 0.4362       0.9851        0.4615        2.0048e-05  7.6307
2025-05-30 03:21:14 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      41       0.9955        0.4399       0.9821        0.4647        1.8982e-05  7.5915
2025-05-30 03:21:22 | INFO     | [pipeline  :cv_model_evalua...:1313] | ‚ÑπÔ∏è Using best model from epoch 42
2025-05-30 03:21:22 | INFO     | [pipeline  :cv_model_evalua...:1316] | ‚ÑπÔ∏è Evaluating model on outer test set for fold 4...
2025-05-30 03:21:22 | DEBUG    | [adapter   :get_iterator      : 250] | üêû get_iterator: Wrapping skorch Dataset's X (paths) with PathImageDataset for eval.
2025-05-30 03:21:22 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=420, batch_size=32, shuffle=False, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 03:21:22 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for validation/evaluation.
2025-05-30 03:21:23 | DEBUG    | [adapter   :get_iterator      : 250] | üêû get_iterator: Wrapping skorch Dataset's X (paths) with PathImageDataset for eval.
2025-05-30 03:21:23 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=420, batch_size=32, shuffle=False, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 03:21:23 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for validation/evaluation.
2025-05-30 03:21:24 | DEBUG    | [pipeline  :_compute_metrics  : 443] | üêû Computed Metrics: Acc=0.9857, Macro F1=0.9857
2025-05-30 03:21:24 | INFO     | [pipeline  :cv_model_evalua...:1336] | ‚ÑπÔ∏è Fold 4 Test Scores: Acc=0.9857, F1=0.9857
2025-05-30 03:21:24 | INFO     | [pipeline  :cv_model_evalua...:1262] | ‚ÑπÔ∏è --- Starting CV Evaluation Fold 5/5 ---
2025-05-30 03:21:24 | DEBUG    | [pipeline  :cv_model_evalua...:1269] | üêû Outer split (full set): 1680 train / 420 test samples.
2025-05-30 03:21:24 | DEBUG    | [pipeline  :cv_model_evalua...:1289] | üêû Fold 5: Internal split: ~1344 train / ~336 valid.
2025-05-30 03:21:24 | INFO     | [pipeline  :cv_model_evalua...:1299] | ‚ÑπÔ∏è Fitting model for fold 5...
2025-05-30 03:21:24 | INFO     | [standar...:__init__          :  48] | ‚ÑπÔ∏è Loaded efficientnet_b0 as feature extractor. Pretrained: True. Natural output channels: 1280
2025-05-30 03:21:24 | INFO     | [standar...:__init__          :  59] | ‚ÑπÔ∏è Added final 1x1 projection: 1280 -> 192 channels.
2025-05-30 03:21:24 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 0 of efficientnet_b0 features.
2025-05-30 03:21:24 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 1 of efficientnet_b0 features.
2025-05-30 03:21:24 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 2 of efficientnet_b0 features.
2025-05-30 03:21:24 | INFO     | [standar...:_freeze_stages    :  85] | ‚ÑπÔ∏è Freezing stage 3 of efficientnet_b0 features.
2025-05-30 03:21:24 | INFO     | [hybrid_...:__init__          :  67] | ‚ÑπÔ∏è Determined CNN feature extractor output size: 7x7 for input 224x224
2025-05-30 03:21:24 | DEBUG    | [pretrai...:__init__          :  38] | üêû Initializing PretrainedViT:
2025-05-30 03:21:24 | DEBUG    | [pretrai...:__init__          :  39] | üêû   Model Variant: vit_b_16, Pretrained: True
2025-05-30 03:21:24 | DEBUG    | [pretrai...:__init__          :  40] | üêû   Is Hybrid Input: True
2025-05-30 03:21:24 | DEBUG    | [pretrai...:__init__          :  42] | üêû   Hybrid In Channels: 192
2025-05-30 03:21:24 | DEBUG    | [pretrai...:__init__          :  43] | üêû   Unfreeze Strategy (Encoder Blocks): encoder_tail
2025-05-30 03:21:24 | DEBUG    | [pretrai...:__init__          :  45] | üêû   Num Transformer Blocks to Unfreeze: 2
2025-05-30 03:21:24 | DEBUG    | [pretrai...:__init__          :  46] | üêû   Unfreeze CLS: True, PosEmb: True, PatchEmb: True, EncoderLN: True
2025-05-30 03:21:24 | DEBUG    | [pretrai...:__init__          :  48] | üêû   Custom Head Hidden Dims: None, Head Dropout: 0.5
2025-05-30 03:21:24 | DEBUG    | [pretrai...:__init__          :  69] | üêû Loaded vit_b_16 from torchvision.
2025-05-30 03:21:24 | INFO     | [pretrai...:__init__          : 101] | ‚ÑπÔ∏è Adapting ViT 'vit_b_16' for hybrid input. Expected CNN feature map: 7x7.
2025-05-30 03:21:24 | INFO     | [pretrai...:__init__          : 110] | ‚ÑπÔ∏è Created hybrid input projection: 192 -> 768 channels.
2025-05-30 03:21:24 | INFO     | [pretrai...:__init__          : 180] | ‚ÑπÔ∏è Interpolating positional embedding in __init__ for hybrid ViT. Original patches: 196, Expected feature patches: 49 (7x7)
2025-05-30 03:21:24 | DEBUG    | [pretrai...:__init__          : 214] | üêû Unfroze custom hybrid input projection layer for ViT.
2025-05-30 03:21:24 | DEBUG    | [pretrai...:__init__          : 313] | üêû Created simple linear head (dropout: 0.5), in_feat=768.
2025-05-30 03:21:24 | INFO     | [pretrai...:__init__          : 323] | ‚ÑπÔ∏è PretrainedViT (hybrid) - Trainable: Hybrid Projection, CLS Token, Positional Embeddings, 2 Encoder Blocks, Encoder LayerNorm, Classification Head.
2025-05-30 03:21:24 | INFO     | [pretrai...:__init__          : 348] | ‚ÑπÔ∏è PretrainedViT (hybrid): Trainable params: 14.52M / Total params: 85.95M (16.89%)
2025-05-30 03:21:24 | DEBUG    | [adapter   :get_split_datasets: 131] | üêû Split created: 1344 train, 336 validation.
2025-05-30 03:21:24 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=1344, batch_size=32, shuffle=True, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 03:21:24 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for training.
2025-05-30 03:21:24 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=336, batch_size=32, shuffle=False, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 03:21:24 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for validation/evaluation.
2025-05-30 03:21:35 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è   epoch    train_acc    train_loss    valid_acc    valid_loss   cp           lr      dur
2025-05-30 03:21:35 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è -------  -----------  ------------  -----------  ------------  ----  ----------  -------
2025-05-30 03:21:35 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       1     ‚ñ≤ 0.5997      ‚ñº 1.2587     ‚ñ≤ 0.8542      ‚ñº 0.7451        4.9975e-05  10.1997
2025-05-30 03:21:43 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       2     ‚ñ≤ 0.8765      ‚ñº 0.7210     ‚ñ≤ 0.9018      ‚ñº 0.6484        4.9901e-05  8.1838
2025-05-30 03:21:51 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       3     ‚ñ≤ 0.9159      ‚ñº 0.6445     ‚ñ≤ 0.9167      ‚ñº 0.6258        4.9778e-05  7.8519
2025-05-30 03:21:59 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       4     ‚ñ≤ 0.9412      ‚ñº 0.5835       0.9107        0.6266        4.9606e-05  7.8373
2025-05-30 03:22:06 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       5     ‚ñ≤ 0.9487      ‚ñº 0.5646     ‚ñ≤ 0.9375      ‚ñº 0.5716        4.9386e-05  7.7656
2025-05-30 03:22:14 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       6     ‚ñ≤ 0.9576      ‚ñº 0.5438     ‚ñ≤ 0.9494      ‚ñº 0.5480        4.9117e-05  7.7344
2025-05-30 03:22:22 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       7       0.9494        0.5576       0.9435        0.5526        4.8801e-05  7.8204
2025-05-30 03:22:30 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       8     ‚ñ≤ 0.9621      ‚ñº 0.5265     ‚ñ≤ 0.9524      ‚ñº 0.5194        4.8438e-05  8.3416
2025-05-30 03:22:38 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è       9     ‚ñ≤ 0.9717      ‚ñº 0.5080     ‚ñ≤ 0.9554        0.5297        4.8028e-05  7.7336
2025-05-30 03:22:46 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      10       0.9702      ‚ñº 0.5036       0.9524        0.5357        4.7574e-05  7.8323
2025-05-30 03:22:54 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      11     ‚ñ≤ 0.9769      ‚ñº 0.5008     ‚ñ≤ 0.9554      ‚ñº 0.5085        4.7075e-05  7.7045
2025-05-30 03:23:01 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      12     ‚ñ≤ 0.9769      ‚ñº 0.4917     ‚ñ≤ 0.9613         0.512        4.6532e-05  7.7933
2025-05-30 03:23:09 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      13       0.9762        0.5034       0.9405        0.5421        4.5947e-05  7.6394
2025-05-30 03:23:17 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      14     ‚ñ≤ 0.9814      ‚ñº 0.4901     ‚ñ≤ 0.9643      ‚ñº 0.4971        4.5321e-05  7.7431
2025-05-30 03:23:25 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      15     ‚ñ≤ 0.9859      ‚ñº 0.4758     ‚ñ≤ 0.9643      ‚ñº 0.4873        4.4655e-05  7.6779
2025-05-30 03:23:32 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      16       0.9851      ‚ñº 0.4675     ‚ñ≤ 0.9762      ‚ñº 0.4791        4.395e-05  7.7544
2025-05-30 03:23:40 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      17     ‚ñ≤ 0.9859        0.4744     ‚ñ≤ 0.9792        0.4794        4.3208e-05  7.7205
2025-05-30 03:23:48 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      18     ‚ñ≤ 0.9866      ‚ñº 0.4673     ‚ñ≤ 0.9851      ‚ñº 0.4652        4.2431e-05  7.8591
2025-05-30 03:23:56 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      19     ‚ñ≤ 0.9881        0.4708       0.9702        0.4824        4.1619e-05  7.7698
2025-05-30 03:24:03 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      20       0.9866        0.4702     ‚ñ≤ 0.9911      ‚ñº 0.4636        4.0776e-05  7.7491
2025-05-30 03:24:11 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      21     ‚ñ≤ 0.9940      ‚ñº 0.4530       0.9821        0.4643        3.9901e-05  7.6701
2025-05-30 03:24:19 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      22       0.9874        0.4619       0.9821        0.4694        3.8997e-05  7.7488
2025-05-30 03:24:27 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      23       0.9881        0.4602       0.9851      ‚ñº 0.4621        3.8066e-05  7.5806
2025-05-30 03:24:34 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      24       0.9874        0.4641     ‚ñ≤ 0.9940      ‚ñº 0.4585        3.711e-05  7.7975
2025-05-30 03:24:42 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      25       0.9874        0.4559       0.9821         0.467        3.613e-05  7.7803
2025-05-30 03:24:50 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      26       0.9888        0.4589       0.9792        0.4709        3.5129e-05  7.7516
2025-05-30 03:24:58 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      27       0.9918      ‚ñº 0.4512       0.9821        0.4649        3.4109e-05  7.6821
2025-05-30 03:25:05 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      28       0.9874        0.4564       0.9881      ‚ñº 0.4559        3.3071e-05  7.6432
2025-05-30 03:25:13 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      29       0.9888        0.4561       0.9881      ‚ñº 0.4508        3.2018e-05  7.6361
2025-05-30 03:25:21 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      30       0.9903        0.4544       0.9881      ‚ñº 0.4496        3.0952e-05  7.9238
2025-05-30 03:25:29 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      31     ‚ñ≤ 0.9963      ‚ñº 0.4427       0.9851        0.4523        2.9875e-05  7.6597
2025-05-30 03:25:36 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      32     ‚ñ≤ 0.9978      ‚ñº 0.4378       0.9881        0.4538        2.8789e-05  7.6055
2025-05-30 03:25:44 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      33       0.9933        0.4426       0.9881        0.4517        2.7696e-05  7.7135
2025-05-30 03:25:52 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      34       0.9933        0.4467       0.9911        0.4547        2.6599e-05  7.8126
2025-05-30 03:25:59 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      35       0.9955      ‚ñº 0.4376       0.9881        0.4517        2.55e-05  7.7254
2025-05-30 03:26:07 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      36       0.9888        0.4574       0.9881      ‚ñº 0.4494        2.4401e-05  7.7171
2025-05-30 03:26:15 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      37       0.9926        0.4447       0.9911      ‚ñº 0.4481        2.3304e-05  7.7788
2025-05-30 03:26:23 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      38       0.9926        0.4462     ‚ñ≤ 0.9940        0.4531        2.2211e-05  7.7147
2025-05-30 03:26:30 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      39       0.9948        0.4425       0.9881        0.4615        2.1125e-05  7.7793
2025-05-30 03:26:38 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      40       0.9888        0.4545       0.9851        0.4533        2.0048e-05  7.6941
2025-05-30 03:26:46 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      41       0.9903        0.4486       0.9821        0.4658        1.8982e-05  7.7102
2025-05-30 03:26:54 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      42        0.997      ‚ñº 0.4353       0.9911      ‚ñº 0.4434        1.7929e-05  7.8005
2025-05-30 03:27:01 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      43        0.994        0.4441       0.9851        0.4586        1.6891e-05  7.7136
2025-05-30 03:27:09 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      44       0.9948        0.4441       0.9851        0.4494        1.5871e-05  7.6246
2025-05-30 03:27:17 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      45     ‚ñ≤ 0.9978      ‚ñº 0.4350       0.9911        0.4462        1.487e-05  7.7251
2025-05-30 03:27:24 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      46       0.9955        0.4391       0.9911        0.4438        1.389e-05  7.7088
2025-05-30 03:27:32 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      47       0.9963        0.4352     ‚ñ≤ 0.9940         0.446        1.2934e-05  7.5791
2025-05-30 03:27:40 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      48       0.9948          0.44       0.9851         0.458        1.2003e-05  7.6898
2025-05-30 03:27:47 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      49        0.997        0.4355       0.9881        0.4585        1.1099e-05  7.7205
2025-05-30 03:27:55 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      50        0.994        0.4395       0.9851        0.4589        1.0224e-05  7.7218
2025-05-30 03:28:03 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      51       0.9963      ‚ñº 0.4347       0.9911        0.4491        9.3805e-06  7.6953
2025-05-30 03:28:10 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      52     ‚ñ≤ 0.9978      ‚ñº 0.4319       0.9851        0.4525        8.569e-06  7.5846
2025-05-30 03:28:18 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      53     ‚ñ≤ 0.9985      ‚ñº 0.4316       0.9911        0.4543        7.7915e-06  7.7738
2025-05-30 03:28:26 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      54       0.9911         0.439       0.9851        0.4539        7.0497e-06  7.6498
2025-05-30 03:28:34 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      55       0.9955        0.4368       0.9851        0.4609        6.3451e-06  7.6738
2025-05-30 03:28:41 | INFO     | [callbacks :on_epoch_end      : 148] | ‚ÑπÔ∏è      56     ‚ñ≤ 0.9993      ‚ñº 0.4311       0.9851        0.4551        5.6791e-06  7.7075
2025-05-30 03:28:49 | INFO     | [pipeline  :cv_model_evalua...:1313] | ‚ÑπÔ∏è Using best model from epoch 57
2025-05-30 03:28:49 | INFO     | [pipeline  :cv_model_evalua...:1316] | ‚ÑπÔ∏è Evaluating model on outer test set for fold 5...
2025-05-30 03:28:49 | DEBUG    | [adapter   :get_iterator      : 250] | üêû get_iterator: Wrapping skorch Dataset's X (paths) with PathImageDataset for eval.
2025-05-30 03:28:49 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=420, batch_size=32, shuffle=False, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 03:28:49 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for validation/evaluation.
2025-05-30 03:28:50 | DEBUG    | [adapter   :get_iterator      : 250] | üêû get_iterator: Wrapping skorch Dataset's X (paths) with PathImageDataset for eval.
2025-05-30 03:28:50 | DEBUG    | [adapter   :get_iterator      : 304] | üêû Creating DataLoader: dataset_len=420, batch_size=32, shuffle=False, collate_fn=Custom (PathImageDataset style), loader_kwargs={'num_workers': 0, 'pin_memory': False}
2025-05-30 03:28:50 | DEBUG    | [adapter   :get_iterator      : 319] | üêû Wrapping DataLoader with _BatchPlottingIterator for validation/evaluation.
2025-05-30 03:28:51 | DEBUG    | [pipeline  :_compute_metrics  : 443] | üêû Computed Metrics: Acc=0.9881, Macro F1=0.9881
2025-05-30 03:28:51 | INFO     | [pipeline  :cv_model_evalua...:1336] | ‚ÑπÔ∏è Fold 5 Test Scores: Acc=0.9881, F1=0.9881
2025-05-30 03:28:51 | DEBUG    | [pipeline  :_save_results     : 463] | üêû Results detail level overridden for this run to: 3
2025-05-30 03:28:51 | DEBUG    | [pipeline  :_save_results     : 471] | üêû Saving results for cv_model_evaluation_full_025350 (detail level: 3)
2025-05-30 03:28:51 | INFO     | [pipeline  :_save_results     : 580] | ‚ÑπÔ∏è Results JSON saved via repository to: experiments/Swimcat-extend/hvit/20250530_025350_seed42/cv_model_evaluation_full_025350/cv_model_evaluation_results.json
2025-05-30 03:28:51 | INFO     | [pipeline  :cv_model_evalua...:1454] | ‚ÑπÔ∏è Plotting cv for eval results for cv_model_evaluation_full_025350 (plot level 2).
2025-05-30 03:28:51 | INFO     | [plotter   :plot_cv_model_e...: 854] | ‚ÑπÔ∏è Plotting cv_model_evaluation results for: cv_model_evaluation_full_025350
2025-05-30 03:28:51 | INFO     | [plotter   :_generate_aggre...: 301] | ‚ÑπÔ∏è Aggregated metrics CSV saved via repository to: experiments/Swimcat-extend/hvit/20250530_025350_seed42/cv_model_evaluation_full_025350/cv_model_evaluation_plots/aggregated_metrics_table.csv
2025-05-30 03:28:53 | INFO     | [plotter   :plot_cv_model_e...: 910] | ‚ÑπÔ∏è Generating grouped plots per fold for 5 folds...
2025-05-30 03:28:59 | INFO     | [plotter   :_generate_metri...: 246] | ‚ÑπÔ∏è Metrics CSV saved via repository to: experiments/Swimcat-extend/hvit/20250530_025350_seed42/cv_model_evaluation_full_025350/cv_model_evaluation_plots/fold_1_metrics_table.csv
2025-05-30 03:28:59 | INFO     | [plotter   :_generate_metri...: 246] | ‚ÑπÔ∏è Metrics CSV saved via repository to: experiments/Swimcat-extend/hvit/20250530_025350_seed42/cv_model_evaluation_full_025350/cv_model_evaluation_plots/fold_2_metrics_table.csv
2025-05-30 03:28:59 | INFO     | [plotter   :_generate_metri...: 246] | ‚ÑπÔ∏è Metrics CSV saved via repository to: experiments/Swimcat-extend/hvit/20250530_025350_seed42/cv_model_evaluation_full_025350/cv_model_evaluation_plots/fold_3_metrics_table.csv
2025-05-30 03:28:59 | INFO     | [plotter   :_generate_metri...: 246] | ‚ÑπÔ∏è Metrics CSV saved via repository to: experiments/Swimcat-extend/hvit/20250530_025350_seed42/cv_model_evaluation_full_025350/cv_model_evaluation_plots/fold_4_metrics_table.csv
2025-05-30 03:28:59 | INFO     | [plotter   :_generate_metri...: 246] | ‚ÑπÔ∏è Metrics CSV saved via repository to: experiments/Swimcat-extend/hvit/20250530_025350_seed42/cv_model_evaluation_full_025350/cv_model_evaluation_plots/fold_5_metrics_table.csv
2025-05-30 03:28:59 | INFO     | [plotter   :plot_cv_model_e...:1061] | ‚ÑπÔ∏è Finished plotting for cv_model_evaluation: cv_model_evaluation_full_025350
2025-05-30 03:28:59 | INFO     | [pipeline  :cv_model_evalua...:1470] | ‚ÑπÔ∏è CV Evaluation Summary (on full data, 5 folds, 95% CI):
2025-05-30 03:28:59 | INFO     | [pipeline  :cv_model_evalua...:1476] | ‚ÑπÔ∏è   Accuracy            : 0.9895 +/- 0.0045
2025-05-30 03:28:59 | INFO     | [pipeline  :cv_model_evalua...:1476] | ‚ÑπÔ∏è   F1 Macro            : 0.9895 +/- 0.0045
2025-05-30 03:28:59 | INFO     | [pipeline  :cv_model_evalua...:1476] | ‚ÑπÔ∏è   Precision Macro     : 0.9897 +/- 0.0045
2025-05-30 03:28:59 | INFO     | [pipeline  :cv_model_evalua...:1476] | ‚ÑπÔ∏è   Recall Macro        : 0.9895 +/- 0.0045
2025-05-30 03:28:59 | INFO     | [pipeline  :cv_model_evalua...:1476] | ‚ÑπÔ∏è   Specificity Macro   : 0.9979 +/- 0.0009
2025-05-30 03:28:59 | INFO     | [pipeline  :cv_model_evalua...:1476] | ‚ÑπÔ∏è   Roc Auc Macro       : 0.9997 +/- 0.0003
2025-05-30 03:28:59 | INFO     | [pipeline  :cv_model_evalua...:1476] | ‚ÑπÔ∏è   Pr Auc Macro        : 0.9924 +/- 0.0021
2025-05-30 03:28:59 | INFO     | [executor  :run               : 198] | ‚ÑπÔ∏è --- Method cv_model_evaluation (cv_model_evaluation_0) completed successfully in 2108.67s ---
2025-05-30 03:28:59 | INFO     | [executor  :run               : 217] | ‚ÑπÔ∏è Pipeline execution finished in 2108.67s.
2025-05-30 03:28:59 | INFO     | [executor  :run               : 313] | ‚ÑπÔ∏è Final log file available at: C:\Users\Stefan Alexandrescu\Documents\GitHub\UBB-Y3-AI-Research\model_src\experiments\Swimcat-extend\hvit\20250530_025350_seed42\experiment_run_20250530_025350_seed42.log
2025-05-30 03:28:59 | INFO     | [main      :<module>          : 308] | ‚ÑπÔ∏è --- Final Execution Results Summary ---
2025-05-30 03:28:59 | INFO     | [main      :<module>          : 317] | ‚ÑπÔ∏è Method cv_model_evaluation_0: Completed. (Acc: 0.9895, F1: 0.9895, BestScore: nan)
